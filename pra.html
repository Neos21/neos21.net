<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Neo's World - Neo's World</title>
    <!--nobanner-->
<style>

*,
*::before,
*::after {
  box-sizing: border-box;
}

html {
  font-family: -apple-system, BlinkMacSystemFont, "游ゴシック体", YuGothic, "Yu Gothic M", "游ゴシック Medium", "Yu Gothic Medium", sans-serif;
  overflow-y: scroll;
  cursor: default;
  /* Chrome で下線部の文字切れを調整する */
  text-decoration-skip-ink: none;
  /* iOS でフォントサイズの調整を避ける */
  -webkit-text-size-adjust: 100%;
  /* iOS で下線部の文字切れを調整する */
  -webkit-text-decoration-skip: objects;
  /* iOS で慣性スクロールを有効にする */
  -webkit-overflow-scrolling: touch;
}

body {
  margin: 1rem;
  line-height: 1.7;
  overflow-wrap: break-word;
  /* overflow-wrap が IE で効かないため指定する */
  word-wrap: break-word;
}

button {
  border: 1px solid red;
  padding: 1rem;
  -webkit-appearance: button;
}

#logs {
  height: 8rem;
  border: 1px solid #000;
  padding: .5rem;
  overflow: scroll;
}

</style>
<script>

const d = document;

function log(arg1, arg2) {
  console.log(arg1, arg2);
  d.getElementById('logs').innerHTML = arg1 + '<br>' + d.getElementById('logs').innerHTML;
}

let count = 0;
function up() {
  count++;
  d.getElementById('count').innerHTML = count;
}

let lastTouchEnd = 0;

d.addEventListener('DOMContentLoaded', () => {
  d.getElementById('btn1').addEventListener('click', (event) => { log('btn1', event); up(); });
  d.getElementById('btn2').addEventListener('click', (event) => { log('btn2', event); up(); });
  d.getElementById('btn3').addEventListener('click', (event) => { log('btn3', event); up(); });
  d.getElementById('btn4').addEventListener('click', (event) => { log('btn4', event); up(); });
  d.getElementById('btn5').addEventListener('click', (event) => { log('btn5', event); up(); });
  d.getElementById('btn1').addEventListener('touchend', (event) => { log('btn1 touch', event); up(); });
  d.getElementById('btn2').addEventListener('touchend', (event) => { log('btn2 touch', event); up(); });
  d.getElementById('btn3').addEventListener('touchend', (event) => { log('btn3 touch', event); up(); });
  d.getElementById('btn4').addEventListener('touchend', (event) => { log('btn4 touch', event); up(); });
  d.getElementById('btn5').addEventListener('touchend', (event) => { log('btn5 touch', event); up(); });
  
  document.addEventListener('touchstart', (event) => {
    const delay = 400;  // ms
    const now = new Date().getTime();
    if((now - lastTouchEnd) < delay) {
      event.preventDefault();
      event.scale = 1;
      log('TouchStart ダブルタップ抑止 ' + event.scale, event);
    }
    
    if(event.touches && event.touches.length > 1) {
      log('TouchStart 複数指抑止 ' + event.scale, event);
      event.preventDefault();
    }
    
    // 万が一ズームされていたら直す
    if(event.scale && event.scale !== 1) {
      log('TouchStart ズーム修正 ' + event.scale, event);
      event.scale = 1;
    }
  }, { passive: false });
  
  document.addEventListener('touchend', (event) => {
    const delay = 400;  // ms
    const now = new Date().getTime();
    if((now - lastTouchEnd) < delay) {
      event.preventDefault();
      event.scale = 1;
      log('TouchEnd ダブルタップ抑止 ' + event.scale, event);
    }
    lastTouchEnd = now;
    
    // 万が一ズームされていたら直す
    if(event.scale && event.scale !== 1) {
      log('TouchEnd ズーム修正 ' + event.scale, event);
      event.scale = 1;
    }
  });
});

</script>
  </head>
  <body>

<div class="btns">
  <button type="button" id="btn1">壱</button>
  <button type="button" id="btn2">弐</button>
  <button type="button" id="btn3">参</button>
  <button type="button" id="btn4">四</button>
  <button type="button" id="btn5">伍</button>
</div>

<div id="count">0</div>

<pre id="logs"></pre>


  </body>
</html>
