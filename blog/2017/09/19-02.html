<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Google Search Console -->
    <meta name="google-site-verification" content="AvoEr3mUJFF2H_mPWWgShfmjBVP3ywRpyx9hxeeq2d4">
    <title>TextLint を使ってみる - Neo's World</title>
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="/styles.css">
    <link rel="canonical" href="https://neos21.net/blog/2017/09/19-02.html">
    <link rel="search" type="application/opensearchdescription+xml" title="neos21.net" href="/opensearch.xml">
    <link rel="alternate" type="application/atom+xml" href="/feeds.xml">
    <link rel="author" href="http://www.hatena.ne.jp/neos21/">
    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YMHFLZP1M1"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date());gtag('config','G-YMHFLZP1M1');gtag('config','UA-106501-1');</script>
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6475907504235292" crossorigin="anonymous"></script>
  </head>
  <body>
    <div id="container">
      <header id="header">
        <div id="site-title"><a href="/index.html">Neo's World</a></div>
        <nav id="header-links">
          <ul>
            <li id="header-link-about"><a href="/about/index.html" title="About"><span>About</span></a></li>
            <li id="header-link-search"><a href="/about/search.html" title="Search"><span>Search</span></a></li>
            <li id="header-link-feeds"><a href="/feeds.xml" title="Feeds"><span>Feeds</span></a></li>
            <li id="header-link-to-bottom"><a href="#footer" title="To Bottom"><span>▼ To Bottom</span></a></li>
          </ul>
        </nav>
        <nav id="global-nav">
          <ul>
            <li><a href="/blog/index.html">Blog</a></li>
            <li><a href="/tech/index.html">Tech</a></li>
            <li><a href="/music/index.html">Music</a></li>
            <li><a href="/games/index.html">Games</a></li>
            <li><a href="/gallery/index.html">Gallery</a></li>
            <li><a href="/etc/index.html">Etc.</a></li>
          </ul>
        </nav>
        <nav id="path">
          <ul>
            <li><a href="/index.html">Neo's World</a></li>
            <li><a href="/blog/index.html">Blog</a></li>
            <li><a href="/blog/2017/index.html">2017年</a></li>
            <li><a href="/blog/2017/09/index.html">09月</a></li>
          </ul>
        </nav>
      </header>
      <main id="main">
        <div id="header-date"><time>2017-09-19</time></div>
        <h1 id="page-title">TextLint を使ってみる</h1>

<p>文章校正ができる npm パッケージ「<strong>TextLint</strong>」を使ってみた。</p>
<ul>
  <li><a href="https://textlint.github.io/">textlint - pluggable linting tool for text and markdown</a></li>
  <li><a href="https://github.com/textlint/textlint">GitHub - textlint/textlint: The pluggable natural language linter for text and markdown.</a></li>
  <li><a href="http://efcl.info/2015/09/10/introduce-textlint/">textlintで日本語の文章をチェックする | Web Scratch</a></li>
</ul>
<h2 id="textlint-の使い方"><a class="header-link" href="#textlint-の使い方"><span class="header-link-mark"></span></a>TextLint の使い方</h2>
<p>TextLint はルールをプラガブルに設定できるのが特徴。TextLint 本体となるパッケージの他に、特定の文法や言葉遣いをチェックするルールセットのパッケージを組み合わせて入れていくのだ。各ルールは設定ファイルにてチェックの仕方をカスタマイズしたりできる。</p>
<p>まずは TextLint 本体を入れる。今回はプロジェクト配下にローカルインストールする。</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token function">npm</span> i textlint-D
</code></pre>
<p>そして <code>package.json</code> に npm-scripts を追加しておこう。</p>
<pre class="language-json"><code class="language-json"><span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">"textlint"</span><span class="token operator">:</span> <span class="token string">"textlint"</span>
<span class="token punctuation">}</span>
</code></pre>
<p>これで <code>npm run textlint</code> で動かせるようになる。</p>
<h2 id="自分が入れたルールセット"><a class="header-link" href="#自分が入れたルールセット"><span class="header-link-mark"></span></a>自分が入れたルールセット</h2>
<p>まだカスタマイズ中なのだが、自分が入れているルールセットは以下のとおり。全て npm パッケージなので、インストールは <code>npm i texlint-rule-【パッケージ名】 -D</code> で行う。</p>
<table>
  <thead>
    <tr>
      <th>パッケージ名</th>
      <th>概要</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>textlint-rule-ja-hiragana-hojodoushi</td>
      <td>ひらがなにした方が良い補助動詞</td>
    </tr>
    <tr>
      <td>textlint-rule-ja-no-abusage</td>
      <td>よくある誤用</td>
    </tr>
    <tr>
      <td>textlint-rule-ja-no-redundant-expression</td>
      <td>冗長表現</td>
    </tr>
    <tr>
      <td>textlint-rule-ja-no-successive-word</td>
      <td>同一の単語を間違えて連続しているもの</td>
    </tr>
    <tr>
      <td>textlint-rule-max-ten</td>
      <td>一文に利用できる「、」の数</td>
    </tr>
    <tr>
      <td>textlint-rule-no-doubled-conjunction</td>
      <td>同じ接続詞が連続して出現していないか</td>
    </tr>
    <tr>
      <td>textlint-rule-no-doubled-conjunctive-particle-ga</td>
      <td>逆接の接続助詞「が」が一文中に複数回使用されていないか</td>
    </tr>
    <tr>
      <td>textlint-rule-no-doubled-joshi</td>
      <td>文中に同じ助詞が複数登場していないか</td>
    </tr>
    <tr>
      <td>textlint-rule-no-dropping-the-ra</td>
      <td>ら抜き表現</td>
    </tr>
    <tr>
      <td>textlint-rule-no-mix-dearu-desumasu</td>
      <td>常体・敬体の統一</td>
    </tr>
    <tr>
      <td>textlint-rule-no-mixed-zenkaku-and-hankaku-alphabet</td>
      <td>全角アルファベット</td>
    </tr>
    <tr>
      <td>textlint-rule-no-nfd</td>
      <td>Mac 濁点</td>
    </tr>
  </tbody>
</table>
<p>この辺で、単なる typo から文体の統一、勘違いして書いている文章や推敲の足りない文章がうまく蹴落とせると思う。</p>
<h2 id="html-ファイルをチェックするためのプラグイン"><a class="header-link" href="#html-ファイルをチェックするためのプラグイン"><span class="header-link-mark"></span></a>HTML ファイルをチェックするためのプラグイン</h2>
<p>TextLint 単体では、チェック対象のファイルが HTML だとタグなどを誤解してしまうので、HTML ファイルを読み込めるプラグインを入れておく。</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token function">npm</span> i textlint-plugin-html -D
</code></pre>
<h2 id="設定ファイルでカスタマイズ"><a class="header-link" href="#設定ファイルでカスタマイズ"><span class="header-link-mark"></span></a>設定ファイルでカスタマイズ</h2>
<p>さて、これらのルールセットやプラグインを有効にし、チェックルールをカスタマイズするために、プロジェクト直下に <code>.textlintrc</code> というファイルを作り、JSON 形式でルールを設定していく。<code>//</code> でコメントアウトを挿入できる。</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"plugins"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">"html"</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"rules"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// よくある誤用</span>
    <span class="token property">"ja-no-abusage"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">// 冗長表現</span>
    <span class="token property">"ja-no-redundant-expression"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">// 全角アルファベット</span>
    <span class="token property">"no-mixed-zenkaku-and-hankaku-alphabet"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">// ら抜き言葉</span>
    <span class="token property">"no-dropping-the-ra"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">// 一文における読点「、」の数</span>
    <span class="token property">"max-ten"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"max"</span> <span class="token operator">:</span> <span class="token number">3</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 逆接の接続助詞「が」が一文中に複数回使用されていないか</span>
    <span class="token property">"no-doubled-conjunctive-particle-ga"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">// 同じ接続詞が連続して出現していないか</span>
    <span class="token property">"no-doubled-conjunction"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">// 文中に同じ助詞が複数登場していないか</span>
    <span class="token property">"no-doubled-joshi"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"min_interval"</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token property">"strict"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token property">"allow"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// Mac 濁点</span>
    <span class="token property">"no-nfd"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">// ひらがなにした方が良い補助動詞</span>
    <span class="token property">"ja-hiragana-hojodoushi"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">// 同一の単語を間違えて連続しているもの</span>
    <span class="token property">"ja-no-successive-word"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">// 常体 (である調) に統一する</span>
    <span class="token property">"no-mix-dearu-desumasu"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"preferInHeader"</span><span class="token operator">:</span> <span class="token string">"である"</span><span class="token punctuation">,</span>  <span class="token comment">// "" (自動) or "である" or "ですます"</span>
      <span class="token property">"preferInBody"</span><span class="token operator">:</span> <span class="token string">"である"</span><span class="token punctuation">,</span>
      <span class="token property">"preferInList"</span><span class="token operator">:</span> <span class="token string">"である"</span><span class="token punctuation">,</span>
      <span class="token property">"strict"</span><span class="token operator">:</span> <span class="token boolean">true</span>  <span class="token comment">// 文末以外でも敬体と常体を厳しくチェックするかどうか</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>基本はパッケージ名の接頭辞 <code>textlint-rule-</code> を省いてパッケージを指定し、その中で決められたルールを設定する、もしくは <code>true</code>・<code>false</code> でそのルールを適用するかどうか、といった設定ができる。</p>
<h2 id="lint-の掛け方"><a class="header-link" href="#lint-の掛け方"><span class="header-link-mark"></span></a>Lint の掛け方</h2>
<p>これでパッケージの導入と設定ができたので、実際に Lint をかけてみる。</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token function">npm</span> run textlint ./html/**/*.html
</code></pre>
<p>このようにワイルドカードで指定のディレクトリ配下の全てのファイルを選択できる。結果は以下のように表示される。</p>
<pre><code>C:\MyProject\html\test\hoge.html
   77:129  error    一つの文で"、"を3つ以上使用しています                         max-ten
   82:57   error    一文に二回以上利用されている助詞 "に" がみつかりました。      no-doubled-joshi
   89:179  error    一つの文で"、"を3つ以上使用しています                         max-ten
   91:72   error    "小" が連続して2回使われています。                            ja-no-successive-word
</code></pre>
<p>中には「飲酒はほどほどにしよう」といった文章を見て「"ほど" が連続して2回使われています。」というツッコミが入ったり、思ってもいないところでエラー扱いになることもあるが、少なくとも誤りは見逃さないので、これで文章校正をしていくのが良い感じ。</p>

      </main>
      <footer id="footer">
        <div id="date-time">
          <dl>
            <dt>Created</dt>
            <dd><time>2017-09-19</time></dd>
            <dt>Last-Modified</dt>
            <dd><time>2017-09-19</time></dd>
          </dl>
        </div>
        <nav id="footer-links">
          <ul>
            <li id="footer-link-about"><a href="/about/index.html" title="About">About</a></li>
            <li id="footer-link-search"><a href="/about/search.html" title="Search">Search</a></li>
            <li id="footer-link-feeds"><a href="/feeds.xml" title="Feeds">Feeds</a></li>
            <li id="footer-link-github"><a href="https://github.com/Neos21/" title="GitHub">GitHub</a></li>
          </ul>
        </nav>
        <nav id="to-top"><a href="#" title="To Top"><span>▲ To Top</span></a></nav>
      </footer>
    </div>
  </body>
</html>
