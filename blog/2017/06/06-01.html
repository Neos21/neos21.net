<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="theme-color" content="#0990d0">
    <!-- Google Search Console -->
    <meta name="google-site-verification" content="AvoEr3mUJFF2H_mPWWgShfmjBVP3ywRpyx9hxeeq2d4">
    <title>Apache Cordova を使ってフロントエンド技術だけで iOS アプリを作る - Neo's World</title>
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="/styles.css">
    <link rel="canonical" href="https://neos21.net/blog/2017/06/06-01.html">
    <link rel="search" type="application/opensearchdescription+xml" title="neos21.net" href="/opensearch.xml">
    <link rel="alternate" type="application/atom+xml" href="/feeds.xml">
    <link rel="author" href="http://www.hatena.ne.jp/neos21/">
    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YMHFLZP1M1"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date());gtag('config','G-YMHFLZP1M1');gtag('config','UA-106501-1');</script>
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6475907504235292" crossorigin="anonymous"></script>
  </head>
  <body>
    <div id="container">
      <header id="header">
        <div id="header-brand">
          <div id="header-brand-contents">
            <div id="site-title"><a href="/index.html">Neo's World</a></div>
            <nav id="header-links">
              <ul>
                <li id="header-link-about"><a href="/about/index.html" title="About"><span>About</span></a></li>
                <li id="header-link-search"><a href="/about/search.html" title="Search"><span>Search</span></a></li>
                <li id="header-link-feeds"><a href="/feeds.xml" title="Feeds"><span>Feeds</span></a></li>
                <li id="header-link-to-bottom"><a href="#footer" title="To Bottom"><span>▼ To Bottom</span></a></li>
              </ul>
            </nav>
          </div>
        </div>
        <nav id="global-nav">
          <ul>
            <li><a href="/blog/index.html">Blog</a></li>
            <li><a href="/tech/index.html">Tech</a></li>
            <li><a href="/music/index.html">Music</a></li>
            <li><a href="/games/index.html">Games</a></li>
            <li><a href="/gallery/index.html">Gallery</a></li>
            <li><a href="/etc/index.html">Etc.</a></li>
          </ul>
        </nav>
        <nav id="path">
          <ul>
            <li><a href="/index.html">Neo's World</a></li>
            <li><a href="/blog/index.html">Blog</a></li>
            <li><a href="/blog/2017/index.html">2017年</a></li>
            <li><a href="/blog/2017/06/index.html">06月</a></li>
          </ul>
        </nav>
      </header>
      <main id="main">
        <div id="header-date"><time>2017-06-06</time></div>
        <h1 id="page-title">Apache Cordova を使ってフロントエンド技術だけで iOS アプリを作る</h1>

<p><strong>Apache Cordova</strong> (コルドバ) というフレームワークがある。HTML・CSS・JS といったフロントエンド技術だけで iOS アプリや Android アプリが作れるフレームワークだ。フロントエンド技術だけでネイティブアプリが作れるという意味では、Electron に近い存在といえる。</p>
<p>通知機能など、モバイルのネイティブ機能に対しても、Cordova が提供するプラグインを使ってアクセスできる。コードとしては JavaScript でプラグインの API を叩くだけなので、対象の端末に依存しにくい実装が可能になる。</p>
<p>今回はこの Cordova を使って iOS アプリを作成し、iOS シミュレータで起動するところまでをやってみようと思う。</p>
<h2 id="準備するもの-対象環境"><a class="header-link" href="#準備するもの-対象環境"><span class="header-link-mark"></span></a>準備するもの (対象環境)</h2>
<p>準備するものは以下のとおり。</p>
<ul>
  <li><strong>MacOS (OSX) が搭載されたパソコン</strong></li>
  <li>XCode : v8.3.2</li>
  <li>Node.js : v6.10.3</li>
  <li>npm : v3.10.10</li>
  <li>Cordova : v7.0.1</li>
</ul>
<p>パソコン上で iPhone や iPad などのシミュレータを動作させるには、XCode という Apple 製の開発環境が必要となる。そのため、MacBook や iMac など、Mac が必要になるのだ。Windows でもやりようがあるらしいが、今回は対象外とする。</p>
<p>Cordova は npm パッケージとして提供されるため、Node.js は必須。Cordova の開発は盛んに行われており、Node.js や npm のバージョン依存が激しい。Mac の場合は Nodebrew などで Node.js・npm のバージョンを管理しておこう。Node.js と npm の準備は以下の記事を参考に行ってほしい。</p>
<ul>
  <li><a href="/blog/2016/05/26-05.html">Node.js をバージョン管理できる体制でインストールする</a></li>
</ul>
<h2 id="xcode-をインストールする"><a class="header-link" href="#xcode-をインストールする"><span class="header-link-mark"></span></a>XCode をインストールする</h2>
<p>まずは iOS シミュレータを動作させるため、XCode をインストールする。</p>
<p>AppStore から XCode を検索しインストールする。インストールには30分くらいかかるので気長に待つ。</p>
<p>
  <img src="06-01-01.png" alt="Xcode をインストールする">
</p>
<p>インストールが終わったら一度 XCode を起動し、ライセンス規約に同意しておく。</p>
<p>
  <img src="06-01-02.png" alt="ライセンス認証">
</p>
<p>そしたらターミナルを起動し、以下のコマンドを叩く。</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token function">sudo</span> xcodebuild -license
</code></pre>
<p>すると何やら文章が出てくるので、Enter で続け、Space キーで読み進める。</p>
<p>
  <img src="06-01-02.png" alt="ライセンスに同意">
</p>
<p>以下の表記が出てきたら <strong><code>agree</code> と入力する</strong>。</p>
<pre class="language-bash"><code class="language-bash">By typing <span class="token string">'agree'</span> you are agreeing to the terms of the software license agreements. 
Type <span class="token string">'print'</span> to print them or anything <span class="token keyword">else</span> to cancel, 
<span class="token punctuation">[</span>agree, print, cancel<span class="token punctuation">]</span> 【← ココで「agree」と入力する】

You can view the license agreements <span class="token keyword">in</span> Xcode's About Box, or at 
/Applications/Xcode.app/Contents/Resources/English.lproj/Licens.rtf
</code></pre>
<p>
  <img src="06-01-04.png" alt="agree する">
</p>
<p>これで XCode が使えるようになった。</p>
<ul>
  <li>参考：<a href="http://qiita.com/tmknom/items/d60084edadfe1b7685ef">Xcodeのライセンス同意をコマンドラインだけで切り抜ける - Qiita</a></li>
</ul>
<h2 id="ios-sdk-をインストールする"><a class="header-link" href="#ios-sdk-をインストールする"><span class="header-link-mark"></span></a>iOS SDK をインストールする</h2>
<p>続いて、iOS シミュレータを動作させるために必要となる開発キット、iOS SDK をインストールする。</p>
<p>XCode を起動し、XCode メニュー → Preferences → 開いたウィンドウで Components タブを選択 と進み、本記事執筆時点で最新版の OS である「iOS 10.3 Simulator」の左の「↓」アイコンを押す。これで iOS 10.3 の SDK がインストールできる。</p>
<p>
  <img src="06-01-06.png" alt="iOS リスト">
</p>
<p>iOS SDK は OS のバージョンごとのインストールとなり、この OS のバージョンごとに、対象のデバイスが存在している。自分のパソコンにインストールした SDK の一覧を見るには、ターミナルで以下のコマンドを打つ。</p>
<pre class="language-bash"><code class="language-bash">$ xcrun simctl list
</code></pre>
<p>
  <img src="06-01-05.png" alt="コマンドラインで確認">
</p>
<ul>
  <li>参考：<a href="http://qiita.com/tamaki/items/02eb43253193b950b08f#list">simctlコマンドを使ってみる - Qiita</a></li>
</ul>
<p>これで iOS シミュレータを動作させるための準備が整った。</p>
<h2 id="cordova-をインストールする"><a class="header-link" href="#cordova-をインストールする"><span class="header-link-mark"></span></a>Cordova をインストールする</h2>
<p>いよいよ npm から Cordova をインストールする。Cordova は <code>cordova</code> コマンドであれこれ操作するので、グローバルインストールする。</p>
<pre class="language-bash"><code class="language-bash"><span class="token comment"># Nodebrew を使っている場合は以下で Node.js v6 系の最新版を入れておく</span>
$ nodebrew install-binary v6.10.3
$ nodebrew use v6.10.3

$ node -v
v6.10.3

$ <span class="token function">npm</span> -v
<span class="token number">3.10</span>.10

<span class="token comment"># Cordova をインストールする</span>
$ <span class="token function">npm</span> <span class="token function">install</span> -g cordova
</code></pre>
<p>Cordova のバージョンは本記事執筆時点では v7.0.1 だった。</p>
<h2 id="cordova-プロジェクトを作る"><a class="header-link" href="#cordova-プロジェクトを作る"><span class="header-link-mark"></span></a>Cordova プロジェクトを作る</h2>
<p>Cordova アプリを作るためのワークスペースを <code>cordova</code> コマンドで作成する。適当な作業用ディレクトリに移動し、以下のコマンドを叩く。</p>
<pre class="language-bash"><code class="language-bash"><span class="token comment"># Cordova プロジェクトを作る。引数の順番は「ディレクトリ名」「識別子」「アプリ名」</span>
$ cordova create HelloCordova com.example.hello HelloCordova
</code></pre>
<p>すると「HelloCordova」フォルダができるので、そこに移動する。これが Cordova プロジェクトの基底フォルダとなる。</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token builtin class-name">cd</span> HelloCordova/
</code></pre>
<p>「識別子」はドメインを逆から書くのが一般的。iOS アプリを実際に AppStore で配布したりする際の申請で必要になるもので、ココでは適当で良い。識別子とアプリ名はこの後紹介する <code>config.xml</code> に記載される。</p>
<p>さて、「HelloCordova」フォルダに移動すると、既にいくつかのフォルダができている。</p>
<p>
  <img src="06-01-07.png" alt="こんなファイル・ディレクトリができている">
</p>
<p>それぞれのフォルダの役割は以下のとおり。</p>
<pre class="language-bash"><code class="language-bash">HelloCordova/
├ hooks/     … cordova コマンドをカスタマイズする際に使う
├ platforms/ … iOS や Android など、プラットフォームに応じたビルド成果物が格納される
├ plugins/   … インストールしたプラグインが格納される
├ res/       … アプリのアイコンなどを格納しておく
├ www/       … ここがメイン。この下にある HTML・CSS・JS などがアプリとしてビルドされる
└ config.xml … アプリ情報、プラットフォーム・プラグインに関する情報などが記載される
</code></pre>
<p>基本的には <code>./www/</code> フォルダ配下にビルドしたいモノを入れていく。ビルド後に少し触ることがあるのが <code>./platforms/</code> で、それ以外のフォルダは基本触らない。少なくとも今回は対象にしない。アプリに関する情報は <code>config.xml</code> に記載され、これがあれば Cordova プロジェクトを元に復元したりもできる。</p>
<ul>
  <li>参考：<a href="http://qiita.com/katsu_suzuki/items/ee606a198020a0fe27df">Cordovaのフォルダ構成について - Qiita</a></li>
</ul>
<h2 id="ターゲットプラットフォームを追加する"><a class="header-link" href="#ターゲットプラットフォームを追加する"><span class="header-link-mark"></span></a>ターゲットプラットフォームを追加する</h2>
<p>Cordova プロジェクトができたら、iOS 向けのビルドができるようにターゲットプラットフォームを追加する。ターミナルにて、Cordova プロジェクト直下で以下のコマンドを叩く。</p>
<pre class="language-bash"><code class="language-bash">$ cordova platform <span class="token function">add</span> ios --save
</code></pre>
<p><code>--save</code> オプションは、このプラットフォーム情報を <code>config.xml</code> に追記するというもの。以下が追記されるのが分かると思う。</p>
<pre class="language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>engine</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ios<span class="token punctuation">"</span></span> <span class="token attr-name">spec</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>~4.4.0<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
</code></pre>
<p>これで iOS 向けのビルドができるようになった。</p>
<h2 id="ios-アプリをビルドしてみる"><a class="header-link" href="#ios-アプリをビルドしてみる"><span class="header-link-mark"></span></a>iOS アプリをビルドしてみる</h2>
<p><code>cordova create</code> コマンドで Cordova プロジェクトを作成すると、<code>./www/</code> 配下に <code>index.html</code> などが生成されていることが分かる。これがそのままアプリとしてビルドできるサンプルになっているので、まずはこれをビルドしてみる。</p>
<p>ビルドするには、ターミナルで以下を叩くだけ。</p>
<pre class="language-bash"><code class="language-bash">$ cordova build

<span class="token comment"># 以下でも OK</span>
$ cordova build ios
</code></pre>
<p>すると <code>./platforms/ios/</code> 配下にビルドしたブツが出来上がる。Finder から <code>./platforms/ios/HelloCordova.xcodeproj</code> をダブルクリックすると XCode が開くので、メニューから Debug → Run と押すと、iPhone シミュレータでアプリが開く。<strong>これで出来上がり</strong>だ。</p>
<p>
  <img src="06-01-08.png" alt="iPhone シミュレータが起動">
</p>
<p>↑iPhone シミュレータ上で、フロントエンド技術だけで実装された iOS アプリが動作している。</p>
<h2 id="その他の起動方法"><a class="header-link" href="#その他の起動方法"><span class="header-link-mark"></span></a>その他の起動方法</h2>
<p>XCode からアプリを起動すると、XCode 上でデバッグコンソールが確認できて便利ではあるが、<code>cordova</code> コマンドを使えばコマンドラインから起動できる。</p>
<pre class="language-bash"><code class="language-bash">$ cordova emulate

<span class="token comment"># 以下でも OK</span>
$ cordova emulate ios
</code></pre>
<p>これで iOS シミュレータが開く。</p>
<p>起動させる iOS のデバイスを変更するには、以下のように <code>--target</code> オプションを指定すれば良い。</p>
<pre class="language-bash"><code class="language-bash">$ cordova emulate --target<span class="token operator">=</span>iPhone-7
</code></pre>
<p>どんなデバイス名が指定できるかは、以下のコマンドで確認できる。</p>
<pre class="language-bash"><code class="language-bash">$ ./platforms/ios/cordova/lib/list-emulator-images

<span class="token comment"># もしくは以下でも同等</span>
$ cordova emulate --list
</code></pre>
<p>また、本来は実機での確認用コマンドだが、Mac に USB 接続しているデバイスがなければ、以下のコマンドが <code>cordova emulate</code> と同様に動作する。</p>
<pre class="language-bash"><code class="language-bash">$ cordova run

<span class="token comment"># 以下でも同様</span>
$ cordova run ios
</code></pre>
<ul>
  <li>参考：<a href="http://qiita.com/kenfdev/items/74bdfcc65317a411df68">CordovaでiOS simulatorを指定する - Qiita</a></li>
</ul>
<h2 id="mac-のブラウザで表示確認する"><a class="header-link" href="#mac-のブラウザで表示確認する"><span class="header-link-mark"></span></a>Mac のブラウザで表示確認する</h2>
<p>単なるレイアウト調整など、iOS シミュレータ向けにビルドしたりしなくて良い場合は、以下のコマンドを叩けばブラウザ上で表示確認ができる。</p>
<pre class="language-bash"><code class="language-bash">$ cordova serve
Static <span class="token function">file</span> server running on: http://localhost:8000 <span class="token punctuation">(</span>CTRL + C to shut down<span class="token punctuation">)</span>

<span class="token comment"># 以下でも同じ</span>
$ cordova serve ios
</code></pre>
<p>このコマンドを叩くと、簡易 Web サーバが起動し、<code>http://localhost:8000</code> にアクセスして表示確認ができる。終了する時はサーバを起動したコンソールで <code>Ctrl + C</code> で終了できる。</p>
<p>
  <img src="06-01-09.png" alt="ブラウザで確認">
</p>
<p>↑<code>cordova serve</code> コマンドを叩いたところ。</p>
<p>
  <img src="06-01-10.png" alt="このとおり">
</p>
<p>↑Mac の任意のブラウザ上からページを確認できる。</p>
<h2 id="ひとまず以上"><a class="header-link" href="#ひとまず以上"><span class="header-link-mark"></span></a>ひとまず以上</h2>
<p>ソースを見てもらえば分かるが、実装されているのは <code>./www/index.html</code> と CSS・JS だけ。それが iOS シミュレータで動作する iOS アプリとしてビルドできた。</p>
<p>手軽に iOS アプリの開発が始められるフレームワークとして、Cordova を使ってみてはいかがだろうか。</p>
<p>次回はフロントエンド実装に関する諸注意をまとめようと思う。</p>
<ul>
  <li><a href="/blog/2017/06/07-01.html">Cordova 開発に関する Tips</a></li>
</ul>

      </main>
      <footer id="footer">
        <div id="footer-contents">
          <div id="date-time">
            <dl>
              <dt>Created</dt>
              <dd><time>2017-06-06</time></dd>
              <dt>Last-Modified</dt>
              <dd><time>2017-06-06</time></dd>
            </dl>
          </div>
          <nav id="footer-links">
            <ul>
              <li id="footer-link-about"><a href="/about/index.html" title="About">About</a></li>
              <li id="footer-link-search"><a href="/about/search.html" title="Search">Search</a></li>
              <li id="footer-link-feeds"><a href="/feeds.xml" title="Feeds">Feeds</a></li>
              <li id="footer-link-github"><a href="https://github.com/Neos21/" title="GitHub">GitHub</a></li>
            </ul>
          </nav>
          <nav id="to-top"><a href="#" title="To Top"><span>▲ To Top</span></a></nav>
        </div>
      </footer>
    </div>
  </body>
</html>
