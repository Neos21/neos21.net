<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="theme-color" content="#0990d0">
    <!-- Google Search Console -->
    <meta name="google-site-verification" content="AvoEr3mUJFF2H_mPWWgShfmjBVP3ywRpyx9hxeeq2d4">
    <!-- Open Graph・Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Neo's World">
    <meta property="og:title" content="右 Windows キーがないキーボードでアプリケーションキーを右 Windows キーの代用にする・ただし単体で押した時はアプリケーションキーとして使う - Neo's World">
    <meta property="og:description" content="右 Windows キーがないキーボードでアプリケーションキーを右 Windows キーの代用にする・ただし単体で押した時はアプリケーションキーとして使う - Neo's World">
    <meta property="og:url" content="https://neos21.net/blog/2017/03/25-02.html">
    <meta property="og:image" content="https://neos21.net/ogp.png">
    <meta property="og:locale" content="ja_JP">
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:title" content="右 Windows キーがないキーボードでアプリケーションキーを右 Windows キーの代用にする・ただし単体で押した時はアプリケーションキーとして使う - Neo's World">
    <meta property="twitter:description" content="右 Windows キーがないキーボードでアプリケーションキーを右 Windows キーの代用にする・ただし単体で押した時はアプリケーションキーとして使う - Neo's World">
    <meta property="twitter:url" content="https://neos21.net/blog/2017/03/25-02.html">
    <meta property="twitter:image" content="https://neos21.net/ogp.png">
    <title>右 Windows キーがないキーボードでアプリケーションキーを右 Windows キーの代用にする・ただし単体で押した時はアプリケーションキーとして使う - Neo's World</title>
    <link rel="icon" href="/favicon.ico">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    <link rel="manifest" href="/manifest.webmanifest">
    <link rel="stylesheet" href="/styles.css">
    <link rel="canonical" href="https://neos21.net/blog/2017/03/25-02.html">
    <link rel="search" type="application/opensearchdescription+xml" title="neos21.net" href="/opensearch.xml">
    <link rel="alternate" type="application/atom+xml" title="Feeds" href="/feeds.xml">
    <link rel="author" href="http://www.hatena.ne.jp/neos21/">
    <script src="/scripts.js"></script>
    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YMHFLZP1M1"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date());gtag('config','G-YMHFLZP1M1');gtag('config','UA-106501-1');</script>
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6475907504235292" crossorigin="anonymous"></script>
  </head>
  <body>
    <div id="container">
      <header id="header">
        <div id="header-brand">
          <div id="header-brand-contents">
            <div id="site-title"><a href="/index.html">Neo's World</a></div>
            <nav id="header-links">
              <ul>
                <li id="header-link-theme"><a href="#" title="Toggle Theme"><span>Toggle Theme</span></a></li>
                <li id="header-link-about"><a href="/about/index.html" title="About"><span>About</span></a></li>
                <li id="header-link-search"><a href="/about/search.html" title="Search"><span>Search</span></a></li>
                <li id="header-link-feeds"><a href="/feeds.xml" title="Feeds"><span>Feeds</span></a></li>
                <li id="header-link-to-bottom"><a href="#footer" title="To Bottom"><span>▼ To Bottom</span></a></li>
              </ul>
            </nav>
          </div>
        </div>
        <nav id="global-nav">
          <ul>
            <li><a href="/blog/index.html">Blog</a></li>
            <li><a href="/tech/index.html">Tech</a></li>
            <li><a href="/music/index.html">Music</a></li>
            <li><a href="/games/index.html">Games</a></li>
            <li><a href="/gallery/index.html">Gallery</a></li>
            <li><a href="/etc/index.html">Etc.</a></li>
          </ul>
        </nav>
        <nav id="path">
          <ul>
            <li><a href="/index.html">Neo's World</a></li>
            <li><a href="/blog/index.html">Blog</a></li>
            <li><a href="/blog/2017/index.html">2017年</a></li>
            <li><a href="/blog/2017/03/index.html">03月</a></li>
          </ul>
        </nav>
      </header>
      <main id="main">
        <div id="header-date"><time>2017-03-25</time></div>
        <h1 id="page-title">右 Windows キーがないキーボードでアプリケーションキーを右 Windows キーの代用にする・ただし単体で押した時はアプリケーションキーとして使う</h1>

<h2 id="経緯"><a class="header-link" href="#経緯"><span class="header-link-mark"></span></a>経緯</h2>
<p>ぼくは過去の記事で何回か、<strong>Windows で使う日本語キーボードは右 Windows キーがある109配列が好きだ</strong>と発言してきた。</p>
<ul>
  <li><a href="/blog/2017/02/23-02.html">日本語109配列の無線キーボード &#x26; マウス！「Sanwa Supply SKB-WL24SETBK」を買った</a></li>
</ul>
<p>現在自宅で使っているのは、上の記事に書いたサンワサプライの109キーボードなのだが、会社にはそれまで使っていた Logicool の<em>108配列キーボード</em>を持っていって使っている。</p>
<ul>
  <li><a href="/blog/2016/05/03-01.html">初のワイヤレスマウス・キーボード「Logicool MK275」を買った</a></li>
</ul>
<p>この Logicool MK275 は、<em>右 Windows キーがない日本語108キーボード</em>で、とにかくつらい。<code>Win + R</code> や <code>Win + E</code> を押す時の Windows キーは右 Windows キーを使っているので、それができないと途端に「ああもうダメだ仕事になんねぇ帰ろ…」となってしまう。</p>
<p>そこで、同じくキーボード右側に配置されている<strong>アプリケーションキーを、右 Windows キーの代用にできないか</strong>を調べてみた。</p>
<p>キーリマップができるフリーソフトを色々探したのだが、どうもアプリケーションキー単体をいじくる機能がないか、いじれても元のアプリケーションキーとしての機能は失うモノしかなかった。いや、そうじゃないんだ、<strong>他のキーと合わせて押した時は Windows キーの代わりをしてほしいが、単体で押した時は普通のアプリケーションキーとして動作してほしいのだ</strong>。</p>
<p>これはぼくが Excel で「アプリケーションキー → E」と押すことで「コピーしたセルの挿入」を多用しているから、というたったそれだけの理由なのだが、こんなワガママは通らないものか…と色々考えていた。</p>
<p>そこでふと、以前 Atom エディタのショートカットを作る時に導入した、<em>AutoHotKey</em> というフリーソフトのことを思い出した。</p>
<ul>
  <li><a href="/blog/2016/01/31-01.html">Windows7 で Atom の関連付けを永続化する方法</a></li>
</ul>
<p>AutoHotKey の本来の使い方は、独自のショートカットキーを作るモノだ。このソフトなら、自分でスクリプトを書いて狙ったことができるかもしれない…。</p>
<h2 id="というワケで作った"><a class="header-link" href="#というワケで作った"><span class="header-link-mark"></span></a>というワケで作った</h2>
<p>というワケで、以下が<strong>自分で作った AutoHotKey スクリプト</strong>。</p>
<ul>
  <li><code>AppsKeyToWinKey.ahk</code></li>
</ul>
<pre><code>; 「アプリケーションキー + 他のキー」を押下すると「Windows キー + 他のキー」の入力を再現する
; 右 Windows キーがない環境でも、アプリケーションキーを右 Windows キーのように使えるようになる
AppsKey &#x26; b::Send, {LWin down}b{LWin up}
AppsKey &#x26; d::Send, {LWin down}d{LWin up}
AppsKey &#x26; e::Send, {LWin down}e{LWin up}
AppsKey &#x26; m::Send, {LWin down}m{LWin up}
AppsKey &#x26; r::Send, {LWin down}r{LWin up}
AppsKey &#x26; t::Send, {LWin down}t{LWin up}
AppsKey &#x26; x::Send, {LWin down}x{LWin up}
AppsKey &#x26; Tab::Send, {LWin down}Tab{LWin up}
AppsKey &#x26; Break::Send, {LWin down}Break{LWin up}
; コンビネーションキーを設定するとアプリケーションキー単体での元々のキー入力が効かなくなるので自身をリマップして有効化する
AppsKey::AppsKey
</code></pre>
<p>導入するには、AutoHotKey を Windows にインストール後、上のコードをコピペして「<code>AppsKeyToWinKey.ahk</code>」といった名称でどこかに保存する。</p>
<p>AutoHotKey のダウンロードは以下から。</p>
<ul>
  <li><a href="https://autohotkey.com/download/">AutoHotkey Downloads</a></li>
</ul>
<p><code>.ahk</code> という拡張子が、AutoHotKey のスクリプトであることを示している。このスクリプトファイルをダブルクリックで実行すると、タスクトレイに AutoHotKey のアイコンが常駐し、特定のキー入力があったときに AutoHotKey が反応してくれる、という仕組み。</p>
<h2 id="スクリプトについて"><a class="header-link" href="#スクリプトについて"><span class="header-link-mark"></span></a>スクリプトについて</h2>
<p>AutoHotKey スクリプトの書き方を調べながら書き始め、最後は力技で解決している感があるので、もっと良いやり方がないか気になっている。</p>
<p>ひとまず今回何をやったのかのほとんどは、以下の1行で説明ができる。</p>
<pre class="language-autohotkey"><code class="language-autohotkey"><span class="token symbol">AppsKey</span> <span class="token operator">&#x26;</span> r<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token selector">Send</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token symbol">LWin</span> <span class="token symbol">down</span><span class="token punctuation">}</span>r<span class="token punctuation">{</span><span class="token symbol">LWin</span> <span class="token symbol">up</span><span class="token punctuation">}</span>
</code></pre>
<p>「複数のキーを同時に押した時に何かする」というトリガーを宣言するには、<code>AppsKey &#x26; r::</code> というように、それぞれのキー名を <code>&#x26;</code> で繋ぎ、コロン2つ <code>::</code> で定義する。</p>
<p>次に、トリガーが入力されたら「複数のキーを同時に押す動作をする」と書くときは <code>Send,</code> というコマンドを使う。このあとに <code>Win &#x26; r</code> みたいに書ければよかったのだがどうも上手く行かず、結局 <code>{LWin down}r{LWin up}</code> と書いた。これは、</p>
<ul>
  <li><code>{LWin down}</code> … 左 Windows キーを押し下げる</li>
  <li><code>r</code> … R キーを押す</li>
  <li><code>{LWin up}</code> … 左 Windows キーを離す</li>
</ul>
<p>というキー入力を順に書いており、これによって <code>Win + R</code> というショートカットを実行している。</p>
<p>あとはこれを、Windows キーを使った主要なショートカットの分だけ羅列して、上のようなコードになった。</p>
<p>アプリケーションキーと共に押下したキーをそのまま送る、みたいなことができれば、つまり「<code>AppsKey &#x26; 【何か】::Send, LWin &#x26; 【何か】</code>」みたいな書き方ができれば、本当に1行で済むのだが、うまく探せなかった。何か入力するキーを保持するスクリプトとかあったっぽいけど、うまく適用できそうになくて諦めちゃった。</p>
<p><code>Win + L</code> とか入ってないけど、この時は左 Windows キーしか使わないから書いていない。組み合わせで打つショートカットキーは両手で打つのがぼくの打ち方なのだ。だから本当は <code>Win + E</code> と <code>Win + R</code>、<code>Win + D</code> ぐらいだけでもとりあえず良かった。w</p>
<p>さて、最後にある</p>
<pre class="language-autohotkey"><code class="language-autohotkey"><span class="token symbol">AppsKey</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token symbol">AppsKey</span>
</code></pre>
<p>この1行だが、これは先程の <code>AppsKey &#x26; r::</code> といった<em>コンビネーションキーの宣言をしてしまうと、1つ目のキーを単体で押下した時の元々の動作がキャンセルされてしまう</em>、という AutoHotKey の仕様があり、これを回避するために書いた。</p>
<p>単一キーを押下した時に、というトリガー部分は <code>AppsKey::</code> で先程と同様。そのあと何のキーを押したことにするか、という部分は、単一キーにリマップする場合は直接 <code>AppsKey</code> などと書ける。</p>
<p>すなわち、アプリケーションキーを一切使う気がなければ、<code>AppsKey::LWin</code> とでもしてやれば、アプリケーションキーを左 Windows キーに見せかけて使えるようになるはずだ。</p>
<p>単一キーの元々の動作を有効にするためのスクリプトの書き方が、こういうイディオムで良いのか分からないが、こう書けばとりあえずアプリケーションキーを単体で押下した時はアプリケーションキーとして動作するようになった。</p>
<hr>
<p>以上。今更知ったけど AutoHotKey ってけっこう可能性ありそう。</p>
<h2 id="autohotkey-スクリプトを書く際に参考にしたサイト"><a class="header-link" href="#autohotkey-スクリプトを書く際に参考にしたサイト"><span class="header-link-mark"></span></a>AutoHotKey スクリプトを書く際に参考にしたサイト</h2>
<ul>
  <li><a href="http://ahkwiki.net/Top">AutoHotkey Wiki</a></li>
  <li><a href="http://ranaesty3.r.ribbon.to/">AutoHotkeyを流行らせるページ</a></li>
</ul>

      </main>
      <footer id="footer">
        <div id="footer-contents">
          <div id="date-time">
            <dl>
              <dt>Created</dt>
              <dd><time>2017-03-25</time></dd>
              <dt>Last-Modified</dt>
              <dd><time>2017-03-25</time></dd>
            </dl>
          </div>
          <nav id="footer-links">
            <ul>
              <li id="footer-link-about"><a href="/about/index.html" title="About">About</a></li>
              <li id="footer-link-search"><a href="/about/search.html" title="Search">Search</a></li>
              <li id="footer-link-feeds"><a href="/feeds.xml" title="Feeds">Feeds</a></li>
              <li id="footer-link-github"><a href="https://github.com/Neos21/" title="GitHub">GitHub</a></li>
            </ul>
          </nav>
          <nav id="to-top"><a href="#" title="To Top"><span>▲ To Top</span></a></nav>
        </div>
      </footer>
    </div>
  </body>
</html>
