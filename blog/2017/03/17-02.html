<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="theme-color" content="#0990d0">
    <!-- Google Search Console -->
    <meta name="google-site-verification" content="AvoEr3mUJFF2H_mPWWgShfmjBVP3ywRpyx9hxeeq2d4">
    <title>Rails で Bootstrap を使う gem「bootstrap-sass」を導入する - Neo's World</title>
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="/styles.css">
    <link rel="canonical" href="https://neos21.net/blog/2017/03/17-02.html">
    <link rel="search" type="application/opensearchdescription+xml" title="neos21.net" href="/opensearch.xml">
    <link rel="alternate" type="application/atom+xml" title="Feeds" href="/feeds.xml">
    <link rel="author" href="http://www.hatena.ne.jp/neos21/">
    <script defer src="/scripts.js"></script>
    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YMHFLZP1M1"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date());gtag('config','G-YMHFLZP1M1');gtag('config','UA-106501-1');</script>
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6475907504235292" crossorigin="anonymous"></script>
  </head>
  <body>
    <div id="container">
      <header id="header">
        <div id="header-brand">
          <div id="header-brand-contents">
            <div id="site-title"><a href="/index.html">Neo's World</a></div>
            <nav id="header-links">
              <ul>
                <li id="header-link-about"><a href="/about/index.html" title="About"><span>About</span></a></li>
                <li id="header-link-search"><a href="/about/search.html" title="Search"><span>Search</span></a></li>
                <li id="header-link-feeds"><a href="/feeds.xml" title="Feeds"><span>Feeds</span></a></li>
                <li id="header-link-to-bottom"><a href="#footer" title="To Bottom"><span>▼ To Bottom</span></a></li>
              </ul>
            </nav>
          </div>
        </div>
        <nav id="global-nav">
          <ul>
            <li><a href="/blog/index.html">Blog</a></li>
            <li><a href="/tech/index.html">Tech</a></li>
            <li><a href="/music/index.html">Music</a></li>
            <li><a href="/games/index.html">Games</a></li>
            <li><a href="/gallery/index.html">Gallery</a></li>
            <li><a href="/etc/index.html">Etc.</a></li>
          </ul>
        </nav>
        <nav id="path">
          <ul>
            <li><a href="/index.html">Neo's World</a></li>
            <li><a href="/blog/index.html">Blog</a></li>
            <li><a href="/blog/2017/index.html">2017年</a></li>
            <li><a href="/blog/2017/03/index.html">03月</a></li>
          </ul>
        </nav>
      </header>
      <main id="main">
        <div id="header-date"><time>2017-03-17</time></div>
        <h1 id="page-title">Rails で Bootstrap を使う gem「bootstrap-sass」を導入する</h1>

<p>Rails アプリのレイアウト調整用に、<strong><code>bootstrap-sass</code></strong> という gem を入れてみる。</p>
<h2 id="はじめに--sass-とか-scss-とか-less-とか何なの"><a class="header-link" href="#はじめに--sass-とか-scss-とか-less-とか何なの"><span class="header-link-mark"></span></a>はじめに : Sass とか Scss とか Less とか何なの</h2>
<p>これらはいずれも、CSS の拡張言語。ピュアな CSS ではまだやりたくてもできない、変数宣言や入れ子ルールなどが実現できる。Sass やら Less やらは、それを実現する言語の種類の違い。</p>
<ul>
  <li>Less : 「The Dynamic Stylesheet language」の略。Node.js パッケージでインストールすることが多い。</li>
  <li>Sass : 「Syntactically Awesome Style Sheets」の略。<em>Ruby ベース</em>なので gem でインストールする。</li>
  <li>Scss : <em>Sass の表記法の1つ</em>。元々の Sass がブレース <code>{}</code> を使わない記法だったりするのに対し、Scss はブレースを使うのでピュアな CSS っぽい見た目で書ける。</li>
</ul>
<p>他にも Stylus とか、最近は PostCSS とか何かよー分からんモノも色々あるけど気にしない。</p>
<ul>
  <li>参考 : <a href="http://brriant.hatenablog.com/entry/2015/09/22/145413">Sass？ Scss？！ Less！？ CSSと何が違うの？ ・・まとめてみた。 - sparkle</a></li>
  <li>参考 : <a href="http://qiita.com/ritukiii/items/67b3c50002b48c6186d6">CSSのメタ言語Sass(SCSS)、LESSの完全入門 - Qiita</a></li>
</ul>
<h2 id="bootstrap-sass-という-gem"><a class="header-link" href="#bootstrap-sass-という-gem"><span class="header-link-mark"></span></a>bootstrap-sass という gem</h2>
<p>今回は、Rails で使うなら Ruby ベースで親和性の高い Sass がいいだろう、ってな理由で、Sass を使う <em>bootstrap-sass</em> という gem を選定した次第。記法としては昔ながらの Sass 記法ではなく、よりピュアな CSS に近い Scss 記法で記載する。この gem で導入できる Bootstrap は <strong>Ver. 3系</strong>である (古いバージョンを指定すれば Ver. 2系の使用も可)。</p>
<p>Ver. 4系の Bootstrap を入れたい場合は、<em><code>bootstrap</code></em> という名前の gem が提供されている。インストール方法はこれから紹介する Ver. 3系とほとんど同じ模様。今後移行しやすいかも。ただ、現時点では Ver. 4系を急いで追っかけなくてもいいかなーという思いもあり、日本語の文献も多い Ver. 3系を選んだ。</p>
<ul>
  <li>参考 : <a href="https://github.com/twbs/bootstrap-rubygem">GitHub - twbs/bootstrap-rubygem: Bootstrap 4 rubygem for Rails / Sprockets / Hanami / etc</a> … 公式</li>
  <li>参考 : <a href="http://qiita.com/ry023/items/65f312d236d57170c178">【Rails】Bootstrap 4(alpha)をインストール - Qiita</a></li>
  <li>参考 : <a href="https://prog-space.com/rails-bootstrap">Ruby on Rails5アプリをBootstrap4デザインにする - Prog Space</a> … View での指定方法のサンプルまでアリ</li>
</ul>
<p>ちなみに、Less を用いる Bootstrap の gem もある。<code>less-rails</code>・<code>twitter-bootstrap-rails</code> という2つの gem を入れて使うようだ。Less には触れないので以下を参照。</p>
<ul>
  <li>参考 : <a href="http://qiita.com/shizuma/items/83cdadbe0a629f1f74d1">Rails bootstrapの導入 sassのススメ - Qiita</a></li>
  <li>参考 : <a href="http://www.sejuku.net/blog/11043">音速開発！RailsでBootstrapを導入する方法〜Less、Sass、Scss〜 | 侍エンジニア塾ブログ | プログラミング入門者向け学習情報サイト</a></li>
</ul>
<h2 id="bootstrap-sass-をインストールする"><a class="header-link" href="#bootstrap-sass-をインストールする"><span class="header-link-mark"></span></a>bootstrap-sass をインストールする</h2>
<p>インストール方法は公式の README.md が丁寧に書いている。これを噛み砕いて説明していく。</p>
<ul>
  <li>参考 : <a href="https://github.com/twbs/bootstrap-sass">GitHub - twbs/bootstrap-sass: Official Sass port of Bootstrap 2 and 3.</a></li>
</ul>
<p>bootstrap-sass をインストールしたい Rails アプリの <code>Gemfile</code> に、以下を追記する。</p>
<pre class="language-ruby"><code class="language-ruby">gem <span class="token string">'sass-rails'</span><span class="token punctuation">,</span> <span class="token string">'>= 3.2'</span>
gem <span class="token string">'bootstrap-sass'</span><span class="token punctuation">,</span> <span class="token string">'~> 3.3.6'</span>
</code></pre>
<p><code>>=</code> はそのバージョン以上の最新をインストール。<code>~></code> はそのバージョン以上で、メインバージョンが上がらない範囲で最新をインストール、という書き方。</p>
<p><code>sass-rails</code> の方は、Rails アプリを new した時点で <code>Gemfile</code> の上の方に既に書いてあるかもしれない。その場合は重複して書かないように。</p>
<p><code>Gemfile</code> を書き換えたら、この定義ファイルの内容に従って gem をインストールするため、<code>bundle install</code> コマンドを打つ。</p>
<pre class="language-bash"><code class="language-bash">$ bundle <span class="token function">install</span>

…<span class="token punctuation">(</span>中略<span class="token punctuation">)</span>…
Using sass-rails <span class="token number">5.0</span>.6
Installing bootstrap-sass <span class="token number">3.3</span>.7
Installing autoprefixer-rails <span class="token number">6.7</span>.7
…<span class="token punctuation">(</span>中略<span class="token punctuation">)</span>…

Bundle complete<span class="token operator">!</span> <span class="token number">13</span> Gemfile dependencies, <span class="token number">58</span> gems now installed.
Use <span class="token variable"><span class="token variable">`</span>bundle show <span class="token punctuation">[</span>gemname<span class="token punctuation">]</span><span class="token variable">`</span></span> to see where a bundled gem is installed.
</code></pre>
<p>とまぁこんな感じでインストールされる。</p>
<p>何やら勝手に <code>autoprefixer-rails</code> もインストールされた。bootstrap-sass が依存しているためか、勝手にインストールされたのだろう。これも <code>Gemfile</code> に書いておきたい便利 gem で、CSS でベンダプレフィックスをいちいち書かなくとも、Rails がコンパイル時に勝手にベンダプレフィックスを付与してくれるという gem なのだ。せっかくだから <code>Gemfile</code> に明記しておいて、念のため再度 <code>bundle install</code> しておこうか。</p>
<pre class="language-ruby"><code class="language-ruby"><span class="token comment"># Gemfile</span>

<span class="token comment"># Autoprefixer Rails</span>
gem <span class="token string">'autoprefixer-rails'</span>
</code></pre>
<pre class="language-bash"><code class="language-bash">$ bundle <span class="token function">install</span>

Bundle complete<span class="token operator">!</span> <span class="token number">14</span> Gemfile dependencies, <span class="token number">58</span> gems now installed.
Use <span class="token variable"><span class="token variable">`</span>bundle show <span class="token punctuation">[</span>gemname<span class="token punctuation">]</span><span class="token variable">`</span></span> to see where a bundled gem is installed.
</code></pre>
<p>さっきので既に <code>autoprefixer-rails</code> もインストールはされているので「<code>58 gems now installed.</code>」の数字は変わらないが、<code>Gemfile</code> に明記したので「<code>13 Gemfile dependencies</code>」が「<code>14 Gemfile dependencies</code>」に変わっている。</p>
<p>インストール自体はコレでいいのだが、Bootstrap の CSS (厳密には Scss ファイル) と JavaScript (jQuery 依存しているスクリプト部分) を、Rails を通して読み込ませてやるための初期設定が必要になる。</p>
<h2 id="scss-の初期設定"><a class="header-link" href="#scss-の初期設定"><span class="header-link-mark"></span></a>Scss の初期設定</h2>
<p>Rails アプリ全体で読み込まれる CSS は、<code>app/assets/stylesheets/application.css</code> というファイルに書くことになる。今回はコレを Scss 記法で書くため、<em>ファイル名を <code>application.scss</code> にリネームする</em> (<code>application.css.scss</code> としても OK)。</p>
<p>この中には、デフォルトでは以下のようなコメントが書かれている。</p>
<pre class="language-scss"><code class="language-scss"><span class="token comment">/*
 * This is a manifest file that'll be compiled into application.css, which will include all the files
 * listed below.
 *
 * Any CSS and SCSS file within this directory, lib/assets/stylesheets, vendor/assets/stylesheets,
 * or any plugin's vendor/assets/stylesheets directory can be referenced here using a relative path.
 *
 * You're free to add application-wide styles to this file and they'll appear at the bottom of the
 * compiled file so the styles you add here take precedence over styles defined in any other CSS/SCSS
 * files in this directory. Styles in this file should be added after the last require_* statement.
 * It is generally better to create a new file per style scope.
 *
 *= require_tree .
 *= require_self
 */</span>
</code></pre>
<p>このうち、</p>
<pre class="language-scss"><code class="language-scss">*= require_tree .
*= require_self
</code></pre>
<p>この <code>*=</code> で始まる2行は、<em>実はコメントではなく、Rails が特別に解釈して動作する実処理の行</em>なのである。</p>
<h3 id="アセットパイプライン"><a class="header-link" href="#アセットパイプライン"><span class="header-link-mark"></span></a>アセット・パイプライン</h3>
<p>これは、書いた順に指定したアセット (資産の意・この場合はスタイルシートファイル) を読み込んでくれる「<strong>アセット・パイプライン</strong>」という仕組みで、Rails はこの仕組を使って CSS と JS を勝手にコンパイル・結合してくれるのだ。ザックリ言ってしまえば、Rails が用意している Browserify・Gulp・Webpack 的な仕組み、といったところか。</p>
<p>この <code>application.scss</code> と、後述する <code>application.js</code> は、他のファイルを読み込んでアプリ全体に適用していくので、「マニフェストファイル」と呼ばれている。</p>
<p><code>require</code> というところから、まぁ何やら Import・Include 的なことをするのだなということは想像できると思う。具体的に <code>tree</code> と <code>self</code> が何をしているのかは以下のとおり。</p>
<ul>
  <li><code>*= require_tree .</code> … 対象のパスを示すため、ドット <code>.</code> が付いている。つまり、このファイルがあるディレクトリ内のファイルを全部取ってきて読み込み結合してくれる (結合順序は保証しない)</li>
  <li><code>*= require_self</code> … そのファイルの内容をその指定の順番で出力する</li>
</ul>
<p>「なんだ、色々読み込んでくれるなら便利なんじゃん？」と思うが、Scss を使う場合はこの <code>require</code> を使ってはいけない。</p>
<ul>
  <li>参考 : <a href="http://qiita.com/samurairunner/items/da22eddb64e867b4e145">Railsのマニフェストファイルを使ったJsとStylesheetの呼び出し - Qiita</a></li>
  <li>参考 : <a href="http://blog.livedoor.jp/sasata299/archives/51851170.html">Rails3.1から導入されたAsset Pipelineがよくわかってなかったから調べた - (ﾟ∀ﾟ)o彡 sasata299's blog</a></li>
</ul>
<h3 id="scss-を使うなら-require-は使わない"><a class="header-link" href="#scss-を使うなら-require-は使わない"><span class="header-link-mark"></span></a>Scss を使うなら <code>require</code> は使わない</h3>
<p><code>sass-rails</code> と <code>bootstrap-sass</code> を導入し、Scss を使う場合は、この <code>require</code> を使わずに、<code>@import</code> という Scss の書式でマニフェストファイルを書く必要が出てくる。これは公式のインストール方法としても記載されている。</p>
<blockquote>
  <p>Then, remove all the <code>*= require_self</code> and <code>*= require_tree .</code> statements from the sass file. Instead, use <code>@import</code> to import Sass files.</p>
  <p>Do not use <code>*= require</code> in Sass or your other stylesheets will not be able to access the Bootstrap mixins or variables.</p>
</blockquote>
<p><code>require</code> を使っても、他の <code>.scss</code> ファイルは正しく読み込んで結合してくれるのだが、変数やミックスインといった、Sass 独自の機能にアクセスできないという欠点がある (多分アセット・パイプラインは <code>.scss</code> ファイルを個別にコンパイルし、最後に Concat するのだろう。これだと変数のスコープが保てないのだと推測できる)。つまり、Bootstrap (bootstrap-sass) が用意している変数を参照したりできないのである。</p>
<p>そのため、Scss の機能を生かして他のファイルを読み込ませるために <code>@import</code> という記法を使うのである。</p>
<ul>
  <li><a href="http://akameco.hatenablog.com/entry/2015/02/15/055113">Railsにbootstrap-sassを導入する - もはや芽は枯れた</a>
    <ul>
      <li>
        <blockquote>
          <p><code>//= require_tree</code> はどうするんだといえば、代わりに sass の <code>@import</code> を利用する。 require で読み込んだら bootstrap のミックスインや変数にアクセスできない。</p>
        </blockquote>
      </li>
    </ul>
  </li>
</ul>
<h3 id="ではマニフェストファイルを書き換えよう"><a class="header-link" href="#ではマニフェストファイルを書き換えよう"><span class="header-link-mark"></span></a>ではマニフェストファイルを書き換えよう</h3>
<p>仕組みの話が長くなってしまったが、まずは先ほどの <code>*= require</code> で始まる行を削除する。コメントアウトとして残しておくのであれば、「<code>=</code>」を消して、<code>* require_tree</code> といったコメントとして残しておくと良いだろう。</p>
<p>そして、Bootstrap を使うには以下の2行の <code>@import</code> を書く。</p>
<pre class="language-scss"><code class="language-scss"><span class="token comment">// Bootstrap Sass</span>
<span class="token keyword">@import</span> <span class="token string">"bootstrap-sprockets"</span><span class="token punctuation">;</span>
<span class="token keyword">@import</span> <span class="token string">"bootstrap"</span><span class="token punctuation">;</span>
</code></pre>
<p>必ず <code>bootstrap-sprockets</code> の方を先に書く。</p>
<ul>
  <li>参考 : <a href="https://yet.unresolved.xyz/blog/2016/04/11/using-the-customized-bootstrap-in-rails/">https://yet.unresolved.xyz/blog/2016/04/11/using-the-customized-bootstrap-in-rails/</a>
    <ul>
      <li>
        <blockquote>
          <p>ちなみに <code>bootstrap-sprockets</code> はフォントパスとかの書き換えをやってくれてる。</p>
        </blockquote>
      </li>
    </ul>
  </li>
</ul>
<p>なお、Scss の中では通常の CSS では使えない、<em>「<code>//</code>」で始まる1行コメントが書ける</em>。JavaScript チックなコメントも書けるというワケだ。この1行コメントはコンパイル時に削除されるので、コンパイル後も残したいコメントは「<code>/*! コメント */</code>」と書くと良い。</p>
<ul>
  <li>参考 : <a href="http://d.hatena.ne.jp/nenjiru/20111115/scss_comment_style">SCSSの3つのコメントスタイル - 眠る前に布団にはいろうか</a></li>
</ul>
<p>全体としては、以下のように書き換えた。</p>
<pre class="language-scss"><code class="language-scss"><span class="token comment">/* 
 * This is a manifest file that'll be compiled into application.css, which will include all the files
 * listed below.
 * 
 * Any CSS and SCSS file within this directory, lib/assets/stylesheets, vendor/assets/stylesheets,
 * or any plugin's vendor/assets/stylesheets directory can be referenced here using a relative path.
 * 
 * You're free to add application-wide styles to this file and they'll appear at the bottom of the
 * compiled file so the styles you add here take precedence over styles defined in any other CSS/SCSS
 * files in this directory. Styles in this file should be added after the last require_* statement.
 * It is generally better to create a new file per style scope.
 * 
 * require は使わない
 *   require_tree .
 *   require_self
 */</span>

<span class="token comment">// Bootstrap Sass</span>
<span class="token keyword">@import</span> <span class="token string">"bootstrap-sprockets"</span><span class="token punctuation">;</span>
<span class="token keyword">@import</span> <span class="token string">"bootstrap"</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="require-と-import-と資産管理方法について"><a class="header-link" href="#require-と-import-と資産管理方法について"><span class="header-link-mark"></span></a><code>require</code> と <code>@import</code> と資産管理方法について</h3>
<p>こうすると <code>*= require_tree .</code> しないんだからコントローラごとの CSS が読み込めないじゃないか～どうしたらええねん～、となるが、みんな資産の管理方法は色々悩んでいるようである。</p>
<p>一見便利なアセット・パイプラインだが、実は色んな問題があって、「少なくとも <code>*= require_tree .</code> は良くないよね」という流れになっている。</p>
<p>すなわち、配下の全ファイルを読み込むということは、無関係なコントローラ向けのスタイルも含んでいるし、その結合順序は保証されていないから、意図しないスタイルのカスケードが発生しうるということだ。ファイルサイズとしても重たくなるので、必要なページで必要なスタイルだけ読み込むべきだ、と。全ページに適用させるのは、こういう Bootstrap のような全体的なテーマだとか、Reset.css みたいなモノに限ろう、ということみたいである。</p>
<p><code>@import</code> で <code>*= require_tree .</code> みたいなことがしたいのであれば、<code>app/assets/stylesheets/partials/</code> というディレクトリを作り、<code>application.scss</code> からは</p>
<pre class="language-scss"><code class="language-scss"><span class="token keyword">@import</span> <span class="token string">"partials/*"</span><span class="token punctuation">;</span>
</code></pre>
<p>と書いて、配下の全ファイルを読み込ませることができる。</p>
<p>この辺は「こういうレールですよ！」という明確な決まりがないので、以下を参考にドウゾ。</p>
<ul>
  <li>参考 : <a href="http://beautifulajax.dip.jp/?p=303">Rails require_treeを排除し、アセットパイプラインで、コントローラー固有のCSS、JavaScriptを組み込む</a> … <code>require_tree</code> を使わない管理方法3パターン。</li>
  <li>参考 : <a href="http://at284km.hatenablog.com/entry/2015/08/08/045749">rails なるべく簡単に bootstrap を使う方法を考えてみた - 日常</a> … <code>@import "partials/*";</code> の方法。</li>
  <li>参考 : <a href="http://blog.10rane.com/2015/04/02/how-to-manage-the-page-specific-scss-in-rails/">Railsでページごとのscssを管理する方法 -- blog.10rane.com</a> … こちらも <code>partials</code> ディレクトリを作る方法。
    <ul>
      <li>
        <blockquote>
          <p>partialsディレクトリにファイルがないとエラーになる</p>
        </blockquote>
      </li>
    </ul>
  </li>
  <li>参考 : <a href="http://stackoverflow.com/questions/21643364/bootstrap-sass-with-rails-4">css - Bootstrap Sass with Rails 4 - Stack Overflow</a> … 「ぼくはこうやっているよ」という回答がいくつかある。<code>@import</code> を個別に書いているパターンとか。</li>
</ul>
<h2 id="javascript-の初期設定"><a class="header-link" href="#javascript-の初期設定"><span class="header-link-mark"></span></a>JavaScript の初期設定</h2>
<p>Scss の話が長くなってしまった。続いては Bootstrap が使用する JavaScript をマニフェスト・ファイルで読み込ませる。</p>
<p><code>app/assets/javascripts/application.js</code> を開くと、デフォルトでは以下のような状態になっていると思う。</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token comment">// This is a manifest file that'll be compiled into application.js, which will include all the files</span>
<span class="token comment">// listed below.</span>
<span class="token comment">//</span>
<span class="token comment">// Any JavaScript/Coffee file within this directory, lib/assets/javascripts, vendor/assets/javascripts,</span>
<span class="token comment">// or any plugin's vendor/assets/javascripts directory can be referenced here using a relative path.</span>
<span class="token comment">//</span>
<span class="token comment">// It's not advisable to add code directly here, but if you do, it'll appear at the bottom of the</span>
<span class="token comment">// compiled file. JavaScript code in this file should be added after the last require_* statement.</span>
<span class="token comment">//</span>
<span class="token comment">// Read Sprockets README (https://github.com/rails/sprockets#sprockets-directives) for details</span>
<span class="token comment">// about supported directives.</span>
<span class="token comment">//</span>
<span class="token comment">//= require jquery</span>
<span class="token comment">//= require jquery_ujs</span>
<span class="token comment">//= require turbolinks</span>
<span class="token comment">//= require_tree .</span>
</code></pre>
<p>先ほどの <code>application.scss</code> と同様に、この <code>application.js</code> の場合も「<code>//= require_tree .</code>」という一見コメントに見える行が、アセット・パイプラインの設定をしている。</p>
<p>このデフォルトの記述だと、下から4行分が require をしていて、jQuery → jQuery ujs (Rails が使うライブラリ) → Turbolinks (画面遷移を Ajax で行い高速化を図る Rails が用意した仕組み) → <code>tree .</code> すなわちその他のスクリプト、という順番で読み込んでいる。</p>
<p>Bootstrap の JS は jQuery を必要とするので、「<code>//= require jquery</code>」よりも後の行に、以下の1行を追加する。</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token comment">// Bootstrap Sass</span>
<span class="token comment">//= require bootstrap-sprockets</span>
</code></pre>
<p>この辺の読み込み順の関係は、静的な HTML で Bootstrap を読み込む場合の script 要素の登場順と同じことである。</p>
<p>なお、ここで読み込ませるのは <code>//= require bootstrap</code> でも良い。違いは、Bootstrap のスクリプトファイルを個別に渡しているのが <code>bootstrap-sprockets</code> で、結合した1ファイルを渡しているのが <code>bootstrap</code> という違い。よく分からなければ上のままで。両方書いてはいけない。</p>
<blockquote>
  <p><code>bootstrap-sprockets</code> and <code>bootstrap</code> should not both be included in <code>application.js</code>.</p>
  <p><code>bootstrap-sprockets</code> provides individual Bootstrap Javascript files (<code>alert.js</code> or <code>dropdown.js</code>, for example), while <code>bootstrap</code> provides a concatenated file containing all Bootstrap Javascripts.</p>
</blockquote>
<h2 id="初期設定完了"><a class="header-link" href="#初期設定完了"><span class="header-link-mark"></span></a>初期設定完了！</h2>
<p>長々と Rails でのアセット管理方法や仕組みについて絡めて書いてきたが、Rails アプリで Bootstrap を使うために必要なことを縮めると、以下にまとまる。</p>
<pre class="language-ruby"><code class="language-ruby"><span class="token comment"># Gemfile</span>

gem <span class="token string">'sass-rails'</span><span class="token punctuation">,</span> <span class="token string">'>= 3.2'</span>
gem <span class="token string">'bootstrap-sass'</span><span class="token punctuation">,</span> <span class="token string">'~> 3.3.6'</span>
</code></pre>
<pre class="language-bash"><code class="language-bash">$ bundle <span class="token function">install</span>
</code></pre>
<pre class="language-scss"><code class="language-scss"><span class="token comment">// app/assets/stylesheets/application.scss</span>

<span class="token keyword">@import</span> <span class="token string">"bootstrap-sprockets"</span><span class="token punctuation">;</span>
<span class="token keyword">@import</span> <span class="token string">"bootstrap"</span><span class="token punctuation">;</span>
</code></pre>
<pre class="language-javascript"><code class="language-javascript"><span class="token comment">// app/assets/javascripts/application.js</span>

<span class="token comment">//= require jquery</span>
<span class="token comment">//= require bootstrap-sprockets</span>
</code></pre>
<p>これで Rails アプリの全ページに Bootstrap が適用されている。</p>
<p>試しに <code>rails server</code> でサーバを起動し、適当なページを開いてみよう。Bootstrap のデフォルトスタイルが適用されていることが確認できると思う。</p>
<h2 id="もう少し-html-側で設定"><a class="header-link" href="#もう少し-html-側で設定"><span class="header-link-mark"></span></a>もう少し HTML 側で設定</h2>
<p>全体の HTML を定義している <code>app/views/layouts/application.html.erb</code> を開き、いくつか meta 要素を書いておこう。</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>X-UA-Compatible<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>IE=Edge<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
</code></pre>
<p>Bootstrap の推奨テンプレートと同様に、ViewPort の設定とかをしておく。そういえば Rails の初期状態では charset 指定もないので追加しておいた。</p>
<p>あとは各 View の中で、各要素に Bootstrap の class を付与していけば Bootstrap デザインのできあがり。</p>
<pre class="language-html"><code class="language-html"><span class="token comment">&#x3C;!-- たとえば一覧ページとかで… --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container-fluid<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>table-responsive<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>table</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>table table-bordered table-hover<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
      <span class="token comment">&#x3C;!-- 省略 --></span>
</code></pre>
<p>こんな感じでレスポンシブルなテーブルのできあがり！</p>
<h2 id="その他参考"><a class="header-link" href="#その他参考"><span class="header-link-mark"></span></a>その他参考</h2>
<ul>
  <li><a href="http://qiita.com/masamitsu-konya/items/e3630046774ac1fbd346">全部はいらないよね？bootstrap-sassをカスタマイズして使う方法 - Qiita</a> … インストール方法とカスタマイズ方法、および <code>autoprefixer-rails</code> についても触れている。</li>
  <li><a href="https://programming.wikihub.io/@r7kamura/20160428211223">Railsにnode_modules以下のassetsを認識させる - Programming</a> … RubyGem ではなく npm で bootstrap-sass を導入する方法。</li>
  <li><a href="http://qiita.com/Oakbow/items/2e712e05bb4bbf68faf5">Railsで、任意のJavaScriptやCSSだけを読み込む - Qiita</a> … <code>require</code> について色々。</li>
  <li><a href="http://kray.jp/blog/must-know-about-turbolinks/">Rails 4のturbolinksについて最低でも知っておきたい事 | KRAY Inc</a> … 途中で出てきた Turbolinks の弊害について。</li>
  <li><a href="http://easyramble.com/about-asset-pipeline.html">RailsのAsset Pipelineの理解とgemで管理しないJavaScriptライブラリの配置 | EasyRamble</a> … サードパーティライブラリは <code>vendor/assets/</code> 配下に入れて管理できる。</li>
  <li><a href="http://hamasyou.com/blog/2014/03/05/rails-webservice-startup/">Webサービスをスタートアップする10の手順（Rails編） - それはBooks</a> … Rails アプリ作成時全般の Tips。Bootstrap は静的な資産を格納して使用するやり方。</li>
  <li><a href="http://keruuweb.com/rails-jquery%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B/">Rails jQueryを使用する – KeruuWeb</a> … Rails にデフォルトで組み込まれる jQuery を使用し、外部ファイル化するまでの入門解説。</li>
  <li><a href="http://qiita.com/teitei_tk/items/bf444c6aa6398bde83bf">Railsでvendor/assets/javascripts以下にあるファイルを特定のページでのみ使用する - Qiita</a> … 特定ページで特定のスクリプトを読み込ませる</li>
</ul>

      </main>
      <footer id="footer">
        <div id="footer-contents">
          <div id="date-time">
            <dl>
              <dt>Created</dt>
              <dd><time>2017-03-17</time></dd>
              <dt>Last-Modified</dt>
              <dd><time>2017-03-17</time></dd>
            </dl>
          </div>
          <nav id="footer-links">
            <ul>
              <li id="footer-link-about"><a href="/about/index.html" title="About">About</a></li>
              <li id="footer-link-search"><a href="/about/search.html" title="Search">Search</a></li>
              <li id="footer-link-feeds"><a href="/feeds.xml" title="Feeds">Feeds</a></li>
              <li id="footer-link-github"><a href="https://github.com/Neos21/" title="GitHub">GitHub</a></li>
            </ul>
          </nav>
          <nav id="to-top"><a href="#" title="To Top"><span>▲ To Top</span></a></nav>
        </div>
      </footer>
    </div>
  </body>
</html>
