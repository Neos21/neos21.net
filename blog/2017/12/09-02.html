<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="theme-color" content="#0990d0">
    <!-- Google Search Console -->
    <meta name="google-site-verification" content="AvoEr3mUJFF2H_mPWWgShfmjBVP3ywRpyx9hxeeq2d4">
    <title>SASS/SCSS ファイルを読み込んでブラウザ上でコンパイル・適用する「in-browser-sass」を作った - Neo's World</title>
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="/styles.css">
    <link rel="canonical" href="https://neos21.net/blog/2017/12/09-02.html">
    <link rel="search" type="application/opensearchdescription+xml" title="neos21.net" href="/opensearch.xml">
    <link rel="alternate" type="application/atom+xml" title="Feeds" href="/feeds.xml">
    <link rel="author" href="http://www.hatena.ne.jp/neos21/">
    <script defer src="/scripts.js"></script>
    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YMHFLZP1M1"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date());gtag('config','G-YMHFLZP1M1');gtag('config','UA-106501-1');</script>
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6475907504235292" crossorigin="anonymous"></script>
  </head>
  <body>
    <div id="container">
      <header id="header">
        <div id="header-brand">
          <div id="header-brand-contents">
            <div id="site-title"><a href="/index.html">Neo's World</a></div>
            <nav id="header-links">
              <ul>
                <li id="header-link-about"><a href="/about/index.html" title="About"><span>About</span></a></li>
                <li id="header-link-search"><a href="/about/search.html" title="Search"><span>Search</span></a></li>
                <li id="header-link-feeds"><a href="/feeds.xml" title="Feeds"><span>Feeds</span></a></li>
                <li id="header-link-to-bottom"><a href="#footer" title="To Bottom"><span>▼ To Bottom</span></a></li>
              </ul>
            </nav>
          </div>
        </div>
        <nav id="global-nav">
          <ul>
            <li><a href="/blog/index.html">Blog</a></li>
            <li><a href="/tech/index.html">Tech</a></li>
            <li><a href="/music/index.html">Music</a></li>
            <li><a href="/games/index.html">Games</a></li>
            <li><a href="/gallery/index.html">Gallery</a></li>
            <li><a href="/etc/index.html">Etc.</a></li>
          </ul>
        </nav>
        <nav id="path">
          <ul>
            <li><a href="/index.html">Neo's World</a></li>
            <li><a href="/blog/index.html">Blog</a></li>
            <li><a href="/blog/2017/index.html">2017年</a></li>
            <li><a href="/blog/2017/12/index.html">12月</a></li>
          </ul>
        </nav>
      </header>
      <main id="main">
        <div id="header-date"><time>2017-12-09</time></div>
        <h1 id="page-title">SASS/SCSS ファイルを読み込んでブラウザ上でコンパイル・適用する「in-browser-sass」を作った</h1>

<p>HTML に <code>link</code> 要素で SASS 記法のファイルを読み込ませたり、<code>style</code> 要素で SCSS 記法のコードを埋め込んだりして、それをブラウザ上でコンパイルして通常の CSS として適用させるライブラリ <strong>in-browser-sass</strong> を作った。</p>
<h2 id="目次"><a class="header-link" href="#目次"><span class="header-link-mark"></span></a>目次</h2>
<ul>
  <li><a href="#%E3%83%87%E3%83%A2">デモ</a></li>
  <li><a href="#%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E3%81%AE%E4%BD%BF%E3%81%84%E6%96%B9">ライブラリの使い方</a></li>
  <li><a href="#%E5%AE%9F%E7%94%A8%E6%80%A7%E3%81%AF">実用性は？</a></li>
  <li><a href="#%E3%81%93%E3%81%AE%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E3%82%92%E4%BD%9C%E3%82%8B%E3%81%BE%E3%81%A7">このライブラリを作るまで</a></li>
  <li><a href="#%E5%AE%9F%E8%A3%85%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6">実装について</a>
    <ul>
      <li><a href="#%E9%96%A2%E6%95%B0%E8%B5%B7%E5%8B%95%E5%87%A6%E7%90%86">関数起動処理</a></li>
      <li><a href="#linkstyle-%E8%A6%81%E7%B4%A0%E3%81%AE%E5%8F%8E%E9%9B%86"><code>link</code>・<code>style</code> 要素の収集</a></li>
      <li><a href="#style-%E8%A6%81%E7%B4%A0%E3%81%AE%E5%87%A6%E7%90%86"><code>style</code> 要素の処理</a></li>
      <li><a href="#link-%E8%A6%81%E7%B4%A0%E3%81%AE%E5%87%A6%E7%90%86"><code>link</code> 要素の処理</a></li>
      <li><a href="#%E3%82%B3%E3%83%B3%E3%83%91%E3%82%A4%E3%83%AB%E7%94%A8%E3%81%AE%E9%96%A2%E6%95%B0">コンパイル用の関数</a></li>
    </ul>
  </li>
</ul>
<h2 id="デモ"><a class="header-link" href="#デモ"><span class="header-link-mark"></span></a>デモ</h2>
<p>ライブラリの紹介ページで実際に使ってみているので、以下のページを開発者ツール等で見てみて欲しい。</p>
<ul>
  <li><a href="https://neos21.github.io/in-browser-sass/">in-browser-sass</a></li>
</ul>
<p>初期表示でウニウニとスタイルが動くはず。裏で外部 SASS / SCSS ファイルを読み込んで処理したりしているので、反映までに若干時間がかかる。</p>
<h2 id="ライブラリの使い方"><a class="header-link" href="#ライブラリの使い方"><span class="header-link-mark"></span></a>ライブラリの使い方</h2>
<p>このライブラリは <a href="https://github.com/medialize/sass.js/">sass.js</a> というライブラリを使用して、ブラウザ上で JavaScript だけで SASS/SCSS をコンパイルしている。そのため、本ライブラリと同時に sass.js を読み込んでおく必要がある。</p>
<p>本ライブラリについては npm より <strong><code>npm install @neos21/in-browser-sass</code></strong> で取得してもいいし、unpkg.com を CDN として利用してもらっても良い。</p>
<pre class="language-html"><code class="language-html"><span class="token comment">&#x3C;!-- sass.js を読み込む --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdnjs.cloudflare.com/ajax/libs/sass.js/0.10.7/sass.sync.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>script</span><span class="token punctuation">></span></span>

<span class="token comment">&#x3C;!-- 本ライブラリを読み込む --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://unpkg.com/@neos21/in-browser-sass@1.0.2/in-browser-sass.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
<p>次に SASS/SCSS コードを用意するワケだが、<code>link</code> 要素で <code>.sass</code> ファイルや <code>.scss</code> ファイルを外部読み込みしても良いし、<code>style</code> 要素で埋め込んでも良い。その際、<em>SASS 記法なら <code>type="text/sass"</code></em>、<strong>SCSS 記法なら <code>type="text/scss"</code></strong> と属性を振っておくこと。</p>
<pre class="language-html"><code class="language-html"><span class="token comment">&#x3C;!-- 以下のいずれの方法でも読み込み可能 --></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/sass<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>example.sass<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/scss<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>example.scss<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>style</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/sass<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css"> <span class="token comment">/* SASS 記法 */</span> </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>style</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>style</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/scss<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css"> <span class="token comment">/* SCSS 記法 */</span> </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>style</span><span class="token punctuation">></span></span>
</code></pre>
<p><code>style</code> 要素は <code>body</code> 要素に書いても問題ない。</p>
<p>ページが開かれると、本ライブラリがコンパイルを行い、<strong>元の <code>link</code>・<code>style</code> 要素の直後にコンパイルした CSS コードを配置する</strong>。つまり以下のようになる。</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/sass<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>example.sass<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>style</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css"> <span class="token comment">/* example.sass の内容 */</span> </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>style</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/scss<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>example.scss<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>style</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css"> <span class="token comment">/* example.scss の内容 */</span> </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>style</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>style</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/sass<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css"> <span class="token comment">/* SASS 記法 */</span> </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>style</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>style</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css"> <span class="token comment">/* 「SASS 記法」の内容 */</span> </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>style</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>style</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/scss<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css"> <span class="token comment">/* SCSS 記法 */</span> </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>style</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>style</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css"> <span class="token comment">/* 「SCSS 記法」の内容 */</span> </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>style</span><span class="token punctuation">></span></span>
</code></pre>
<p><em>コレにより、複数の SASS/SCSS ファイルを書いた時のカスケード順が保持される。</em></p>
<h2 id="実用性は"><a class="header-link" href="#実用性は"><span class="header-link-mark"></span></a>実用性は？</h2>
<p><strong>本ライブラリ、実用性はほとんどない。お遊びとして使うに留めてほしい。</strong></p>
<p>まず、利用している sass.js のコンパイラが 3MB 以上あるので、それだけでも読み込みに時間がかかる。</p>
<p>それに、<code>link</code> 要素を使用している場合は本ライブラリが Ajax で再度そのファイルを取得しに行くので、外部 SASS / SCSS ファイルへのリクエスト数が2倍になる。それからコンパイルを行い、DOM 要素として挿入するので、ページに実際に CSS が適用されるまでラグがある。</p>
<p>そんなワケで、実用は難しい。プロダクトではちゃんとプリコンパイルしたコードを使おう。</p>
<h2 id="このライブラリを作るまで"><a class="header-link" href="#このライブラリを作るまで"><span class="header-link-mark"></span></a>このライブラリを作るまで</h2>
<p>あとはこのライブラリを作るまでの軌跡。</p>
<p>初めは、ふと「SASS ってブラウザ上でコンパイルできないのかね？」と思い立ったところ。LESS は JavaScript ベースで、SASS は Ruby ベースだったと思うので、移植されていないかなーと思ったら、既に <em>libsass</em> というプロジェクトがあるようだった。libsass は C/C++ で実装していて、ほぼほぼ互換性が保たれているようだ。</p>
<ul>
  <li>参考 : <a href="https://qiita.com/tkosuga@github/items/46094b630f57594e86f0">速いsass、libsassについて超簡単な説明 - Qiita</a></li>
</ul>
<p>そしてその中で sass.js という JavaScript への移植版が見つかったので、コレを使うかーと思い立った。</p>
<ul>
  <li>参考 : <a href="https://github.com/medialize/sass.js/">GitHub - medialize/sass.js: Sass.js - API for emscripted libsass to run in the browser</a></li>
</ul>
<p>で、よくよく sass.js を管理している GitHub のオーガナイザを見ていたら、「browser-sass」なるリポジトリを発見。なんだ既にあるんか、と思いきや Work in progress だった。</p>
<ul>
  <li>参考 : <a href="https://github.com/medialize/browser-sass">GitHub - medialize/browser-sass: Browser bindings to libsass (via Sass.js)</a></li>
</ul>
<p>ただ、イシューによさげなコードは載っていて、<code>link</code> 要素は Ajax で取得すりゃいいのかなーとか思ってた。ファイル内での <code>@import</code> を解決していないんだけども (コレは本ライブラリも同じ)。</p>
<p>もう少し調べていると、今度は SCSS 限定で同じことをやろうとしている <em>browser-scss</em> というツールを公開している人がいて、大部分はこのライブラリから着想を得た。</p>
<ul>
  <li>参考 : <a href="https://github.com/myrcutio/browser-scss">GitHub - myrcutio/browser-scss: Compile text/scss style tags in the browser with sass.js</a></li>
</ul>
<p>ただ、このライブラリは <code>style</code> 要素で埋め込んだ SCSS 記法のみ対応していたのと、不要な処理が混じっていたりしたので、ゼロから作り直すことにした。</p>
<h2 id="実装について"><a class="header-link" href="#実装について"><span class="header-link-mark"></span></a>実装について</h2>
<p>本ライブラリのコード全量は以下で確認できる。コメントを日本語で書く乱暴さ。</p>
<ul>
  <li><a href="https://github.com/Neos21/in-browser-sass/blob/master/in-browser-sass.js">in-browser-sass/in-browser-sass.js at master · Neos21/in-browser-sass · GitHub</a></li>
</ul>
<p>全体は <code>inBrowserSass()</code> という一つの関数に処理を入れていて、最後に「ブラウザ上で実行されているか」などを確認している。</p>
<p>まずはその最後の部分を紹介しようかしら。</p>
<h3 id="関数起動処理"><a class="header-link" href="#関数起動処理"><span class="header-link-mark"></span></a>関数起動処理</h3>
<ul>
  <li><a href="https://github.com/Neos21/in-browser-sass/blob/master/in-browser-sass.js#L46">in-browser-sass/in-browser-sass.js at master · Neos21/in-browser-sass · GitHub</a> … 46行目から</li>
</ul>
<p>ブラウザで動作しているかは <code>window</code> や <code>document</code> が存在していれば OK とする。<code>typeof 【対象】 !== 'undefined'</code> と文字列にして比較するのが確実。</p>
<p>ページ全体にある <code>link</code>・<code>style</code> 要素を拾うために <code>DOMContentLoaded</code> イベントまで待ってから処理を始める。グローバルに <code>Sass</code> オブジェクトがあれば、メイン処理 <code>inBrowserSass()</code> を呼ぶだけで終わり。</p>
<p><code>Sass</code> がない場合は、sass.js が読み込めていないので、CDN から読み込みを試みる。<code>script</code> 要素を生成し、CDN の URL をブチ込み、<code>script</code> 要素に <code>onload</code> イベント属性を付与して、sass.js が読み込めたら <code>inBrowserSass()</code> 関数を呼ぶようにしてある。この <code>script</code> 要素を <code>head</code> 要素に埋め込めば、自動的に sass.js の読み込みが始まり、読み込みが完了次第 <code>onload</code> イベントに指定した <code>inBrowserSass()</code> 関数が実行される、というワケ。</p>
<h3 id="linkstyle-要素の収集"><a class="header-link" href="#linkstyle-要素の収集"><span class="header-link-mark"></span></a><code>link</code>・<code>style</code> 要素の収集</h3>
<p>続いて <code>inBrowserSass()</code> 関数の中の説明。先に <code>compileAndInsert()</code> という関数を用意しているがコレは後述。先に <code>link</code> 要素と <code>style</code> 要素を収集するところから。</p>
<ul>
  <li><a href="https://github.com/Neos21/in-browser-sass/blob/master/in-browser-sass.js#L14">in-browser-sass/in-browser-sass.js at master · Neos21/in-browser-sass · GitHub</a> … 14行目から</li>
</ul>
<p>DOM 要素の収集には <code>document.querySelectorAll()</code> を使った。この API、<code>document.querySelectorAll('style, link')</code> のようにして<em>要素を複数列挙して一気に取得できる</em>のだ。</p>
<p>こうして取得した要素のコレクションは <strong>Array Like</strong> なオブジェクトで、<code>forEach()</code> するために <code>Array.prototype.forEach.call()</code> を使っている。</p>
<p>各要素は <code>type</code> 属性値を拾っていて、<code>text/sass</code> か <code>text/scss</code> でなければ処理しないようにしている。この属性値は後で「SASS コンパイル」「SCSS コンパイル」を振り分けるためにも使っている。</p>
<h3 id="style-要素の処理"><a class="header-link" href="#style-要素の処理"><span class="header-link-mark"></span></a><code>style</code> 要素の処理</h3>
<p>ココで、<code>style</code> 要素と <code>link</code> 要素とで処理が別れる。</p>
<p><code>style</code> 要素の場合は簡単で、<code>innerHTML</code> で内容が拾えるので、コレをコンパイル用の関数に渡すだけ。</p>
<h3 id="link-要素の処理"><a class="header-link" href="#link-要素の処理"><span class="header-link-mark"></span></a><code>link</code> 要素の処理</h3>
<p>一方 <code>link</code> 要素は、外部ファイルの内容を取得しないといけないので、<code>XMLHttpRequest</code> を生成して Ajax GET 通信をしている。<code>responseText</code> が拾えたらコンパイル用の関数に渡している。</p>
<p>この辺の例外ハンドリングとか、クロスブラウザ対応とかした方が良いのかしら？</p>
<h3 id="コンパイル用の関数"><a class="header-link" href="#コンパイル用の関数"><span class="header-link-mark"></span></a>コンパイル用の関数</h3>
<p>コンパイル用の関数 <code>compileAndInsert()</code> の中では、sass.js を使ってコンパイルを行っている。</p>
<ul>
  <li><a href="https://github.com/Neos21/in-browser-sass/blob/master/in-browser-sass.js#L5">in-browser-sass/in-browser-sass.js at master · Neos21/in-browser-sass · GitHub</a> … 5行目から</li>
</ul>
<p><code>Sass.compile()</code> でコンパイルをするのだが、sass.js のコンパイルオプションに <code>indentedSyntax</code> というモノがあり、SASS の場合はコレを <code>true</code> にしないといけない。</p>
<p>コールバック関数でコンパイル結果テキストを受け取り、新規生成した <code>style</code> 要素に詰め込む。<code>style</code> 要素には念のため <code>type="text/css"</code> を付与したが、HTML5 の仕様だとデフォルトで不要みたいなので省いても問題ないか。</p>
<p>「元の要素の直後に挿入する」は、jQuery の <code>after()</code> と同様に、<em><code>【元要素】.parentElement.insertBefore(【入れたい要素】, 【元要素】.nextSibling)</code></em> というイディオムを使っている。</p>
<p>コレで完了。</p>
<hr>
<p>実用性は乏しいが、JavaScript だけで色んなことできるなぁとか、例外ハンドリングちゃんとやろうとしたら大変だな、とか、色んな勉強になった。</p>
<p>Issues や Pull Requests とかがもらえたら対応するので、ぜひチェックしていただたきたく！</p>
<ul>
  <li><a href="https://github.com/Neos21/in-browser-sass">GitHub - Neos21/in-browser-sass: Compile SASS / SCSS in the browser.</a></li>
  <li><a href="https://www.npmjs.com/package/@neos21/in-browser-sass">@neos21/in-browser-sass</a></li>
</ul>

      </main>
      <footer id="footer">
        <div id="footer-contents">
          <div id="date-time">
            <dl>
              <dt>Created</dt>
              <dd><time>2017-12-09</time></dd>
              <dt>Last-Modified</dt>
              <dd><time>2017-12-09</time></dd>
            </dl>
          </div>
          <nav id="footer-links">
            <ul>
              <li id="footer-link-about"><a href="/about/index.html" title="About">About</a></li>
              <li id="footer-link-search"><a href="/about/search.html" title="Search">Search</a></li>
              <li id="footer-link-feeds"><a href="/feeds.xml" title="Feeds">Feeds</a></li>
              <li id="footer-link-github"><a href="https://github.com/Neos21/" title="GitHub">GitHub</a></li>
            </ul>
          </nav>
          <nav id="to-top"><a href="#" title="To Top"><span>▲ To Top</span></a></nav>
        </div>
      </footer>
    </div>
  </body>
</html>
