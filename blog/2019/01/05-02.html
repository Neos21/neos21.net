<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="theme-color" content="#0990d0">
    <!-- Google Search Console -->
    <meta name="google-site-verification" content="AvoEr3mUJFF2H_mPWWgShfmjBVP3ywRpyx9hxeeq2d4">
    <title>ウェブサイトに適用する游ゴシックフォントを見直しまくった最終解 - Neo's World</title>
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="/styles.css">
    <link rel="canonical" href="https://neos21.net/blog/2019/01/05-02.html">
    <link rel="search" type="application/opensearchdescription+xml" title="neos21.net" href="/opensearch.xml">
    <link rel="alternate" type="application/atom+xml" href="/feeds.xml">
    <link rel="author" href="http://www.hatena.ne.jp/neos21/">
    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YMHFLZP1M1"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date());gtag('config','G-YMHFLZP1M1');gtag('config','UA-106501-1');</script>
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6475907504235292" crossorigin="anonymous"></script>
  </head>
  <body>
    <div id="container">
      <header id="header">
        <div id="header-brand">
          <div id="header-brand-contents">
            <div id="site-title"><a href="/index.html">Neo's World</a></div>
            <nav id="header-links">
              <ul>
                <li id="header-link-about"><a href="/about/index.html" title="About"><span>About</span></a></li>
                <li id="header-link-search"><a href="/about/search.html" title="Search"><span>Search</span></a></li>
                <li id="header-link-feeds"><a href="/feeds.xml" title="Feeds"><span>Feeds</span></a></li>
                <li id="header-link-to-bottom"><a href="#footer" title="To Bottom"><span>▼ To Bottom</span></a></li>
              </ul>
            </nav>
          </div>
        </div>
        <nav id="global-nav">
          <ul>
            <li><a href="/blog/index.html">Blog</a></li>
            <li><a href="/tech/index.html">Tech</a></li>
            <li><a href="/music/index.html">Music</a></li>
            <li><a href="/games/index.html">Games</a></li>
            <li><a href="/gallery/index.html">Gallery</a></li>
            <li><a href="/etc/index.html">Etc.</a></li>
          </ul>
        </nav>
        <nav id="path">
          <ul>
            <li><a href="/index.html">Neo's World</a></li>
            <li><a href="/blog/index.html">Blog</a></li>
            <li><a href="/blog/2019/index.html">2019年</a></li>
            <li><a href="/blog/2019/01/index.html">01月</a></li>
          </ul>
        </nav>
      </header>
      <main id="main">
        <div id="header-date"><time>2019-01-05</time></div>
        <h1 id="page-title">ウェブサイトに適用する游ゴシックフォントを見直しまくった最終解</h1>

<p>拙作のノーマライズ CSS ライブラリ、<strong>「<a href="https://neos21.github.io/neos-normalize/">Neo's Normalize</a>」</strong>を見直していたところ、Windows の Chrome ブラウザで適用されている游ゴシックフォントがかすれていた。</p>
<p>「あれ？<code>@font-face</code> で游ゴシック Medium を指定してるのにな？」と思い、設定を見直したところ、コレが効かなくなっていた。</p>
<p>当時 Neo's Normalize を作る際、それなりに調査しまくった結果だったのだが、どうも仕様が変わっていたようなので、OS・ブラウザごとに挙動を見直すことにした。今回はその研究結果をまとめる。</p>
<h2 id="目次"><a class="header-link" href="#目次"><span class="header-link-mark"></span></a>目次</h2>
<ul>
  <li><a href="#%E6%B8%B8%E3%82%B4%E3%82%B7%E3%83%83%E3%82%AF%E3%83%95%E3%82%A9%E3%83%B3%E3%83%88%E3%81%AB%E9%96%A2%E3%81%99%E3%82%8B%E5%9F%BA%E7%A4%8E%E7%9F%A5%E8%AD%98%E3%81%AE%E3%81%8A%E3%81%95%E3%82%89%E3%81%84">游ゴシックフォントに関する基礎知識のおさらい</a></li>
  <li><a href="#chrome-%E3%81%A7%E5%8A%B9%E3%81%8B%E3%81%AA%E3%81%8F%E3%81%AA%E3%81%A3%E3%81%A6%E3%81%84%E3%81%9F-font-face">Chrome で効かなくなっていた <code>@font-face</code></a></li>
  <li><a href="#font-weight-500-%E3%81%AF%E5%8A%B9%E3%81%84%E3%81%9F%E3%81%8C%E5%89%AF%E4%BD%9C%E7%94%A8%E3%81%8C%E9%81%BF%E3%81%91%E3%82%89%E3%82%8C%E3%81%AA%E3%81%84"><code>font-weight: 500</code> は効いたが、副作用が避けられない</a></li>
  <li><a href="#chrome-%E3%81%A7%E6%B8%B8%E3%82%B4%E3%82%B7%E3%83%83%E3%82%AF-medium-%E3%82%92%E4%BD%BF%E3%81%86%E3%81%AE%E3%81%AF%E8%AB%A6%E3%82%81%E3%82%8B">Chrome で游ゴシック Medium を使うのは諦める</a></li>
  <li><a href="#%E5%88%A5%E8%A7%A3--%E6%BD%94%E3%81%8F-regular-%E3%83%95%E3%82%A9%E3%83%B3%E3%83%88%E3%82%92%E4%BD%BF%E3%81%86">別解 : 潔く Regular フォントを使う</a></li>
  <li><a href="#%E3%82%AF%E3%83%A9%E3%82%A4%E3%82%A2%E3%83%B3%E3%83%88%E5%81%B4%E3%81%AE%E8%A8%AD%E5%AE%9A%E5%A4%89%E6%9B%B4%E3%81%A7%E5%A4%AA%E3%82%81%E3%81%AE%E6%B8%B8%E3%82%B4%E3%82%B7%E3%83%83%E3%82%AF%E3%82%92%E5%AE%9F%E7%8F%BE%E3%81%99%E3%82%8B">クライアント側の設定変更で太めの游ゴシックを実現する</a>
    <ul>
      <li><a href="#chrome-%E6%8B%A1%E5%BC%B5%E6%A9%9F%E8%83%BD%E3%81%A7--webkit-text-stroke-width-%E3%82%92%E6%8C%87%E5%AE%9A%E3%81%99%E3%82%8B">Chrome 拡張機能で <code>-webkit-text-stroke-width</code> を指定する</a></li>
      <li><a href="#%E3%83%AC%E3%82%B8%E3%82%B9%E3%83%88%E3%83%AA%E3%82%92%E3%82%A4%E3%82%B8%E3%81%A3%E3%81%A6-regularlight-%E3%82%A6%E3%82%A7%E3%82%A4%E3%83%88%E3%81%AE%E3%83%95%E3%82%A9%E3%83%B3%E3%83%88%E3%82%92-medium-%E3%83%95%E3%82%A9%E3%83%B3%E3%83%88%E3%81%AB%E7%BD%AE%E6%8F%9B%E3%81%99%E3%82%8B">レジストリをイジって Regular・Light ウェイトのフォントを Medium フォントに置換する</a></li>
      <li><a href="#%E3%82%AF%E3%83%A9%E3%82%A4%E3%82%A2%E3%83%B3%E3%83%88%E3%82%B5%E3%82%A4%E3%83%89%E3%81%A7%E3%81%A7%E3%81%8D%E3%82%8B%E3%81%93%E3%81%A8%E3%81%BE%E3%81%A8%E3%82%81">クライアントサイドでできることまとめ</a></li>
    </ul>
  </li>
</ul>
<h2 id="游ゴシックフォントに関する基礎知識のおさらい"><a class="header-link" href="#游ゴシックフォントに関する基礎知識のおさらい"><span class="header-link-mark"></span></a>游ゴシックフォントに関する基礎知識のおさらい</h2>
<p>まずは、ウェブサイトで游ゴシックフォントを使う際の基礎知識をおさらいする。</p>
<ul>
  <li>游ゴシックは、最近の Windows と Mac の両方にプリインストールされているシステムフォント。
    <ul>
      <li>ようやくシステム標準のフォントで OS 間の差異がなくなるか、と期待されていた。</li>
      <li>しかし実際は、なかなか差異を埋められない状況にある。</li>
    </ul>
  </li>
  <li><em>Windows には「Light」「Regular」という細めのフォントが搭載されており、コレが細すぎて見づらい。</em>
    <ul>
      <li>MacOS にも搭載されている「Medium」を Windows でも使いたいのだが、そのための CSS での指定が大変。</li>
    </ul>
  </li>
  <li>Windows と Mac とで、CSS での指定方法が異なる。
    <ul>
      <li>Mac 向けには <code>"游ゴシック体", YuGothic</code> と記述する。このように記述すれば Mac では Medium ウェイトが使用されるので、Mac 向けにはもう調整することはない。問題は Windows の仕様。</li>
      <li>Windows 向けには、<code>"游ゴシック", "Yu Gothic"</code> と記述する。このように記述すると、<strong>Medium よりも細い Regular ウェイトが使用されてしまい、見づらい。</strong>みんなが困っているのはこの問題。</li>
    </ul>
  </li>
  <li>Windows で游ゴシック Medium を使用したいが、ブラウザによって解釈が異なる。
    <ul>
      <li><code>"游ゴシック Medium", "Yu Gothic Medium"</code> と書けば Medium ウェイトが利用できるブラウザもある。</li>
      <li>その他、<code>@font-face</code> を使う方法もあったが、後述するとおり<strong>この手法が最近の Chrome では効かなくなっていた。</strong></li>
    </ul>
  </li>
  <li><code>font-weight: 500;</code> と指定すると、游ゴシック Medium が利用できるが、副作用もある。
    <ul>
      <li><a href="/blog/2016/02/12-01.html">Windows で游ゴシックが細く見えないようにする CSS</a></li>
      <li>游ゴシックフォントを適用せず、「ヒラギノ角ゴ」が適用された場合、<code>font-weight: 500</code> 指定のせいで<em>ヒラギノは太字</em>で表示されてしまう。</li>
      <li>「游ゴシックフォントが適用できた時だけ <code>font-weight: 500</code> を指定し、ヒラギノなど他のフォントが指定された時は <code>font-weight</code> を指定しない」といった処理分けができれば良いが、JavaScript を組み合わせる必要が出てきて大変。</li>
    </ul>
  </li>
</ul>
<p>…というところで、游ゴシックフォントを使うのは主に Windows のせいで大変なのである。</p>
<h2 id="chrome-で効かなくなっていた-font-face"><a class="header-link" href="#chrome-で効かなくなっていた-font-face"><span class="header-link-mark"></span></a>Chrome で効かなくなっていた <code>@font-face</code></h2>
<p>本稿執筆時点の最新版、Chrome 71 で指定していた游ゴシック Medium 指定は、以下のようなもの。</p>
<pre class="language-css"><code class="language-css"><span class="token atrule"><span class="token rule">@font-face</span></span> <span class="token punctuation">{</span>
  <span class="token property">font-family</span><span class="token punctuation">:</span> <span class="token string">"Yu Gothic M"</span><span class="token punctuation">;</span>
  <span class="token property">src</span><span class="token punctuation">:</span> <span class="token function">local</span><span class="token punctuation">(</span><span class="token string">"Yu Gothic Medium"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token atrule"><span class="token rule">@font-face</span></span> <span class="token punctuation">{</span>
  <span class="token property">font-family</span><span class="token punctuation">:</span> <span class="token string">"Yu Gothic M"</span><span class="token punctuation">;</span>
  <span class="token property">src</span><span class="token punctuation">:</span> <span class="token function">local</span><span class="token punctuation">(</span><span class="token string">"Yu Gothic Bold"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">font-weight</span><span class="token punctuation">:</span> bold<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">html</span> <span class="token punctuation">{</span>
  <span class="token property">font-family</span><span class="token punctuation">:</span> <span class="token string">"游ゴシック体"</span><span class="token punctuation">,</span> YuGothic<span class="token punctuation">,</span> <span class="token string">"Yu Gothic M"</span><span class="token punctuation">,</span> <span class="token string">"游ゴシック Medium"</span><span class="token punctuation">,</span> <span class="token string">"Yu Gothic Medium"</span><span class="token punctuation">,</span> sans-seif<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><code>@font-face</code> を使い、<code>Yu Gothic M</code> という独自フォントを定義している。通常の <code>font-weight</code> では「游ゴシック Medium」を、<code>bold</code> な時は「游ゴシック Bold」を使うよう指定したもの。</p>
<p>コレとは別に、<code>@font-face</code> が効かなかった時のことも考えて、<code>"游ゴシック Medium", "Yu Gothic Medium"</code> というウェイトを指定したフォールバックも記述していたのだが、どうもコレも効いていない様子。2018年に検証した以下の記事では効いていたと記録しているのだが、どうも仕様が変わったようだ。</p>
<ul>
  <li><a href="/blog/2017/11/12-01.html">2018年以降はコレで決まり！Web サイトで指定するゴシック体・明朝体・等幅の font-family 設定</a></li>
</ul>
<p><code>local()</code> で指定するフォント名が違うかな？と思い、PostScript 名である「<code>YuGothic-Medium</code>」なども指定してみたが、それも効かなかった。</p>
<p>また、<code>@font-face</code> を使うと、<code>font-weight: bold</code> を指定した時に「游ゴシック Bold」がうまく使われず、<em>游ゴシック Medium を太字にして表示</em>されてしまう。どうやら、Chrome の最近の仕様変更で、ウェイトを指定したフォント全般がうまく扱われなくなってしまったようだ。仕様変更がコロコロ発生してつらい。</p>
<p>そもそも Windows という OS のフォントレンダリングは、ガンマ補正の仕方の問題で文字が薄く見える傾向にあり、同じ游ゴシック Medium を使ったとしても、Mac より Windows の方がかすれて見えるのはこのためらしい。OS の問題もあるというところがつらい。</p>
<p>この辺の話題は以下の記事にもまとまっていた。</p>
<ul>
  <li>参考：<a href="https://wemo.tech/1155">游ゴシックのfont-family指定方法2018年度版！@font-faceは絶対NG！WindowsのChromeでかすれる問題徹底検証 | WEMO</a></li>
</ul>
<p>過去いろいろ検証に使ったデモコードを残しておく。以下はもう更新しない。</p>
<ul>
  <li><a href="https://neos21.github.io/poc-perfect-yu-gothic/testing-03.html">Perfect Yu Gothic - Testing 03</a></li>
  <li><a href="https://neos21.github.io/poc-perfect-yu-gothic/testing-04.html">Perfect Yu Gothic - Testing 04</a></li>
  <li><a href="https://neos21.github.io/poc-perfect-yu-gothic/testing-05.html">Perfect Yu Gothic - Testing 05</a></li>
  <li><a href="https://neos21.github.io/poc-perfect-yu-gothic/testing-06.html">Perfect Yu Gothic - Testing 06</a></li>
  <li><a href="https://neos21.github.io/frontend-sandboxes/font-family-tests/english-japanese-sans-serif-fonts-test.html">English Japanese Sans-Serif Fonts Test</a></li>
  <li><a href="https://neos21.github.io/frontend-sandboxes/font-family-tests/index.html">font-family Tests</a></li>
</ul>
<h2 id="font-weight-500-は効いたが副作用が避けられない"><a class="header-link" href="#font-weight-500-は効いたが副作用が避けられない"><span class="header-link-mark"></span></a><code>font-weight: 500</code> は効いたが、副作用が避けられない</h2>
<p><code>font-weight: normal</code> (= <code>400</code>) ではなく、<code>500</code> を指定すれば、<code>"游ゴシック", "Yu Gothic"</code> の記述でも Medium ウェイトが利用されるテクニックは以前から存在していた。</p>
<p>しかし、前述のとおり、游ゴシックが使われなかった時にヒラギノフォントなどが太字で表示されてしまう問題が避けられず、使いづらいと判断した。</p>
<h2 id="chrome-で游ゴシック-medium-を使うのは諦める"><a class="header-link" href="#chrome-で游ゴシック-medium-を使うのは諦める"><span class="header-link-mark"></span></a>Chrome で游ゴシック Medium を使うのは諦める</h2>
<p>Mac の場合は、もともと Regular や Light ウェイトのフォントがインストールされていないので、<code>"游ゴシック体", YuGothic</code> と記述するだけで、Chrome・Firefox・Safari のいずれでも、特に問題は起こらない。</p>
<p>また、Windows の場合も、前述の <code>@font-face</code> や、<code>"游ゴシック Medium", "Yu Gothic Medium"</code> といった指定で、Firefox・Edge・IE では問題なく太めの游ゴシックで表示されるので、問題ない。</p>
<p><strong>游ゴシックの細さが気になるのは、Windows の Chrome のみ</strong>なのだ。</p>
<p>ということで、<em>Windows Chrome で游ゴシックを使うのを諦める方向で考えてみた。</em></p>
<pre class="language-css"><code class="language-css"><span class="token atrule"><span class="token rule">@font-face</span></span> <span class="token punctuation">{</span>
  <span class="token property">font-family</span><span class="token punctuation">:</span> <span class="token string">"Yu Gothic M"</span><span class="token punctuation">;</span>
  <span class="token property">src</span><span class="token punctuation">:</span> <span class="token function">local</span><span class="token punctuation">(</span><span class="token string">"Yu Gothic Medium"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token atrule"><span class="token rule">@font-face</span></span> <span class="token punctuation">{</span>
  <span class="token property">font-family</span><span class="token punctuation">:</span> <span class="token string">"Yu Gothic M"</span><span class="token punctuation">;</span>
  <span class="token property">src</span><span class="token punctuation">:</span> <span class="token function">local</span><span class="token punctuation">(</span><span class="token string">"Yu Gothic Bold"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">font-weight</span><span class="token punctuation">:</span> bold<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">html</span> <span class="token punctuation">{</span>
  <span class="token property">font-family</span><span class="token punctuation">:</span> YuGothic<span class="token punctuation">,</span>  <span class="token comment">/* For Mac */</span>
               <span class="token string">"Yu Gothic M"</span><span class="token punctuation">,</span> <span class="token string">"Yu Gothic Medium"</span><span class="token punctuation">,</span>  <span class="token comment">/* For Windows Firefox, Edge, IE */</span>
               <span class="token string">"Hiragino Kaku Gothic ProN"</span><span class="token punctuation">,</span> <span class="token string">"Hiragino Kaku Gothic Pro"</span><span class="token punctuation">,</span>  <span class="token comment">/* For Mac Fallback */</span>
               Meiryo<span class="token punctuation">,</span>  <span class="token comment">/* For Windows Fallback (Chrome) */</span>
               sans-serif<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>こんな感じで、</p>
<ol>
  <li>最近の Mac は <code>YuGothic</code> で游ゴシック Medium を利用</li>
  <li>Windows の Chrome 以外は <code>@font-face</code> 指定か <code>"Yu Gothic Medium"</code> で游ゴシック Medium を利用</li>
  <li>主に Mac 向けのフォールバックでヒラギノを指定。Windows にヒラギノがインストールされている場合は、Chrome でヒラギノが使用されることになる</li>
  <li>ヒラギノを入れていない多くの Windows Chrome 向けには、<code>Meiryo</code> でメイリオを利用させる</li>
</ol>
<p>という流れ。</p>
<p>ただ、メイリオは斜体 (イタリック) フォントがないので、<code>i</code> 要素などで斜体が実現されないという問題がある。コレは游ゴシックがインストールされていない Windows7 以前の環境でもそうなので、特に気にしないでも良いかな…。</p>
<h2 id="別解--潔く-regular-フォントを使う"><a class="header-link" href="#別解--潔く-regular-フォントを使う"><span class="header-link-mark"></span></a>別解 : 潔く Regular フォントを使う</h2>
<p>別解として、ウェイト指定を諦めて、Windows 環境では Regular ウェイトを利用させる、ということも考えた。</p>
<pre class="language-css"><code class="language-css"><span class="token selector">html</span> <span class="token punctuation">{</span>
  <span class="token property">font-family</span><span class="token punctuation">:</span> YuGothic<span class="token punctuation">,</span>     <span class="token comment">/* For Mac */</span>
               <span class="token string">"Yu Gothic"</span><span class="token punctuation">,</span>  <span class="token comment">/* For Windows */</span>
               <span class="token string">"Hiragino Kaku Gothic ProN"</span><span class="token punctuation">,</span> <span class="token string">"Hiragino Kaku Gothic Pro"</span><span class="token punctuation">,</span>  <span class="token comment">/* For Mac Fallback */</span>
               Meiryo<span class="token punctuation">,</span>  <span class="token comment">/* For Windows Fallback */</span>
               sans-serif<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>CSS としてはシンプルになる。そもそも問題だと捉えていた「Regular ウェイトが利用される」ことを、許容するのだから。</p>
<p>日本語のサイトでも割とよく見かけるし、Google など <code>sans-serif</code> 指定ぐらいしかされていないようなサイトでは、ブラウザの初期設定で游ゴシック Regular が適用されることもあるから、実はそれなりに見かけているのかな、とも思う。</p>
<p>後述する Chrome 拡張機能を参考に、<strong>フォントを太めに表示する気休めのハック</strong>も考えた。</p>
<pre class="language-css"><code class="language-css"><span class="token comment">/* Chrome でのみフォントを太めに表示する */</span>
<span class="token atrule"><span class="token rule">@media</span> screen <span class="token keyword">and</span> <span class="token punctuation">(</span><span class="token property">-webkit-min-device-pixel-ratio</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token selector">*</span> <span class="token punctuation">{</span>
    <span class="token property">-webkit-text-stroke-width</span><span class="token punctuation">:</span> <span class="token number">.4</span><span class="token unit">px</span> <span class="token important">!important</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<ul>
  <li>参考：<a href="https://hacknote.jp/archives/11050/">Chromeにだけ効くCSSハック | AWS構築ハックノート</a></li>
</ul>
<p>Chrome ブラウザ全般が、Firefox などよりもフォントが細めに表示されていたので、仮に游ゴシック Medium が適用されたとしても <code>text-shadow</code> を利用して少し太めに表示するくらいがちょうど良いかなと思った。</p>
<h2 id="クライアント側の設定変更で太めの游ゴシックを実現する"><a class="header-link" href="#クライアント側の設定変更で太めの游ゴシックを実現する"><span class="header-link-mark"></span></a>クライアント側の設定変更で太めの游ゴシックを実現する</h2>
<p>ウェブサイト配信者が CSS で操作する話はココまで。ココからは、閲覧者側の環境を変更することで、かすれた游ゴシックを駆逐し、太くてクッキリした游ゴシックを得るための方法を紹介する。</p>
<h3 id="chrome-拡張機能で--webkit-text-stroke-width-を指定する"><a class="header-link" href="#chrome-拡張機能で--webkit-text-stroke-width-を指定する"><span class="header-link-mark"></span></a>Chrome 拡張機能で <code>-webkit-text-stroke-width</code> を指定する</h3>
<p>Chrome 拡張機能で、<strong>Font Rendering Enhancer</strong> というモノがあり、コレを入れると文字を太めにレンダリングしてくれるようになった。</p>
<ul>
  <li>参考：<a href="https://chrome.google.com/webstore/detail/font-rendering-enhancer/hmbmmdjlcdediglgfcdkhinjdelkiock?hl=ja">Font Rendering Enhancer - Chrome ウェブストア</a></li>
</ul>
<p>仕組みは単純で、拡張機能が以下のような CSS をブチ込んでいる。</p>
<pre class="language-css"><code class="language-css"><span class="token comment">/* Chrome Font Rendering Enhancer の実装 : 後述する -webkit-text-stroke-width をオススメするので悪例 */</span>
<span class="token selector">*</span> <span class="token punctuation">{</span>
  <span class="token property">text-shadow</span><span class="token punctuation">:</span> <span class="token color">transparent</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token color"><span class="token function">rgba</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.68</span><span class="token punctuation">)</span></span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token important">!important</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>文字を太めに見せるために、<code>text-shadow</code> を使っているのだ。設定部分で、<code>0.68</code> 部分の値を変更でき、ココの数値を上げていけばより濃くレンダリングされるようになる。</p>
<p><strong>ただ、後で調べたところ、文字を太めにする CSS は <code>text-shadow</code> ではなく、<code>-webkit-text-stroke-width</code> の方がよりキレイだと分かった。</strong></p>
<p>自分は最終的に、<em>Stylish 拡張機能</em>で以下のようなユーザスタイルを作ることにした。</p>
<pre class="language-css"><code class="language-css"><span class="token comment">/* 文字を太めにする */</span>
<span class="token selector">*</span> <span class="token punctuation">{</span>
  <span class="token property">-webkit-text-stroke-width</span><span class="token punctuation">:</span> <span class="token number">.4</span><span class="token unit">px</span> <span class="token important">!important</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* リンクの下線が切れる問題を回避する */</span>
<span class="token selector">html</span> <span class="token punctuation">{</span>
  <span class="token property">text-decoration-skip-ink</span><span class="token punctuation">:</span> none <span class="token important">!important</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 自分が好きな等幅フォントを使わせる */</span>
<span class="token selector">input<span class="token punctuation">,</span> button<span class="token punctuation">,</span> select<span class="token punctuation">,</span> textarea<span class="token punctuation">,</span> pre<span class="token punctuation">,</span> code<span class="token punctuation">,</span> kbd<span class="token punctuation">,</span> samp<span class="token punctuation">,</span> var<span class="token punctuation">,</span> tt<span class="token punctuation">,</span>
<span class="token class">.highlight</span><span class="token punctuation">,</span> <span class="token class">.highlight</span> *</span> <span class="token punctuation">{</span>
  <span class="token property">font-family</span><span class="token punctuation">:</span> MeiryoKe_Gothic<span class="token punctuation">,</span> <span class="token string">"Ricty Diminished"</span><span class="token punctuation">,</span> monospace <span class="token important">!important</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<ul>
  <li><a href="/blog/2019/01/27-01.html">Windows・Chrome で游ゴシックフォントを少しだけ太く見せる JavaScript と CSS</a></li>
</ul>
<p>…ココまでしたが、まだちょっと細く感じる。</p>
<h3 id="レジストリをイジって-regularlight-ウェイトのフォントを-medium-フォントに置換する"><a class="header-link" href="#レジストリをイジって-regularlight-ウェイトのフォントを-medium-フォントに置換する"><span class="header-link-mark"></span></a>レジストリをイジって Regular・Light ウェイトのフォントを Medium フォントに置換する</h3>
<p>次は、游ゴシック Regular と游ゴシック Light の2つのフォントを削除してしまえば、游ゴシック Medium が利用されるようになるのではないか、と考えたのだが、フォントをアンインストールしてしまうと不具合が多そうなので、別の方法を取ることにした。</p>
<ul>
  <li>参考：<a href="https://takachan.hatenablog.com/entry/2017/02/22/083000">Windows10でフォントが汚いのでYuGothicを削除する (不完全版) - PG日誌</a></li>
</ul>
<p>やったことは以下のとおり。</p>
<ol>
  <li>エクスプローラで <code>C:\Windows\Fonts\</code> ディレクトリに移動し、「游ゴシック 中」フォントを選択してコピーする。<br>
    <img src="05-02-05.png" alt="「游ゴシック 中」フォントをコピーする">
  </li>
  <li>エクスプローラで別ディレクトリを表示し、貼り付ける。すると、「<code>YuGothM.ttc</code>」というファイルが貼り付けられる。</li>
  <li>このファイルを2回コピペし、<code>YuGothM2.ttc</code>・<code>YuGothM3.ttc</code> というファイルを用意する。いずれも中身は <code>YuGothM.ttc</code> と同じだ。<br>
    <img src="05-02-04.png" alt="コピー・リネームする">
  </li>
  <li>再度エクスプローラで <code>C:\Windows\Fonts\</code> ディレクトリに移動し、游ゴシックのバリエーションが表示されているところで、<code>YuGothM2.ttc</code>・<code>YuGothM3.ttc</code> をコピー &#x26; ペーストして貼り付ける。
    <ul>
      <li>「既にインストールされています」などと表示されるが、構わずペーストする。<br>
        <img src="05-02-03.png" alt="上書きする">
      </li>
      <li>エクスプローラでの見た目上は変わらないが、コマンドプロンプトで <code>dir</code> コマンドなどを叩いて確認すると、ちゃんとこれらのファイルが配置されていることが分かる。<br>
        <img src="05-02-02.png" alt="ファイルがある">
      </li>
    </ul>
  </li>
  <li>レジストリエディタ <code>regedit</code> を開き、「<code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Fonts</code>」に移動する。<br>
    <img src="05-02-01.png" alt="赤枠部分が変更対象">
  </li>
  <li>「<code>Yu Gothic Regular &#x26; Yu Gothic UI Semilight (TrueType)</code>」というキーを見付けたら、値が「<code>YuGothR.ttc</code>」になっていると思うので、コレを「<code>YuGothM2.ttc</code>」に変更する。</li>
  <li>同様に、「<code>Yu Gothic Light &#x26; Yu Gothic UI Light (TrueType)</code>」というキーを見付けたら、値が「<code>YuGothL.ttc</code>」になっていると思うので、コレを「<code>YuGothM3.ttc</code>」に変更する。<br>
    <img src="05-02-07.png" alt="このように書き換える">
  </li>
  <li>一度ログオフし、再度ログインして設定を反映させる。</li>
</ol>
<p>何をしているのかというと、「フォント名」と「フォントファイル」の紐付けを行っているレジストリを書き換えて、Regular・Light が指定された時も Medium ウェイトのフォントファイルが参照されるように変更したのだ。元のフォントファイルは見えなくなるが、<code>C:\Windows\Fonts\</code> 配下には残っているので、必要な場合は元に戻せる。一応 Medium ウェイトのフォントファイルのコピーを用意することにしたが、もしかしたら同じフォントファイル名 <code>YuGothM.ttc</code> を指定しても問題ないかも？怖いので未検証。</p>
<p>コレでどのくらい変わるのかというと、以下のとおり。<code>font-weight</code> を、上から</p>
<ul>
  <li><code>bold</code> (= <code>700</code>)</li>
  <li><code>500</code></li>
  <li><code>normal</code> (= <code>400</code>)</li>
</ul>
<p>と指定している。</p>
<p>左がレジストリ変更前、右がレジストリ変更後。</p>
<p>
  <img src="05-02-06.png" alt="レジストリ変更後は一番下の行が少し太く出る">
</p>
<p>レジストリ変更後の3行目、<code>font-weight: normal</code> 時の文字が、レジストリ変更前と比べて少し太く表示されていることが分かるだろう。</p>
<p>2019-06-29 追記 : このレジストリ変更を自動で行う VBScript を作成したので、以下を参照してほしい。</p>
<ul>
  <li><a href="/blog/2019/02/24-01.html">Windows の游ゴシック Regular・Light を Medium フォントに差し替えて太く見せる VBScript</a></li>
</ul>
<h3 id="クライアントサイドでできることまとめ"><a class="header-link" href="#クライアントサイドでできることまとめ"><span class="header-link-mark"></span></a>クライアントサイドでできることまとめ</h3>
<p>というワケで、自分はクライアント OS から「游ゴシック Regular」「游ゴシック Light」を消し去り、「游ゴシック Medium」のみが存在する状態にした上で、「Font Rendering Enhauncer」拡張機能で <code>text-shadow</code> を適用し、文字をより太く表示させるように変更した。</p>
<p>コレでかなり自分が望んだ環境になった。</p>
<p>他の人の Windows PC では未だ細い游ゴシックで表示されると思うが、元々 Chrome 以外では細さがそんなに気にならないし、Chrome ブラウザのコロコロ変わる仕様変更にも付き合っていられないので、コレでいいだろう。</p>
<p>その他参考にした記事は以下。</p>
<ul>
  <li>参考：<a href="https://coderwall.com/p/9tecwq/fix-poor-font-rendering-in-chrome-on-windows">Fix poor font-rendering in Chrome on Windows (Example)</a>
    <ul>
      <li><code>chrome://flags</code> より、「Accelerated 2D Canvas」を無効にすると良いとか。あまり効果を感じなかった。</li>
    </ul>
  </li>
</ul>

      </main>
      <footer id="footer">
        <div id="footer-contents">
          <div id="date-time">
            <dl>
              <dt>Created</dt>
              <dd><time>2019-01-05</time></dd>
              <dt>Last-Modified</dt>
              <dd><time>2019-01-05</time></dd>
            </dl>
          </div>
          <nav id="footer-links">
            <ul>
              <li id="footer-link-about"><a href="/about/index.html" title="About">About</a></li>
              <li id="footer-link-search"><a href="/about/search.html" title="Search">Search</a></li>
              <li id="footer-link-feeds"><a href="/feeds.xml" title="Feeds">Feeds</a></li>
              <li id="footer-link-github"><a href="https://github.com/Neos21/" title="GitHub">GitHub</a></li>
            </ul>
          </nav>
          <nav id="to-top"><a href="#" title="To Top"><span>▲ To Top</span></a></nav>
        </div>
      </footer>
    </div>
  </body>
</html>
