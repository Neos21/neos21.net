<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="theme-color" content="#0990d0">
    <!-- Google Search Console -->
    <meta name="google-site-verification" content="AvoEr3mUJFF2H_mPWWgShfmjBVP3ywRpyx9hxeeq2d4">
    <title>Parsec で超低遅延なリモートデスクトップができた - Neo's World</title>
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="/styles.css">
    <link rel="canonical" href="https://neos21.net/blog/2022/07/07-01.html">
    <link rel="search" type="application/opensearchdescription+xml" title="neos21.net" href="/opensearch.xml">
    <link rel="alternate" type="application/atom+xml" href="/feeds.xml">
    <link rel="author" href="http://www.hatena.ne.jp/neos21/">
    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YMHFLZP1M1"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date());gtag('config','G-YMHFLZP1M1');gtag('config','UA-106501-1');</script>
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6475907504235292" crossorigin="anonymous"></script>
  </head>
  <body>
    <div id="container">
      <header id="header">
        <div id="header-brand">
          <div id="header-brand-contents">
            <div id="site-title"><a href="/index.html">Neo's World</a></div>
            <nav id="header-links">
              <ul>
                <li id="header-link-about"><a href="/about/index.html" title="About"><span>About</span></a></li>
                <li id="header-link-search"><a href="/about/search.html" title="Search"><span>Search</span></a></li>
                <li id="header-link-feeds"><a href="/feeds.xml" title="Feeds"><span>Feeds</span></a></li>
                <li id="header-link-to-bottom"><a href="#footer" title="To Bottom"><span>▼ To Bottom</span></a></li>
              </ul>
            </nav>
          </div>
        </div>
        <nav id="global-nav">
          <ul>
            <li><a href="/blog/index.html">Blog</a></li>
            <li><a href="/tech/index.html">Tech</a></li>
            <li><a href="/music/index.html">Music</a></li>
            <li><a href="/games/index.html">Games</a></li>
            <li><a href="/gallery/index.html">Gallery</a></li>
            <li><a href="/etc/index.html">Etc.</a></li>
          </ul>
        </nav>
        <nav id="path">
          <ul>
            <li><a href="/index.html">Neo's World</a></li>
            <li><a href="/blog/index.html">Blog</a></li>
            <li><a href="/blog/2022/index.html">2022年</a></li>
            <li><a href="/blog/2022/07/index.html">07月</a></li>
          </ul>
        </nav>
      </header>
      <main id="main">
        <div id="header-date"><time>2022-07-07</time></div>
        <h1 id="page-title">Parsec で超低遅延なリモートデスクトップができた</h1>

<p>今まで自分は Chrome リモートデスクトップを主に使ってきたのだが、コイツは画質があまり良くなく、遅延もそこそこある。他に Windows リモートデスクトップ接続、RealVNC、TeamViewer なども使っているが、いずれもそこまでレスポンスが良くはなかった。</p>
<p>そこで、かねてより気になっていた <strong>Parsec</strong> というリモートデスクトップサービスを使ってみた。</p>
<ul>
  <li><a href="https://parsec.app/">Connect to Work or Games from Anywhere | Parsec</a></li>
</ul>
<h2 id="検証環境"><a class="header-link" href="#検証環境"><span class="header-link-mark"></span></a>検証環境</h2>
<p>検証に利用した機材や環境は次のとおり。</p>
<ul>
  <li>母艦・Galleria XG : Windows 10、有線 LAN 接続。コレだけデスクトップ PC</li>
  <li>Asus ZenBook 3 UX390UA-512GP : Windows 11、無線 LAN 接続</li>
  <li>Apple MacBook 12Inch 2017 : macOS Monterey 12、無線 LAN 接続</li>
  <li>Lenovo IdeaPad Duet ChromeBook ZA6F0031US : ChromeOS、無線 LAN 接続。 MediaTek Helio P60T という ARM CPU を搭載</li>
</ul>
<p>いずれも同一 LAN 内で検証。外出先などからの検証はしておらず。</p>
<h2 id="各マシンにアプリをインストールする"><a class="header-link" href="#各マシンにアプリをインストールする"><span class="header-link-mark"></span></a>各マシンにアプリをインストールする</h2>
<ul>
  <li><a href="https://parsec.app/downloads">Download Parsec | Parsec</a></li>
</ul>
<p>上の公式ページより Parsec のアプリをインストールする。コレはホストマシン (外部から接続される側) になる場合は必須。クライアント (他のマシンに接続しに行く側) になる際も、<strong>ネイティブアプリの方が後述する Web 版よりパフォーマンスが格段に良い</strong>ので、基本的にはインストール必須と考えて良いだろう。</p>
<p>Windows 版、MacOS 版の他に、Linux や Android などにも対応しているようだが、Linux 版は ARM ベースの CPU 搭載マシンである IdeaPad Duet にはインストールできなかった。というワケで他マシンから IdeaPad への接続は不可能で、IdeaPad から他マシンへの接続は Web 版からの検証とする。</p>
<p>Parsec を使う際はアカウント登録が必要になる。メールアドレスとパスワード、あと任意で二段階認証設定ができる。メールアドレスの認証を済ませて、ネイティブアプリを起動したらログインすれば、同じアカウントでログインしている他の端末が見えるようになる。</p>
<p>エンコーディング設定や帯域設定なども色々あるのだが、後述するように接続エラー等があったので、基本的にはデフォルト設定からイジらない方が良さそうだ。帯域幅だけはデフォルトの 10Mbps から 15Mbps に変えてみたが、どのくらい差が出るものなのだろうか。</p>
<h2 id="ノート-pc-から母艦デスクトップへ接続してみる"><a class="header-link" href="#ノート-pc-から母艦デスクトップへ接続してみる"><span class="header-link-mark"></span></a>ノート PC から母艦デスクトップへ接続してみる</h2>
<p>想定する主な使い方は、ノート PC から母艦のデスクトップ PC へ接続して、デスクトップ PC を操作する使い方。双方のマシンでネイティブアプリを立ち上げて接続した。</p>
<p>結論からいうと、<strong>超低遅延で、超絶サクサクに動作する。</strong>デスクトップ PC 側で YouTube 動画なんかを再生しても、ほぼ遅延なく、映像・音声ともにクライアント側に届く。クリック操作などの遅延も体感できるような遅延が全くなく、特に同じ Windows OS である ZenBook → Galleria 間の接続時はキー配列や操作感なんかもも全く同じなので、普通に実機を操作しているかのような感覚だった。</p>
<ul>
  <li>ZenBook → Galleria : サクサク</li>
  <li>MacBook → Galleria : サクサク</li>
</ul>
<h2 id="クライアント側はネイティブアプリでも接続できるがパフォーマンスが極端に落ちて使えない"><a class="header-link" href="#クライアント側はネイティブアプリでも接続できるがパフォーマンスが極端に落ちて使えない"><span class="header-link-mark"></span></a>クライアント側はネイティブアプリでも接続できるが、パフォーマンスが極端に落ちて使えない</h2>
<p>先程も少し触れたが、クライアント側のマシンにはネイティブアプリをインストールせずとも、以下の <code>web.parsec.app</code> にブラウザからログインすることで、クライアント側として操作できる。この辺は Chrome リモートデスクトップとか TeamViewer なんかも同様だ。今回はどのマシンでもクライアント側は Chrome ブラウザを使ってみた。</p>
<ul>
  <li><a href="https://web.parsec.app/">Parsec Web</a></li>
</ul>
<p>クライアント側のネイティブアプリを起動してある状態だと、Parsec Web で接続開始してもネイティブアプリが実際の通信を確立するので、前述のようにネイティブアプリ同士で接続するのと同じ状態になる。</p>
<p>しかし、クライアント側でネイティブアプリを起動していないと、ブラウザからホストマシンのネイティブアプリへと接続しに行くようになり、パフォーマンスが極端に落ちる。Chrome リモートデスクトップよりもガクガクで、ネットワーク影響をメチャクチャ受けるので、<em>あまり常用には足らない。</em></p>
<ul>
  <li>ZenBook (ブラウザ) → Galleria : 動かなくはないがガクガク</li>
  <li>MacBook (ブラウザ) → Galleria : 動かなくはないがガクガク</li>
  <li>ChromeBook (ブラウザ) → Galleria : 殆ど使い物にならないくらいガックガク</li>
</ul>
<p>特に ChromeBook はそもそものマシンスペックが低いせいもあって、全く画面が動かない感じだった。</p>
<h2 id="デスクトップ-pc-からノート-pc-へ接続しにいく"><a class="header-link" href="#デスクトップ-pc-からノート-pc-へ接続しにいく"><span class="header-link-mark"></span></a>デスクトップ PC からノート PC へ接続しにいく</h2>
<p>以降は Parsec の真価を検証する目的で、色んな方向で接続して動作確認してみた。まずはデスクトップ PC から、各ノート PC へと接続してみた。前述のとおり ChromeBook にはネイティブアプリをインストール出来ないので、以降の検証に ChromeBook は登場せず。</p>
<ul>
  <li>Galleria → ZenBook : サクサク動作する</li>
  <li>Galleria → MacBook : 一応動作した (詳細後述)</li>
</ul>
<p>Win10 の Galleria → Win11 の ZenBook の通信は、同じ Windows OS ということもあるのか、問題なくサクサクと動作してくれた。Galleria 側のディスプレイを 4K、ZenBook 側は FHD だったので、若干画質が悪く見えたものの、レスポンスはかなり良かった。</p>
<p><em>MacOS 版のネイティブアプリは、ホストマシンとしての機能が現状 Beta Preview 状態である。</em>一応接続はできたのだが、設定が悪いと接続エラーになるし、動作があまり安定していない印象を受けた。</p>
<ul>
  <li>Galleria・MacBook 両方のネイティブアプリで、「H.265 (HEVC)」設定を On にしていたところ、Mac への接続時に次のような <code>-15000</code> エラーが出て接続できなかった。</li>
  <li>
    <blockquote>
      <p>The computer you are attempting connect to does not support hardware video encoding [-15000]<br>The host computer may have unsupported hardware or its drivers need an update, check our article for more information.</p>
    </blockquote>
  </li>
  <li>双方のアプリ設定で<em>「H.265 (HEVC)」を Off (デフォルト状態) にしたら</em>無事 Mac へと接続できるようになった</li>
</ul>
<p>続いて、クライアント側となる Galleria のネイティブアプリを閉じ、ブラウザからノート PC へ接続してみた。</p>
<ul>
  <li>Galleria (ブラウザ) → ZenBook : 画質はちょっと悪くなるが、動画も比較的滑らかに届いた</li>
  <li>Galleria (ブラウザ) → MacBook : <code>-6200</code> エラーで繋がらず
    <ul>
      <li>
        <blockquote>
          <p>The network connection between you and the other computer failed with webRTC [-6200]<br>Please install Parsec on your client which is more likely to work.</p>
        </blockquote>
      </li>
    </ul>
  </li>
</ul>
<p><strong>ブラウザ → MacOS の接続が上手く行かなかった。</strong>やはり Mac のホスト機能はベータ状態ということなのだろう。</p>
<h2 id="ノート-pc-同士で接続する"><a class="header-link" href="#ノート-pc-同士で接続する"><span class="header-link-mark"></span></a>ノート PC 同士で接続する</h2>
<p>さらに、検証に使用しているノート PC 同士での接続も試してみる。コレまでは母艦の Galleria が有線 LAN 接続であったのに対し、ノート PC 達はいずれも無線 LAN 接続なので、その点がパフォーマンスにどう影響するか試してみたかった。NVIDIA GTX1080 を搭載しているデスクトップ機と違って、いずれも内蔵 GPU しか持たないノート PC なので、マシンスペックもどのように影響するのだろうか。</p>
<ul>
  <li>ZenBook → MacBook : サクサク動く</li>
  <li>MacBook → ZenBook : サクサク動く</li>
</ul>
<p>…ということで、<em>無線 LAN 端末同士でもサクサク動いた。</em>さすがにデスクトップ PC との接続時のような機敏さはそこまでなかったものの、Chrome リモートデスクトップよりはマシかな？という感じ。</p>
<p>続いて、クライアント側のネイティブアプリを閉じて、ブラウザから接続してみた。</p>
<ul>
  <li>ZenBook (ブラウザ) → MacBook : 前述の <code>-6200</code> エラーで繋がらず</li>
  <li>MacBook (ブラウザ) → ZenBook : 動画も比較的サクサク見られるが、カーソルが消えて操作できなくなる</li>
</ul>
<p>Mac がホストとなる場合は、やはり上手く接続できず。また、Mac の Chrome ブラウザから Win11 マシンへと接続した時に、マウスカーソルが消えてしまい、操作ができなくなる問題が発生した。ホスト側で直接操作して「Kick All」(接続してきているクライアントを全て締め出す操作) をしてやらないと復旧できなかった。</p>
<h2 id="まとめ"><a class="header-link" href="#まとめ"><span class="header-link-mark"></span></a>まとめ</h2>
<p>ということで、Chrome リモートデスクトップなんかと比べると、Parsec ネイティブアプリを使った接続時は動画再生なんかも低遅延で、画質低下もあまりなく接続ができた。一番やりたかった、母艦への接続はホントに低遅延で実現できて素晴らしかった。</p>
<ul>
  <li>Windows マシン同士の接続は特に安定感があって良い</li>
  <li>Mac 版はホスト機能がベータ、クライアント機能も不具合がちょくちょくありイマイチか</li>
  <li>クライアント側がネイティブアプリを使わずブラウザから接続する場合は、全くパフォーマンスが出ないので推奨できない。<em>ネイティブアプリのインストールは必須</em></li>
</ul>
<p>こんな感じ。元々がゲームを低遅延でやりたい人向けのサービスなので、ホスト・クライアントともに Windows 版の対応が一番安定している。Windows マシン同士で接続するのを前提とした方が良さそうかな。</p>
<p>Mac 版の対応はまだまだだし、iOS 版も存在しないので、「とりあえず色んなマシン間で接続したい」場合は Chrome リモートデスクトップがやっぱり気楽なんだなぁ。上手く Win マシン同士を使える場合は、Parsec による恩恵を受けるのが良いだろう。</p><div class="ad-amazon">
  <div class="ad-amazon-image">
    <a href="https://www.amazon.co.jp/dp/B096Z3GVVV?tag=neos21-22&amp;linkCode=osi&amp;th=1&amp;psc=1">
      <img src="https://m.media-amazon.com/images/I/41e79Vqn1kS._SL160_.jpg" width="100" height="160">
    </a>
  </div>
  <div class="ad-amazon-info">
    <div class="ad-amazon-title">
      <a href="https://www.amazon.co.jp/dp/B096Z3GVVV?tag=neos21-22&amp;linkCode=osi&amp;th=1&amp;psc=1">ロジカルにわかる　ゲーム実況の教科書: 精神論ではなく、YouTubeでのゲーム実況を理論的に伸ばす講座 (おねんね書房)</a>
    </div>
  </div>
</div>
<div class="ad-rakuten">
  <div class="ad-rakuten-image">
    <a href="https://hb.afl.rakuten.co.jp/hgc/g00q0722.waxyc9ff.g00q0722.waxyd017/?pc=https%3A%2F%2Fitem.rakuten.co.jp%2Fbook%2F16007736%2F&amp;m=http%3A%2F%2Fm.rakuten.co.jp%2Fbook%2Fi%2F19728294%2F">
      <img src="https://thumbnail.image.rakuten.co.jp/@0_mall/book/cabinet/6507/9784822286507.jpg?_ex=128x128">
    </a>
  </div>
  <div class="ad-rakuten-info">
    <div class="ad-rakuten-title">
      <a href="https://hb.afl.rakuten.co.jp/hgc/g00q0722.waxyc9ff.g00q0722.waxyd017/?pc=https%3A%2F%2Fitem.rakuten.co.jp%2Fbook%2F16007736%2F&amp;m=http%3A%2F%2Fm.rakuten.co.jp%2Fbook%2Fi%2F19728294%2F">ひと目でわかるVDI＆リモートデスクトップサービス　Windows Server 2019版 [ Yokota Lab.、 Inc. ]</a>
    </div>
    <div class="ad-rakuten-shop">
      <a href="https://hb.afl.rakuten.co.jp/hgc/g00q0722.waxyc9ff.g00q0722.waxyd017/?pc=https%3A%2F%2Fwww.rakuten.co.jp%2Fbook%2F&amp;m=http%3A%2F%2Fm.rakuten.co.jp%2Fbook%2F">楽天ブックス</a>
    </div>
    <div class="ad-rakuten-price">価格 : 3300円</div>
  </div>
</div>

      </main>
      <footer id="footer">
        <div id="footer-contents">
          <div id="date-time">
            <dl>
              <dt>Created</dt>
              <dd><time>2022-07-07</time></dd>
              <dt>Last-Modified</dt>
              <dd><time>2022-07-07</time></dd>
            </dl>
          </div>
          <nav id="footer-links">
            <ul>
              <li id="footer-link-about"><a href="/about/index.html" title="About">About</a></li>
              <li id="footer-link-search"><a href="/about/search.html" title="Search">Search</a></li>
              <li id="footer-link-feeds"><a href="/feeds.xml" title="Feeds">Feeds</a></li>
              <li id="footer-link-github"><a href="https://github.com/Neos21/" title="GitHub">GitHub</a></li>
            </ul>
          </nav>
          <nav id="to-top"><a href="#" title="To Top"><span>▲ To Top</span></a></nav>
        </div>
      </footer>
    </div>
  </body>
</html>
