<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="theme-color" content="#0990d0">
    <!-- Google Search Console -->
    <meta name="google-site-verification" content="AvoEr3mUJFF2H_mPWWgShfmjBVP3ywRpyx9hxeeq2d4">
    <title>HDD・SSD 換装時に問題が発生したので EFI ブートローダを再インストールした - Neo's World</title>
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="/styles.css">
    <link rel="canonical" href="https://neos21.net/blog/2022/07/01-01.html">
    <link rel="search" type="application/opensearchdescription+xml" title="neos21.net" href="/opensearch.xml">
    <link rel="alternate" type="application/atom+xml" href="/feeds.xml">
    <link rel="author" href="http://www.hatena.ne.jp/neos21/">
    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YMHFLZP1M1"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date());gtag('config','G-YMHFLZP1M1');gtag('config','UA-106501-1');</script>
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6475907504235292" crossorigin="anonymous"></script>
  </head>
  <body>
    <div id="container">
      <header id="header">
        <div id="header-brand">
          <div id="header-brand-contents">
            <div id="site-title"><a href="/index.html">Neo's World</a></div>
            <nav id="header-links">
              <ul>
                <li id="header-link-about"><a href="/about/index.html" title="About"><span>About</span></a></li>
                <li id="header-link-search"><a href="/about/search.html" title="Search"><span>Search</span></a></li>
                <li id="header-link-feeds"><a href="/feeds.xml" title="Feeds"><span>Feeds</span></a></li>
                <li id="header-link-to-bottom"><a href="#footer" title="To Bottom"><span>▼ To Bottom</span></a></li>
              </ul>
            </nav>
          </div>
        </div>
        <nav id="global-nav">
          <ul>
            <li><a href="/blog/index.html">Blog</a></li>
            <li><a href="/tech/index.html">Tech</a></li>
            <li><a href="/music/index.html">Music</a></li>
            <li><a href="/games/index.html">Games</a></li>
            <li><a href="/gallery/index.html">Gallery</a></li>
            <li><a href="/etc/index.html">Etc.</a></li>
          </ul>
        </nav>
        <nav id="path">
          <ul>
            <li><a href="/index.html">Neo's World</a></li>
            <li><a href="/blog/index.html">Blog</a></li>
            <li><a href="/blog/2022/index.html">2022年</a></li>
            <li><a href="/blog/2022/07/index.html">07月</a></li>
          </ul>
        </nav>
      </header>
      <main id="main">
        <div id="header-date"><time>2022-07-01</time></div>
        <h1 id="page-title">HDD・SSD 換装時に問題が発生したので EFI ブートローダを再インストールした</h1>

<p>2年ぶりに母艦の内蔵 HDD と SSD を変更したところ、トラブルに遭遇。</p>
<h2 id="目次"><a class="header-link" href="#目次"><span class="header-link-mark"></span></a>目次</h2>
<ul>
  <li><a href="#%E3%81%84%E3%81%8D%E3%81%95%E3%81%A4">いきさつ</a></li>
  <li><a href="#%E8%B3%BC%E5%85%A5%E3%81%97%E3%81%9F-ssd-%E3%81%A8-hdd">購入した SSD と HDD</a></li>
  <li><a href="#%E6%8F%9B%E8%A3%85">換装</a></li>
  <li><a href="#bios-%E7%94%BB%E9%9D%A2%E3%81%8B%E3%82%89%E5%85%88%E3%81%AB%E9%80%B2%E3%81%BE%E3%81%AA%E3%81%84">BIOS 画面から先に進まない</a></li>
  <li><a href="#%E5%BC%B7%E5%BC%95%E3%81%AB%E3%83%9B%E3%83%83%E3%83%88%E3%82%B9%E3%83%AF%E3%83%83%E3%83%97%E3%81%A7%E5%8B%95%E3%81%8B%E3%81%97%E3%81%A6%E3%81%84%E3%81%9F%E3%82%89%E6%B0%97%E4%BB%98%E3%81%84%E3%81%9F">強引にホットスワップで動かしていたら気付いた…</a></li>
  <li><a href="#efi-%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%E3%83%91%E3%83%BC%E3%83%86%E3%82%A3%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AE%E4%BD%9C%E6%88%90%E3%81%AB%E9%96%A2%E3%81%97%E3%81%A6%E5%8F%82%E8%80%83%E3%81%AB%E3%81%AA%E3%81%A3%E3%81%9F%E3%82%B5%E3%82%A4%E3%83%88">EFI システムパーティションの作成に関して参考になったサイト</a></li>
  <li><a href="#%E3%83%9C%E3%83%AA%E3%83%A5%E3%83%BC%E3%83%A0%E3%81%AE%E7%B8%AE%E5%B0%8F">ボリュームの縮小</a></li>
  <li><a href="#diskpart-%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%81%A7-efi-%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%E3%83%91%E3%83%BC%E3%83%86%E3%82%A3%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B"><code>diskpart</code> コマンドで EFI システムパーティションを作成する</a></li>
  <li><a href="#%E5%8B%95%E4%BD%9C%E7%A2%BA%E8%AA%8D%E3%81%99%E3%82%8B">動作確認する</a></li>
  <li><a href="#esp%E3%83%9C%E3%83%AA%E3%83%A5%E3%83%BC%E3%83%A0%E3%81%AE%E3%83%89%E3%83%A9%E3%82%A4%E3%83%96%E3%83%AC%E3%82%BF%E3%83%BC%E3%82%92%E5%89%8A%E9%99%A4%E3%81%99%E3%82%8B">「ESP」ボリュームのドライブレターを削除する</a></li>
  <li><a href="#hdd-%E5%81%B4%E3%81%AE-efi-%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%E3%83%91%E3%83%BC%E3%83%86%E3%82%A3%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AA%E3%81%A9%E3%82%92%E5%89%8A%E9%99%A4%E3%81%99%E3%82%8B">HDD 側の EFI システムパーティションなどを削除する</a></li>
  <li><a href="#%E8%AC%8E%E3%81%AB%E8%8B%A6%E5%8A%B4%E3%81%97%E3%81%9F%E3%81%91%E3%81%A9%E3%81%AA%E3%82%93%E3%81%A8%E3%81%8B%E3%81%AA%E3%81%A3%E3%81%9F">謎に苦労したけどなんとかなった</a></li>
</ul>
<h2 id="いきさつ"><a class="header-link" href="#いきさつ"><span class="header-link-mark"></span></a>いきさつ</h2>
<p>2020年に、母艦のデスクトップ PC、Galleria XG に HDD と SSD を増設していた。</p>
<ul>
  <li>
    <p>過去記事：<a href="/blog/2020/06/07-03.html">デスクトップ PC に内蔵 HDD と内蔵 SSD を増設したので手順を解説する</a></p>
    <p>3.5インチベイが5段ある PC ケースなのだが、現状は筐体の上から下 (底面) に向かって、次のような並び順にしていた。</p>
  </li>
  <li>
    <p><em>3TB HDD</em></p>
  </li>
  <li>
    <p>500GB SSD</p>
  </li>
  <li>
    <p><strong>2TB HDD</strong></p>
  </li>
  <li>
    <p>500GB SSD (システムドライブ)</p>
  </li>
  <li>
    <p>4TB HDD</p>
  </li>
</ul>
<p>用途別に 2・3・4TB の HDD をデータ用にし、高速にデータ転送をしたい時のために2つ目の SSD を積んでいる、という感じだった。</p>
<p>だが、SSD が 500GB × 2台だと動画編集などですぐにいっぱいになってしまうため、今回思い切って HDD と SSD の構成を変えることにした。</p>
<h2 id="購入した-ssd-と-hdd"><a class="header-link" href="#購入した-ssd-と-hdd"><span class="header-link-mark"></span></a>購入した SSD と HDD</h2>
<p>秋葉原に行って安い店を色々探したのだが、結局はソフマップが最安値だったｗ。購入したのは以下の2つ。</p>
<ul>
  <li>Western Digital WD Blue WD80EAZZ : 8TB HDD (3.5インチ) … 13,880円</li>
  <li>Crucial CT1000MX500 : 1TB SSD (2.5インチ) … 11,800円</li>
</ul>
<p>
  <img src="./01-01-01.jpg" alt="購入した HDD と SSD">
</p><div class="ad-amazon">
  <div class="ad-amazon-image">
    <a href="https://www.amazon.co.jp/dp/B09LH9XLB9?tag=neos21-22&amp;linkCode=osi&amp;th=1&amp;psc=1">
      <img src="https://m.media-amazon.com/images/I/41rKei+lW1L._SL160_.jpg" width="160" height="160">
    </a>
  </div>
  <div class="ad-amazon-info">
    <div class="ad-amazon-title">
      <a href="https://www.amazon.co.jp/dp/B09LH9XLB9?tag=neos21-22&amp;linkCode=osi&amp;th=1&amp;psc=1">Western Digital ウエスタンデジタル 内蔵 HDD 8TB WD Blue PC 3.5インチ(CMR) WD80EAZZ-EC 【国内正規代理店品】</a>
    </div>
  </div>
</div>
<div class="ad-rakuten">
  <div class="ad-rakuten-image">
    <a href="https://hb.afl.rakuten.co.jp/hgc/g00pajc2.waxycfed.g00pajc2.waxyd33d/?pc=https%3A%2F%2Fitem.rakuten.co.jp%2Fpcdepot%2F0718037894157%2F&amp;m=http%3A%2F%2Fm.rakuten.co.jp%2Fpcdepot%2Fi%2F10063106%2F">
      <img src="https://thumbnail.image.rakuten.co.jp/@0_mall/pcdepot/cabinet/0718037894157_10204.jpg?_ex=128x128">
    </a>
  </div>
  <div class="ad-rakuten-info">
    <div class="ad-rakuten-title">
      <a href="https://hb.afl.rakuten.co.jp/hgc/g00pajc2.waxycfed.g00pajc2.waxyd33d/?pc=https%3A%2F%2Fitem.rakuten.co.jp%2Fpcdepot%2F0718037894157%2F&amp;m=http%3A%2F%2Fm.rakuten.co.jp%2Fpcdepot%2Fi%2F10063106%2F">内蔵HDD WD80EAZZ [3.5インチ] WD80EAZZ＜メーカー2年保証＞</a>
    </div>
    <div class="ad-rakuten-shop">
      <a href="https://hb.afl.rakuten.co.jp/hgc/g00pajc2.waxycfed.g00pajc2.waxyd33d/?pc=https%3A%2F%2Fwww.rakuten.co.jp%2Fpcdepot%2F&amp;m=http%3A%2F%2Fm.rakuten.co.jp%2Fpcdepot%2F">PC DEPOT</a>
    </div>
    <div class="ad-rakuten-price">価格 : 14150円</div>
  </div>
</div>
<p>HDD は個人的に安定の WD Blue。3・4TB HDD と2つの SSD はいずれも WD Blue である。今回は大容量の 8TB を購入した。Seagate BarraCuda もほぼ同じか若干安いぐらいのラインナップだったが、自分の中で実績のあるメーカで選んだ。</p><div class="ad-amazon">
  <div class="ad-amazon-image">
    <a href="https://www.amazon.co.jp/dp/B077PSMJZS?tag=neos21-22&amp;linkCode=osi&amp;th=1&amp;psc=1">
      <img src="https://m.media-amazon.com/images/I/416XTotG9aL._SL160_.jpg" width="160" height="111">
    </a>
  </div>
  <div class="ad-amazon-info">
    <div class="ad-amazon-title">
      <a href="https://www.amazon.co.jp/dp/B077PSMJZS?tag=neos21-22&amp;linkCode=osi&amp;th=1&amp;psc=1">Crucial SSD 1000GB MX500 内蔵2.5インチ 7mm MX500 (9.5mmスペーサー付属) 5年保証 【PlayStation4 動作確認済】 正規代理店保証品 CT1000MX500SSD1/JP</a>
    </div>
  </div>
</div>
<div class="ad-rakuten">
  <div class="ad-rakuten-image">
    <a href="https://hb.afl.rakuten.co.jp/hgc/g00pajc2.waxycfed.g00pajc2.waxyd33d/?pc=https%3A%2F%2Fitem.rakuten.co.jp%2Fpcdepot%2F4988755041249%2F&amp;m=http%3A%2F%2Fm.rakuten.co.jp%2Fpcdepot%2Fi%2F10059612%2F">
      <img src="https://thumbnail.image.rakuten.co.jp/@0_mall/pcdepot/cabinet/mc39/19786.jpg?_ex=128x128">
    </a>
  </div>
  <div class="ad-rakuten-info">
    <div class="ad-rakuten-title">
      <a href="https://hb.afl.rakuten.co.jp/hgc/g00pajc2.waxycfed.g00pajc2.waxyd33d/?pc=https%3A%2F%2Fitem.rakuten.co.jp%2Fpcdepot%2F4988755041249%2F&amp;m=http%3A%2F%2Fm.rakuten.co.jp%2Fpcdepot%2Fi%2F10059612%2F">Crucial MX500 CT1000MX500SSD1/JP (1TB SATA600 SSD) 5年保証</a>
    </div>
    <div class="ad-rakuten-shop">
      <a href="https://hb.afl.rakuten.co.jp/hgc/g00pajc2.waxycfed.g00pajc2.waxyd33d/?pc=https%3A%2F%2Fwww.rakuten.co.jp%2Fpcdepot%2F&amp;m=http%3A%2F%2Fm.rakuten.co.jp%2Fpcdepot%2F">PC DEPOT</a>
    </div>
    <div class="ad-rakuten-price">価格 : 11338円</div>
  </div>
</div>
<p>SSD の方は、初めてクルーシャル製品を選んだ。WD Blue の SSD にしようとすると数千円高くなるので、値段で選んだｗ。クルーシャルは MX500 よりわずかに安い BX500 というラインナップもあったが、筐体がプラパーツだか何だかで冷却性能が微妙、読み書き速度も若干遅くなるらしいので、だったら千円ちょっと出して良い方を買っておくか、ということで MX500 シリーズを選んだ。同価格帯には SanDisk の Plus だか Ultra だかいう製品もあり、良し悪しが一見して分かりにくいね。ｗ</p>
<p>ちなみに、Galleria XG のマザーボード、Asus Prime H270-Plus には M.2 SSD を挿せる場所も2つあるのだが、未経験の M.2 は避けて今までと同じく SATA 6Gbps 接続の2.5インチ SSD を選んだ。M.2 にしたらもっと速いんだろうけど、それは将来のメインマシン交換のときにとっとくわ。ｗ</p>
<h2 id="換装"><a class="header-link" href="#換装"><span class="header-link-mark"></span></a>換装</h2>
<p>購入した HDD・SSD を換装していく。計画としては、既存の 2・3TB HDD の2つを取り除き、HDD 2台、SSD 3台を取り付けることにした。After は筐体の上から下 (底面) に向かって、次のような並び順。</p>
<ol>
  <li><em>8TB HDD (今回購入)</em></li>
  <li>500GB SSD (既存)</li>
  <li><em>1TB SSD (今回購入)</em></li>
  <li>500GB SSD (既存・システムドライブ)</li>
  <li>4TB HDD (既存)</li>
</ol>
<p>マザボの SATA ポートの番号は並び順どおりではなくグチャグチャなのだが、特に SATA ポートの番号の若い順に揃えたりしてもしなくても、動作には関係がなかった。ちなみに接続した SATA ポート番号順に書くとこんな感じ。</p>
<ol>
  <li>8TB HDD</li>
  <li>500GB SSD (システムドライブ)</li>
  <li>Blu-ray ドライブ (既存のまま)</li>
  <li>4TB HDD</li>
  <li>1TB SSD</li>
  <li>500GB SSD</li>
</ol>
<p>今回はケーブル類は既に揃っているので、ドライブの取り外しと取り付けのみ。コレで上手くいくはずだったのだが…。</p>
<h2 id="bios-画面から先に進まない"><a class="header-link" href="#bios-画面から先に進まない"><span class="header-link-mark"></span></a>BIOS 画面から先に進まない</h2>
<p><strong>2TB HDD</strong> と 3TB HDD を取り外し、8TB HDD と 1TB SSD を取り付けて起動したところ、<strong>UEFI BIOS 画面から先に進まなくなってしまった。</strong>よく見ると、SATA ポートに挿さっているドライブ類は全て認識しているのだが、ブート順序を選択できる画面でどのドライブも一覧に登場しない。システムドライブである SSD はケーブルを取り外したり移動したりしていないのだが、どうしてこのドライブがブートメニューに出てこないのだろうか？</p>
<p>
  <img src="./01-01-02.jpg" alt="右下ブートメニューにどのドライブも表示されない">
</p>
<p>↑ 本来はこの UEFI BIOS 画面の右下に、ブート順序を選択できる一覧が表示されるはずなのだが、赤枠部にどのドライブも出てこない。しかしその左側の SATA ポート一覧には HDD と SSD の製品名まで正しく表示されていて、新しい 8TB HDD・1TB SSD も認識はしているので、「システムドライブである SSD の接続を認識していない」ワケではないようだ。</p>
<p>SATA ポートの番号を変えてみたりなど色々したがダメ。仕方なく 2TB HDD と 3TB HDD を元に戻して取り付けてみると無事起動した。</p>
<h2 id="強引にホットスワップで動かしていたら気付いた"><a class="header-link" href="#強引にホットスワップで動かしていたら気付いた"><span class="header-link-mark"></span></a>強引にホットスワップで動かしていたら気付いた…</h2>
<p>元の構成だととりあえず Windows10 が起動したので、OS が起動している状態で、強引に SATA 端子を抜いて新しい HDD に差し替えることで、無理やりホットスワップしてみたら、とりあえずは新しい HDD も SSD も認識した。ということで、今回購入したドライブが故障しているワケではなさそう。</p>
<p>ひとまずは既存の <strong>2TB HDD</strong> と 3TB HDD から、データを抽出して 8TB HDD に移動させていたのだが、ふと「コンピューターの管理」→「ディスクの管理」でディスクを眺めていたところ、異変に気が付いた。</p>
<p>
  <img src="./01-01-03.png" alt="赤枠部、2TB HDD に「EFI システムパーティション」がある…">
</p>
<p>↑ 一覧の一番上が、システムドライブである 500GB の SSD。そして2つ下、赤枠で囲っているのが <strong>2TB の HDD</strong> なのだが、ココに<strong>「EFI システムパーティション」</strong>なるパーティションと、<em>「回復パーティション」</em>なるパーティションが存在することに気付いた。</p>
<p>そこで調べてみると、この<strong>「EFI システムパーティション」</strong>という部分が最初に起動することで、ブート順序を決めたりするための UEFI 部分が動作するようだ。</p>
<p>そういえば引越し後にリカバリをした際、<em>一度 HDD 側に OS が再インストールされてしまうトラブルがあった。</em>その時は SSD 側に再インストールするようにして対応したのだが、どうやらその時に OS と一緒に EFI 関連のパーティションが <strong>HDD 側にインストールされたまま動いていたようだ。</strong>要するに <strong>2TB の HDD を接続しておかないと PC が起動できない</strong>状態になっていたワケである。システムドライブである SSD の手前に必要な「EFI ブートローダ」というプログラムが、HDD 側にインストールされていたワケだ。</p>
<p>もう一つの<em>「回復パーティション」</em>というのはリカバリ時に使用するようだが、自分は今後リカバリする際はクリーンインストールするつもりなので、「システムの復元」は使わないのでココは捨ててしまって良いか。</p>
<p>ということは、やるべきことは、<em>2TB HDD に存在している「EFI システムパーティション」(EFI System Partition、略して ESP) を、システムドライブである 500GB SSD の方に作り直す</em>という作業が必要になる。</p>
<h2 id="efi-システムパーティションの作成に関して参考になったサイト"><a class="header-link" href="#efi-システムパーティションの作成に関して参考になったサイト"><span class="header-link-mark"></span></a>EFI システムパーティションの作成に関して参考になったサイト</h2>
<p>最初は EFI システムパーティションとやらが何なのかすら分かっていない状態だったのだが、以下の記事が分かりやすかった。</p>
<ul>
  <li>参考：<a href="https://qiita.com/rerymd/items/638a4fcf8f23ce8aab2d">【Win10】任意のディスクにEFIブートローダをインストールする - Qiita</a></li>
</ul>
<p>大まかな手順をまとめておく。</p>
<ol>
  <li>「EFI システムパーティション」を作りたい SSD で「ボリュームの縮小」を行い、「EFI システムパーティション」用の未割り当て領域を作る</li>
  <li><code>diskpart</code> コマンドで SSD の未割り当て領域に対し、EFI システムパーティションを作る</li>
  <li>動作確認したら、HDD 側にある EFI システムパーティションを削除する</li>
</ol>
<p>実質、必須なのは手順 1. と 2. だけで、手順 3. は後処理だ。</p>
<p>ちなみに色々調べたが、<strong>ドライブのパーティションの「左右」を入れ替えるのは無理そう。</strong>完全に全体をフォーマットして、左から順にパーティションを切り直さないといけないようだ。ググると「EaseUS Partition Master Free」といった専用ソフトがトップに出てきたりするが、こういうソフトでもパーティションの左右入れ替えなどは出来なかった。</p>
<p>綺麗にパーティションを切るなら、ドライブの左から「EFI システムパーティション」、システムパーティション、(任意で回復パーティション)、という風に並べたいところだが、今回はシステムパーティション → ESP という順番でパーティションを切り、動作上も問題なかったので、この手順で紹介する。</p>
<h2 id="ボリュームの縮小"><a class="header-link" href="#ボリュームの縮小"><span class="header-link-mark"></span></a>ボリュームの縮小</h2>
<p>まずはシステムドライブに EFI パーティション用の未割り当て領域を作る。「コンピューターの管理」→「ディスクの管理」と移動し、システムドライブを右クリックして「ボリュームの縮小」を選ぶ。</p>
<p>
  <img src="./01-01-04.png" alt="ボリュームの縮小">
</p>
<p>次に、ウィザードで作成する領域を指定するのだが、ココでは既存の EFI システムパーティションの容量に合わせて 100MB の領域を作ることにする。</p>
<p>
  <img src="./01-01-05.png" alt="既存の EFI システムパーティションに合わせて 100MB の領域を設定する">
</p>
<p>上手くパーティションが区切れると、以下のように未割り当て領域が 100MB 分できるはずだ。</p>
<p>
  <img src="./01-01-06.png" alt="未割り当ての 100MB の領域が出来た">
</p>
<h2 id="diskpart-コマンドで-efi-システムパーティションを作成する"><a class="header-link" href="#diskpart-コマンドで-efi-システムパーティションを作成する"><span class="header-link-mark"></span></a><code>diskpart</code> コマンドで EFI システムパーティションを作成する</h2>
<p>続いて、この未割り当て領域に「EFI システムパーティション」を作っていく。</p>
<p>管理者権限で PowerShell を起動し、<code>diskpart</code> コマンドを実行する。</p>
<pre class="language-powershell"><code class="language-powershell"><span class="token function">PS</span> C:\WINDOWS\system32> diskpart

Microsoft DiskPart バージョン 10<span class="token punctuation">.</span>0<span class="token punctuation">.</span>19041<span class="token punctuation">.</span>964

Copyright <span class="token punctuation">(</span>C<span class="token punctuation">)</span> Microsoft Corporation<span class="token punctuation">.</span>
コンピューター: NEOS<span class="token operator">-</span>GALLERIA

<span class="token comment"># 「ボリューム」の一覧を見るとこんな感じ</span>
DISKPART> list volume

  Volume <span class="token comment">###  Ltr Label        Fs    Type        Size     Status     Info</span>
  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span><span class="token operator">-</span> <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>  <span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>
  Volume 0     M                       DVD<span class="token operator">-</span>ROM         0 B  メディアなし
  Volume 1     C   C<span class="token operator">-</span>SSD<span class="token operator">-</span>500    NTFS   Partition    465 GB  正常         ブート
  Volume 2     T   HDD<span class="token operator">-</span>8000     NTFS   Partition   7452 GB  正常
  Volume 3     E   HDD<span class="token operator">-</span>2000     NTFS   Partition   1862 GB  正常
  Volume 4         SYSTEM       FAT32  Partition    100 MB  正常         非表示
  Volume 5         Windows RE   NTFS   Partition    450 MB  正常         非表示
  Volume 6     U   HDD<span class="token operator">-</span>3000     NTFS   Partition   2794 GB  正常
  Volume 7     D   SSD<span class="token operator">-</span>500      NTFS   Partition    465 GB  正常


DISKPART> list disk

  ディスク      状態           サイズ   空き   ダイナ GPT
  <span class="token comment">###                                          ミック</span>
  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span><span class="token operator">-</span>  <span class="token operator">--</span><span class="token operator">-</span>
  ディスク 0    オンライン           465 GB   100 MB        <span class="token operator">*</span>
  ディスク 1    オンライン          7452 GB  1024 KB        <span class="token operator">*</span>
  ディスク 2    オンライン          1863 GB      0 B        <span class="token operator">*</span>
  ディスク 3    オンライン          2794 GB  1024 KB        <span class="token operator">*</span>
  ディスク 4    オンライン           465 GB  1024 KB        <span class="token operator">*</span>
</code></pre>
<p>すると <code>DISKPART></code> という専用のプロンプトが表示される。まずは <code>list volume</code> でエクスプローラに表示される相当のドライブ達を確認し、<code>list disk</code> で「ディスクの管理」相当の内容が見えていることを確認する。</p>
<p><code>list volume</code> の方を見ると、<code>SYSTEM</code> と <code>Windows RE</code> という非表示のボリュームがある。コレが、2TB の HDD に作られてしまっている「EFI システムパーティション」と「回復パーティション」に相当する。</p>
<p><code>diskpart</code> では、ディスク → パーティション、という入れ子構造で操作する要素を選択していく。今回はシステムドライブである 500GB の SSD の中にある、100MB 分の未割り当て領域を選択していく。</p>
<pre class="language-powershell"><code class="language-powershell"><span class="token comment"># list disk の内容を見て、ディスク 0 を選択する</span>
DISKPART> <span class="token function">select</span> disk 0

ディスク 0 が選択されました。

<span class="token comment"># ディスク 0 内の既存のパーティションを確認する。未割り当て領域はココには表示されない</span>
DISKPART> list partition

  Partition <span class="token comment">###  Type                Size     Offset</span>
  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>
  Partition 1    プライマリ              465 GB  1024 KB

<span class="token comment"># 選択したディスク 0 の中にパーティションを作成する。size は MB 単位なので、100MB 単位でパーティションを作る</span>
DISKPART> create partition EFI size=100

DiskPart は指定したパーティションの作成に成功しました。

<span class="token comment"># パーティションが作成できたことを確認する。行頭のアスタリスクで作成した Partition 2 が選択されていることを確認する</span>
DISKPART> list partition

  Partition <span class="token comment">###  Type                Size     Offset</span>
  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>
  Partition 1    プライマリ              465 GB  1024 KB
<span class="token operator">*</span> Partition 2    システム               100 MB   465 GB

<span class="token comment"># ボリューム一覧にも Volume 8 が新登場した。行頭のアスタリスクで作成した Volume 8 が選択されていることを確認する</span>
DISKPART> list volume

  Volume <span class="token comment">###  Ltr Label        Fs    Type        Size     Status     Info</span>
  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span><span class="token operator">-</span> <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>  <span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>
  Volume 0     M                       DVD<span class="token operator">-</span>ROM         0 B  メディアなし
  Volume 1     C   C<span class="token operator">-</span>SSD<span class="token operator">-</span>500    NTFS   Partition    465 GB  正常         ブート
  Volume 2     T   HDD<span class="token operator">-</span>8000     NTFS   Partition   7452 GB  正常
  Volume 3     E   HDD<span class="token operator">-</span>2000     NTFS   Partition   1862 GB  正常
  Volume 4         SYSTEM       FAT32  Partition    100 MB  正常         非表示
  Volume 5         Windows RE   NTFS   Partition    450 MB  正常         非表示
  Volume 6     U   HDD<span class="token operator">-</span>3000     NTFS   Partition   2794 GB  正常
  Volume 7     D   SSD<span class="token operator">-</span>500      NTFS   Partition    465 GB  正常
<span class="token operator">*</span> Volume 8                      RAW    Partition    100 MB  正常         非表示
</code></pre>
<p>このように、まずはパーティションだけ切れた。引き続きこのパーティションをフォーマットし、UEFI ブートローダをインストールしていく。</p>
<pre class="language-powershell"><code class="language-powershell"><span class="token comment"># 選択されている Volume 8 をフォーマットし、「ESP」というラベルを付けておく</span>
DISKPART> format quick fs=fat32 label=<span class="token string">"ESP"</span>

  100<span class="token operator">%</span> 完了しました

DiskPart は、ボリュームのフォーマットを完了しました。

<span class="token comment"># フォーマットした Volume 8 = 「ESP」はこんな感じ</span>
DISKPART> list volume

  Volume <span class="token comment">###  Ltr Label        Fs    Type        Size     Status     Info</span>
  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span><span class="token operator">-</span> <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>  <span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>
  Volume 0     M                       DVD<span class="token operator">-</span>ROM         0 B  メディアなし
  Volume 1     C   C<span class="token operator">-</span>SSD<span class="token operator">-</span>500    NTFS   Partition    465 GB  正常         ブート
  Volume 2     T   HDD<span class="token operator">-</span>8000     NTFS   Partition   7452 GB  正常
  Volume 3     E   HDD<span class="token operator">-</span>2000     NTFS   Partition   1862 GB  正常
  Volume 4         SYSTEM       FAT32  Partition    100 MB  正常         非表示
  Volume 5         Windows RE   NTFS   Partition    450 MB  正常         非表示
  Volume 6     U   HDD<span class="token operator">-</span>3000     NTFS   Partition   2794 GB  正常
  Volume 7     D   SSD<span class="token operator">-</span>500      NTFS   Partition    465 GB  正常
<span class="token operator">*</span> Volume 8         ESP          FAT32  Partition    100 MB  正常         非表示

<span class="token comment"># 選択中の Volume 8 に、一時的にドライブレターを割り当てる</span>
DISKPART> assign letter=X

DiskPart はドライブ文字またはマウント ポイントを正常に割り当てました。

<span class="token comment"># ドライブレターとして「X」が正常に割り当てられたことを確認する</span>
DISKPART> list volume

  Volume <span class="token comment">###  Ltr Label        Fs    Type        Size     Status     Info</span>
  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span><span class="token operator">-</span> <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>  <span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>
  Volume 0     M                       DVD<span class="token operator">-</span>ROM         0 B  メディアなし
  Volume 1     C   C<span class="token operator">-</span>SSD<span class="token operator">-</span>500    NTFS   Partition    465 GB  正常         ブート
  Volume 2     T   HDD<span class="token operator">-</span>8000     NTFS   Partition   7452 GB  正常
  Volume 3     E   HDD<span class="token operator">-</span>2000     NTFS   Partition   1862 GB  正常
  Volume 4         SYSTEM       FAT32  Partition    100 MB  正常         非表示
  Volume 5         Windows RE   NTFS   Partition    450 MB  正常         非表示
  Volume 6     U   HDD<span class="token operator">-</span>3000     NTFS   Partition   2794 GB  正常
  Volume 7     D   SSD<span class="token operator">-</span>500      NTFS   Partition    465 GB  正常
<span class="token operator">*</span> Volume 8     X   ESP          FAT32  Partition    100 MB  正常         非表示

<span class="token comment"># diskpart コマンドを終了する</span>
DISKPART> <span class="token keyword">exit</span>

DiskPart を終了しています<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre>
<p>そしたら引き続き管理者権限で起動している PowerShell 上で、次のように <code>bcdboot</code> コマンドを実行する。</p>
<pre class="language-powershell"><code class="language-powershell"><span class="token function">PS</span> C:\WINDOWS\system32> bcdboot C:\Windows <span class="token operator">/</span>s X: <span class="token operator">/</span>f UEFI
ブート ファイルは正常に作成されました。
</code></pre>
<p>割り当てたドライブレターである「X」を指定し、UEFI ブートローダをインストールできた。</p>
<p>
  <img src="./01-01-07.png" alt="システムドライブに EFI システムパーティションができているはず">
</p>
<p>↑ 「ディスクの管理」で確認すると、このように EFI システムパーティションが作成できているはずだ。</p>
<p>
  <img src="./01-01-08.png" alt="エクスプローラにも「ESP」ボリュームが見えている">
</p>
<p>↑ ちなみにエクスプローラにも、ドライブレター「X」を割り当てたボリューム「ESP」が見えていることだろう。</p>
<h2 id="動作確認する"><a class="header-link" href="#動作確認する"><span class="header-link-mark"></span></a>動作確認する</h2>
<p>ココまで作業できたら、一度 PC の電源を落として、今まで EFI システムパーティションが載っていた 2TB の HDD を取り外してマシンを起動してみる。SSD 側に新規作成した EFI システムパーティションを使って PC が起動してくれるか確認する。</p>
<p>自分は問題なく SSD のみで PC が起動するようになった。とりあえず必須の作業はココまでで、あとは残処理。</p>
<h2 id="espボリュームのドライブレターを削除する"><a class="header-link" href="#espボリュームのドライブレターを削除する"><span class="header-link-mark"></span></a>「ESP」ボリュームのドライブレターを削除する</h2>
<p>「ESP」ボリュームが X ドライブとして見え続けている必要はないので、ドライブレターを削除する。管理者権限で起動した PowerShell で再び <code>diskpart</code> コマンドを起動する。</p>
<pre class="language-powershell"><code class="language-powershell">DISKPART> list volume

  Volume <span class="token comment">###  Ltr Label        Fs    Type        Size     Status     Info</span>
  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span><span class="token operator">-</span> <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>  <span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>
  Volume 0     M                       DVD<span class="token operator">-</span>ROM         0 B  メディアなし
  Volume 1     C   C<span class="token operator">-</span>SSD<span class="token operator">-</span>500    NTFS   Partition    465 GB  正常         ブート
  Volume 2     X   ESP          FAT32  Partition    100 MB  正常         非表示
  Volume 3     T   HDD<span class="token operator">-</span>8000     NTFS   Partition   7452 GB  正常
  Volume 4     E   HDD<span class="token operator">-</span>2000     NTFS   Partition   1862 GB  正常
  Volume 5         SYSTEM       FAT32  Partition    100 MB  正常         非表示
  Volume 6         Windows RE   NTFS   Partition    450 MB  正常         非表示
  Volume 7     U   HDD<span class="token operator">-</span>3000     NTFS   Partition   2794 GB  正常
  Volume 8     D   SSD<span class="token operator">-</span>500      NTFS   Partition    465 GB  正常

<span class="token comment"># Volume 2 を選択する</span>
DISKPART> <span class="token function">select</span> volume 2

ボリューム 2 が選択されました。

<span class="token comment"># 割り当てていたドライブレター「X」を削除する</span>
DISKPART> remove letter X

DiskPart はドライブ文字またはマウント ポイントを正常に削除しました。

<span class="token comment"># ドライブレターが消えたことを確認する</span>
DISKPART> list volume

  Volume <span class="token comment">###  Ltr Label        Fs    Type        Size     Status     Info</span>
  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span><span class="token operator">-</span> <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>  <span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>
  Volume 0     M                       DVD<span class="token operator">-</span>ROM         0 B  メディアなし
  Volume 1     C   C<span class="token operator">-</span>SSD<span class="token operator">-</span>500    NTFS   Partition    465 GB  正常         ブート
<span class="token operator">*</span> Volume 2         ESP          FAT32  Partition    100 MB  正常         非表示
  Volume 3     T   HDD<span class="token operator">-</span>8000     NTFS   Partition   7452 GB  正常
  Volume 4     E   HDD<span class="token operator">-</span>2000     NTFS   Partition   1862 GB  正常
  Volume 5         SYSTEM       FAT32  Partition    100 MB  正常         非表示
  Volume 6         Windows RE   NTFS   Partition    450 MB  正常         非表示
  Volume 7     U   HDD<span class="token operator">-</span>3000     NTFS   Partition   2794 GB  正常
  Volume 8     D   SSD<span class="token operator">-</span>500      NTFS   Partition    465 GB  正常
</code></pre>
<h2 id="hdd-側の-efi-システムパーティションなどを削除する"><a class="header-link" href="#hdd-側の-efi-システムパーティションなどを削除する"><span class="header-link-mark"></span></a>HDD 側の EFI システムパーティションなどを削除する</h2>
<p>コレでシステムドライブがある SSD 側の対応は終わったので、あとは 2TB の HDD 側にある EFI システムパーティションと回復パーティションを削除してしまおう。</p>
<p>以降の作業では 2TB の HDD を一度初期化するので、当然ながら HDD 内のデータは事前に退避しておくこと。</p>
<pre class="language-powershell"><code class="language-powershell"><span class="token comment"># ディスク 4 が 2TB HDD のこと</span>
DISKPART> list disk

  ディスク      状態           サイズ   空き   ダイナ GPT
  <span class="token comment">###                                          ミック</span>
  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span><span class="token operator">-</span>  <span class="token operator">--</span><span class="token operator">-</span>
  ディスク 0    オンライン           465 GB      0 B        <span class="token operator">*</span>
  ディスク 1    オンライン          7452 GB  1024 KB        <span class="token operator">*</span>
  ディスク 2    オンライン          2794 GB  1024 KB        <span class="token operator">*</span>
  ディスク 3    オンライン           465 GB  1024 KB        <span class="token operator">*</span>
  ディスク 4    オンライン          1863 GB      0 B        <span class="token operator">*</span>

<span class="token comment"># Volume 6・7・8 の3つが 2TB の HDD に作られているパーティション達だ</span>
DISKPART> list volume

  Volume <span class="token comment">###  Ltr Label        Fs    Type        Size     Status     Info</span>
  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span><span class="token operator">-</span> <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>  <span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>
  Volume 0     M                       DVD<span class="token operator">-</span>ROM         0 B  メディアなし
  Volume 1     C   C<span class="token operator">-</span>SSD<span class="token operator">-</span>500    NTFS   Partition    465 GB  正常         ブート
  Volume 2         ESP          FAT32  Partition    100 MB  正常         システム
  Volume 3     T   HDD<span class="token operator">-</span>8000     NTFS   Partition   7452 GB  正常
  Volume 4     U   HDD<span class="token operator">-</span>3000     NTFS   Partition   2794 GB  正常
  Volume 5     D   SSD<span class="token operator">-</span>500      NTFS   Partition    465 GB  正常
  Volume 6     E   HDD<span class="token operator">-</span>2000     NTFS   Partition   1862 GB  正常
  Volume 7         SYSTEM       FAT32  Partition    100 MB  正常         非表示
  Volume 8         Windows RE   NTFS   Partition    450 MB  正常         非表示

<span class="token comment"># 2TB HDD を選択する</span>
DISKPART> <span class="token function">select</span> disk 4

ディスク 4 が選択されました。

<span class="token comment"># 現在のパーティションを確認する</span>
DISKPART> list partition

  Partition <span class="token comment">###  Type                Size     Offset</span>
  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>
  Partition 1    システム               100 MB  1024 KB
  Partition 2    予約                  16 MB   101 MB
  Partition 3    プライマリ             1862 GB   117 MB
  Partition 4    回復                 450 MB  1862 GB

<span class="token comment"># EFI システムパーティションに相当する Partition 1 を選択する</span>
DISKPART> <span class="token function">select</span> partition 1

パーティション 1 が選択されました。

<span class="token comment"># Partition 1 が選択できていることを行頭のアスタリスクで確認する</span>
DISKPART> list partition

  Partition <span class="token comment">###  Type                Size     Offset</span>
  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>
<span class="token operator">*</span> Partition 1    システム               100 MB  1024 KB
  Partition 2    予約                  16 MB   101 MB
  Partition 3    プライマリ             1862 GB   117 MB
  Partition 4    回復                 450 MB  1862 GB

<span class="token comment"># パーティションを削除する</span>
DISKPART> delete partition override

DiskPart は選択されたパーティションを正常に削除しました。

<span class="token comment"># 削除したパーティションは一覧に表示されなくなる</span>
DISKPART> list partition

  Partition <span class="token comment">###  Type                Size     Offset</span>
  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>
  Partition 2    予約                  16 MB   101 MB
  Partition 3    プライマリ             1862 GB   117 MB
  Partition 4    回復                 450 MB  1862 GB
</code></pre>
<p>こんな感じで、HDD 側に作られていた EFI システムパーティションを「未割り当て」状態にできた。この時点で「ディスクの管理」を見ると、以下のようになっているだろう。</p>
<p>
  <img src="./01-01-09.png" alt="EFI システムパーティションがあったところが「未割り当て」になった">
</p>
<p>↑ EFI システムパーティションがあったところが「未割り当て」になっている。</p>
<pre class="language-powershell"><code class="language-powershell"><span class="token comment"># 引き続き、回復パーティションも削除する</span>
DISKPART> <span class="token function">select</span> partition 4

パーティション 4 が選択されました。

DISKPART> delete partition override

DiskPart は選択されたパーティションを正常に削除しました。
</code></pre>
<pre class="language-powershell"><code class="language-powershell"><span class="token comment"># ついでに、データ部分のパーティションも削除する</span>
DISKPART> <span class="token function">select</span> partition 3

パーティション 3 が選択されました。

DISKPART> delete partition override

DiskPart は選択されたパーティションを正常に削除しました。

DISKPART> list partition

  Partition <span class="token comment">###  Type                Size     Offset</span>
  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>
  Partition 2    予約                  16 MB   101 MB

</code></pre>
<pre class="language-powershell"><code class="language-powershell"><span class="token comment"># ついでについでに、謎の「予約」パーティションも削除してまっさらにする</span>
DISKPART> <span class="token function">select</span> partition 2

パーティション 2 が選択されました。

DISKPART> delete partition override

DiskPart は選択されたパーティションを正常に削除しました。

DISKPART> list partition

このディスクには表示するパーティションがありません。
</code></pre>
<p>こうして 2TB の HDD はまっさらになった。</p>
<pre class="language-powershell"><code class="language-powershell"><span class="token comment"># 2TB の HDD がボリューム一覧から見えなくなった</span>
DISKPART> list volume

  Volume <span class="token comment">###  Ltr Label        Fs    Type        Size     Status     Info</span>
  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span><span class="token operator">-</span> <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>  <span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>
  Volume 0     M                       DVD<span class="token operator">-</span>ROM         0 B  メディアなし
  Volume 1     C   C<span class="token operator">-</span>SSD<span class="token operator">-</span>500    NTFS   Partition    465 GB  正常         ブート
  Volume 2         ESP          FAT32  Partition    100 MB  正常         システム
  Volume 3     T   HDD<span class="token operator">-</span>8000     NTFS   Partition   7452 GB  正常
  Volume 4     U   HDD<span class="token operator">-</span>3000     NTFS   Partition   2794 GB  正常
  Volume 5     D   SSD<span class="token operator">-</span>500      NTFS   Partition    465 GB  正常

<span class="token comment"># ディスク一覧には存在している</span>
DISKPART> list disk

  ディスク      状態           サイズ   空き   ダイナ GPT
  <span class="token comment">###                                          ミック</span>
  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span><span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span>-<span class="token operator">--</span>-<span class="token operator">-</span>  <span class="token operator">--</span><span class="token operator">-</span>  <span class="token operator">--</span><span class="token operator">-</span>
  ディスク 0    オンライン           465 GB      0 B        <span class="token operator">*</span>
  ディスク 1    オンライン          7452 GB  1024 KB        <span class="token operator">*</span>
  ディスク 2    オンライン          2794 GB  1024 KB        <span class="token operator">*</span>
  ディスク 3    オンライン           465 GB  1024 KB        <span class="token operator">*</span>
<span class="token operator">*</span> ディスク 4    オンライン          1863 GB  1863 GB        <span class="token operator">*</span>

DISKPART> <span class="token keyword">exit</span>

DiskPart を終了しています<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre>
<p>さて、ココまで作業できたら、「ディスクの管理」で 2TB の HDD 全体が一つの「未割り当て領域」になっていることが確認できるだろう。</p>
<p>
  <img src="./01-01-10.png" alt="2TB の HDD は全体が空っぽになった">
</p>
<p>あとは前回のブログ記事でもやったように、GPT 方式でディスクの初期化をして、NTFS とかでフォーマットすれば、このドライブは再び 2TB のデータ用 HDD として機能するようになる。おまけに余計な EFI システムパーティションや回復パーティションも削除できたワケだ。</p>
<h2 id="謎に苦労したけどなんとかなった"><a class="header-link" href="#謎に苦労したけどなんとかなった"><span class="header-link-mark"></span></a>謎に苦労したけどなんとかなった</h2>
<p>…というワケで、「EFI システムパーティション」とかいう思いもよらぬモノのせいで慌てたが、ひとまずコレで SSD・HDD の移設が完了した。</p>
<ul>
  <li>システムドライブを担う 500GB の SSD に「EFI システムパーティション」が載り、この PC はこの SSD が1台繋がっていれば、とりあえず OS は起動する状態になった。</li>
  <li>そして既存の 500GB の SSD (2つ目) と、今回購入した 1TB の SSD とを、高速なデータ転送が必要なデータ置き場として利用する。</li>
  <li>既存の 4TB の HDD と、今回購入した 8TB の HDD は、その他のデータを全て保存している。
    <ul>
      <li>あとは USB で外付けの 4TB HDD も繋いでいるので、4TB の内蔵 HDD はコチラとデータを二重化してある</li>
      <li>8TB HDD に保存しているデータのバックアップができていないが、まぁココはネットで拾ったデータ置き場なので最悪は失ってもいいかと思っている</li>
    </ul>
  </li>
</ul>
<p>取り外した 2TB と 3TB の HDD は、それぞれ 8TB HDD にデータを移動したので、空っぽな状態で持て余している。内蔵 HDD を USB 接続できるようにするアダプタなんかを使えばデータ置き場として利用したりもできるし、NAS だか裸族のタワーケースだかでも買えば使えるんだろうけど、今のところそこまでして置きたいデータもないので、押し入れにしまっておく。ｗ</p>

      </main>
      <footer id="footer">
        <div id="footer-contents">
          <div id="date-time">
            <dl>
              <dt>Created</dt>
              <dd><time>2022-07-01</time></dd>
              <dt>Last-Modified</dt>
              <dd><time>2022-07-01</time></dd>
            </dl>
          </div>
          <nav id="footer-links">
            <ul>
              <li id="footer-link-about"><a href="/about/index.html" title="About">About</a></li>
              <li id="footer-link-search"><a href="/about/search.html" title="Search">Search</a></li>
              <li id="footer-link-feeds"><a href="/feeds.xml" title="Feeds">Feeds</a></li>
              <li id="footer-link-github"><a href="https://github.com/Neos21/" title="GitHub">GitHub</a></li>
            </ul>
          </nav>
          <nav id="to-top"><a href="#" title="To Top"><span>▲ To Top</span></a></nav>
        </div>
      </footer>
    </div>
  </body>
</html>
