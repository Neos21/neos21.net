<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="theme-color" content="#0990d0">
    <!-- Google Search Console -->
    <meta name="google-site-verification" content="AvoEr3mUJFF2H_mPWWgShfmjBVP3ywRpyx9hxeeq2d4">
    <!-- Open Graph・Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Neo's World">
    <meta property="og:title" content="Windows GitBash から GUI に通知を出す方法3選 - Neo's World">
    <meta property="og:description" content="Windows GitBash から GUI に通知を出す方法3選 - Neo's World">
    <meta property="og:url" content="https://neos21.net/blog/2022/01/27-01.html">
    <meta property="og:image" content="https://neos21.net/ogp.png">
    <meta property="og:locale" content="ja_JP">
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:title" content="Windows GitBash から GUI に通知を出す方法3選 - Neo's World">
    <meta property="twitter:description" content="Windows GitBash から GUI に通知を出す方法3選 - Neo's World">
    <meta property="twitter:url" content="https://neos21.net/blog/2022/01/27-01.html">
    <meta property="twitter:image" content="https://neos21.net/ogp.png">
    <title>Windows GitBash から GUI に通知を出す方法3選 - Neo's World</title>
    <link rel="icon" href="/favicon.ico">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    <link rel="manifest" href="/manifest.webmanifest">
    <link rel="stylesheet" href="/styles.css">
    <link rel="canonical" href="https://neos21.net/blog/2022/01/27-01.html">
    <link rel="search" type="application/opensearchdescription+xml" title="neos21.net" href="/opensearch.xml">
    <link rel="alternate" type="application/atom+xml" title="Feeds" href="/feeds.xml">
    <link rel="author" href="http://www.hatena.ne.jp/neos21/">
    <script src="/scripts.js"></script>
    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YMHFLZP1M1"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date());gtag('config','G-YMHFLZP1M1');gtag('config','UA-106501-1');</script>
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6475907504235292" crossorigin="anonymous"></script>
  </head>
  <body>
    <div id="container">
      <header id="header">
        <div id="header-brand">
          <div id="header-brand-contents">
            <div id="site-title"><a href="/index.html">Neo's World</a></div>
            <nav id="header-links">
              <ul>
                <li id="header-link-theme"><a href="#" title="Toggle Theme"><span>Toggle Theme</span></a></li>
                <li id="header-link-about"><a href="/about/index.html" title="About"><span>About</span></a></li>
                <li id="header-link-search"><a href="/about/search.html" title="Search"><span>Search</span></a></li>
                <li id="header-link-feeds"><a href="/feeds.xml" title="Feeds"><span>Feeds</span></a></li>
                <li id="header-link-to-bottom"><a href="#footer" title="To Bottom"><span>▼ To Bottom</span></a></li>
              </ul>
            </nav>
          </div>
        </div>
        <nav id="global-nav">
          <ul>
            <li><a href="/blog/index.html">Blog</a></li>
            <li><a href="/tech/index.html">Tech</a></li>
            <li><a href="/music/index.html">Music</a></li>
            <li><a href="/games/index.html">Games</a></li>
            <li><a href="/gallery/index.html">Gallery</a></li>
            <li><a href="/etc/index.html">Etc.</a></li>
          </ul>
        </nav>
        <nav id="path">
          <ul>
            <li><a href="/index.html">Neo's World</a></li>
            <li><a href="/blog/index.html">Blog</a></li>
            <li><a href="/blog/2022/index.html">2022年</a></li>
            <li><a href="/blog/2022/01/index.html">01月</a></li>
          </ul>
        </nav>
      </header>
      <main id="main">
        <div id="header-date"><time>2022-01-27</time></div>
        <h1 id="page-title">Windows GitBash から GUI に通知を出す方法3選</h1>

<p>Windows GitBash (Git SDK) を使って長めのバッチ作業をすることがあった。バッチ作業が終わった時に気付きを得たいので、Windows の GUI 上に通知を出したいと考えた。</p>
<p>今回は3つほど実現方法を見つけたので紹介する。</p>
<h2 id="目次"><a class="header-link" href="#目次"><span class="header-link-mark"></span></a>目次</h2>
<ul>
  <li><a href="#%E6%A8%99%E6%BA%96%E6%90%AD%E8%BC%89%E3%81%AE-msgexe-%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89">標準搭載の <code>msg.exe</code> コマンド</a></li>
  <li><a href="#burnttoast-%E3%82%92%E4%BD%BF%E3%81%86">BurntToast を使う</a></li>
  <li><a href="#notifu-%E3%82%92%E4%BD%BF%E3%81%86">Notifu を使う</a></li>
  <li><a href="#%E4%BB%A5%E4%B8%8A%E3%81%A4%E3%81%84%E3%81%A7%E3%81%AB-sleep-%E7%B3%BB%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%81%BE%E3%81%A8%E3%82%81">以上・ついでに Sleep 系コマンドまとめ</a></li>
</ul>
<h2 id="標準搭載の-msgexe-コマンド"><a class="header-link" href="#標準搭載の-msgexe-コマンド"><span class="header-link-mark"></span></a>標準搭載の <code>msg.exe</code> コマンド</h2>
<p>Windows 10 Pro に標準搭載されている <strong><code>msg</code></strong> (<code>C:\Windows\System32\msg.exe</code>) というコマンドを使う方法。</p>
<p>コマンドプロンプトや PowerShell では次のようにコールすれば良い。</p>
<pre class="language-batch"><code class="language-batch"><span class="token command"><span class="token keyword">msg</span> * <span class="token string">"ココにメッセージ"</span></span>
</code></pre>
<p>コマンドを実行すると、画面中央にアラート的なプロンプトウィンドウが表示される。「【ユーザ名】からのメッセージ 【日時】」というウィンドウタイトルで、「OK」ボタンのみのプロンプトだ。</p>
<p>時間がかかる処理を、同じく Windows 標準搭載の <code>timeout</code> コマンド (<code>C:\Windows\System32\timeout.exe</code>) で再現すると、こんな感じ。</p>
<pre class="language-batch"><code class="language-batch"><span class="token operator">@</span><span class="token command"><span class="token keyword">rem</span> <span class="token number">3</span>秒後に完了メッセージを出す</span>
<span class="token command"><span class="token keyword">timeout</span> <span class="token parameter attr-name">/t</span> <span class="token number">3</span> <span class="token parameter attr-name">/nobreak</span> </span><span class="token operator">&#x26;</span><span class="token operator">&#x26;</span> <span class="token command"><span class="token keyword">msg</span> * <span class="token string">"Finished"</span></span>
</code></pre>
<p>第1引数の <code>*</code> 部分は、メッセージ送信先のユーザ名を指定するようだが、自分自身のユーザ名を指定するのも面倒なので、アスタリスクで済ませている。</p>
<p>コレを GitBash (Git SDK) で呼び出すには、次のようにする。Msys・Cygwin 系の Bash 環境から Windows コマンドを実行するには、<code>cmd /c</code> を使ってコマンドプロンプト上で起動させてやれば良いワケだ。</p>
<pre class="language-bash"><code class="language-bash">$ cmd /c <span class="token string">'msg * "ココにメッセージ"'</span>
</code></pre>
<p>GitBash に標準搭載されている <code>sleep</code> コマンドを使って再現すると、こんな感じで使えるだろう。</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token builtin class-name">type</span> <span class="token function">sleep</span>
<span class="token function">sleep</span> は /usr/bin/sleep です

$ <span class="token function">sleep</span> <span class="token number">3</span> <span class="token operator">&#x26;&#x26;</span> cmd /c <span class="token string">'msg * "Finished"'</span>
</code></pre>
<p>メッセージの表示形式を細かく指定することはできないが、Windows 標準搭載のコマンドであり、他に何もインストールせずとも使えるのがメリット。</p>
<ul>
  <li>参考 : <a href="https://stackoverflow.com/questions/16227971/whats-the-cygwin-windows-equivalent-of-linux-notify-send">libnotify - what's the cygwin/Windows equivalent of Linux' notify-send - Stack Overflow</a></li>
</ul>
<h2 id="burnttoast-を使う"><a class="header-link" href="#burnttoast-を使う"><span class="header-link-mark"></span></a>BurntToast を使う</h2>
<p>BurntToast という PowerShell 製のフリーソフトを使うと、Windows 10 でよく見る、画面右下に表示されるモダンな通知メッセージが表示できる。</p>
<ul>
  <li>参考 : <a href="https://github.com/Windos/BurntToast">Windos/BurntToast: Module for creating and displaying Toast Notifications on Microsoft Windows 10.</a></li>
</ul>
<p>最近の PowerShell に標準搭載されている <em><code>Install-Module</code></em> というコマンドレットを使うと、<a href="https://www.powershellgallery.com/">PowerShell Gallery</a> からモジュールとしてインストールできる。Linux でいう <code>apt</code> や <code>dnf</code> コマンド的な感じかな。</p>
<pre class="language-powershell"><code class="language-powershell"><span class="token comment"># 以下のようにインストールする</span>
<span class="token function">PS</span>> <span class="token function">Install-Module</span> <span class="token operator">-</span>Name BurntToast
続行するには NuGet プロバイダーが必要です
PowerShellGet で NuGet ベースのリポジトリを操作するには、<span class="token string">'2.8.5.201'</span> 以降のバージョンの NuGet プロバイダーが必要です。
NuGet プロバイダーは <span class="token string">'C:\Program Files\PackageManagement\ProviderAssemblies'</span> または <span class="token string">'C:\Users\【ユーザ名】\AppData\Local\PackageManagement\ProviderAssemblies'</span> に配置する必要があります。
<span class="token string">'Install-PackageProvider -Name NuGet -MinimumVersion 2.8.5.201 -Force'</span> を実行して NuGet プロバイダーをインストールすることもできます。
今すぐ PowerShellGet で NuGet プロバイダーをインストールしてインポートしますか?
<span class="token namespace">[Y]</span> はい<span class="token punctuation">(</span>Y<span class="token punctuation">)</span>  <span class="token namespace">[N]</span> いいえ<span class="token punctuation">(</span>N<span class="token punctuation">)</span>  <span class="token namespace">[S]</span> 中断<span class="token punctuation">(</span>S<span class="token punctuation">)</span>  <span class="token punctuation">[</span>?<span class="token punctuation">]</span> ヘルプ <span class="token punctuation">(</span>既定値は <span class="token string">"Y"</span><span class="token punctuation">)</span>: y

信頼されていないリポジトリ
信頼されていないリポジトリからモジュールをインストールしようとしています。
このリポジトリを信頼する場合は、<span class="token function">Set-PSRepository</span> コマンドレットを実行して、リポジトリの InstallationPolicy の値を変更してください。
<span class="token string">'PSGallery'</span> からモジュールをインストールしますか?
<span class="token namespace">[Y]</span> はい<span class="token punctuation">(</span>Y<span class="token punctuation">)</span>  <span class="token namespace">[A]</span> すべて続行<span class="token punctuation">(</span>A<span class="token punctuation">)</span>  <span class="token namespace">[N]</span> いいえ<span class="token punctuation">(</span>N<span class="token punctuation">)</span>  <span class="token namespace">[L]</span> すべて無視<span class="token punctuation">(</span>L<span class="token punctuation">)</span>  <span class="token namespace">[S]</span> 中断<span class="token punctuation">(</span>S<span class="token punctuation">)</span>  <span class="token punctuation">[</span>?<span class="token punctuation">]</span> ヘルプ <span class="token punctuation">(</span>既定値は <span class="token string">"N"</span><span class="token punctuation">)</span>: y

<span class="token comment"># インストールできた。適当に通知してみる</span>
<span class="token function">PS</span>> <span class="token function">New-BurntToastNotification</span>

<span class="token comment"># メッセージは以下のように指定できる</span>
<span class="token function">PS</span>> <span class="token function">New-BurntToastNotification</span> <span class="token operator">-</span>Text <span class="token string">'ココにメッセージ'</span>
</code></pre>
<p>PowerShell 製のツールなので、GitBash から実行する際は <code>cmd /c</code>ではなく <code>powershell</code> から起動してやると良い。</p>
<pre class="language-bash"><code class="language-bash">$ powershell <span class="token string">'New-BurntToastNotification -Text "ココにメッセージ"'</span>

$ <span class="token function">sleep</span> <span class="token number">3</span> <span class="token operator">&#x26;&#x26;</span> powershell <span class="token string">'New-BurntToastNotification -Text "ココにメッセージ"'</span>
</code></pre>
<p>オプションでアイコンやサウンドなども指定できる。PowerShell 標準の <code>Install-Module</code> コマンドレットから簡単にインストールできるのでよかろう。</p>
<h2 id="notifu-を使う"><a class="header-link" href="#notifu-を使う"><span class="header-link-mark"></span></a>Notifu を使う</h2>
<p>Notifu という古くからあるツールを使う方法。</p>
<ul>
  <li>参考 : <a href="https://www.paralint.com/projects/notifu/">Notifu, a free open source pop-up balloon utility | The Parallel Interface</a></li>
</ul>
<p>本稿執筆時点での最新版である v1.7.1 は以下からダウンロードできた。</p>
<ul>
  <li><a href="https://github.com/ixe013/notifu/releases/tag/1.7.1">Release Option to remove icon in message · ixe013/notifu</a></li>
</ul>
<p>Zip ファイルを解凍すると、<code>notifu.exe</code> と <code>notifu64.exe</code> というファイルが出てくる。<code>notifu64.exe</code> の方が 64bit 版のようなので、このファイルを <code>notifu.exe</code> にリネームし、PATH の通っているところに配置する。</p>
<p>コマンドプロンプトで使う場合はこんな感じ。<code>/m</code> オプションでメッセージ本文を指定するのは必須。<code>/d 5</code> が通知の表示秒数で、この時間が経過するか、バルーンを触って閉じるまでプロンプトが戻らないところが特徴。<code>/i notifu.exe</code> はバルーンに表示するアイコンの指定 (省略可)。</p>
<pre class="language-batch"><code class="language-batch"><span class="token command"><span class="token keyword">notifu</span> <span class="token parameter attr-name">/p</span> <span class="token string">"タイトル"</span> <span class="token parameter attr-name">/m</span> <span class="token string">"ココにメッセージ"</span> <span class="token parameter attr-name">/d</span> <span class="token number">5</span> <span class="token parameter attr-name">/i</span> notifu.exe</span>
</code></pre>
<p>Windows XP や Windows 7 時代はよく見かけた、<em>タスクトレイに表示されるバルーンアイコンからフキダシの形</em>で通知が表示される。コマンド実行後に <code>%ERRORLEVEL%</code> 変数を確認することで、通知をどのように扱ったのかが確認できる。</p>
<p>GitBash から実行する際は <code>cmd /c</code> を使えば良い。</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token function">sleep</span> <span class="token number">3</span> <span class="token operator">&#x26;&#x26;</span> cmd /c <span class="token string">'notifu /m "ココにメッセージ" /d 3'</span>
</code></pre>
<p>exe ファイルを自分で配置する原始的なフリーソフトで、少々手間。Windows XP 風のバルーン UI に愛着がなければわざわざ選ばなくても良いかも。w</p>
<h2 id="以上ついでに-sleep-系コマンドまとめ"><a class="header-link" href="#以上ついでに-sleep-系コマンドまとめ"><span class="header-link-mark"></span></a>以上・ついでに Sleep 系コマンドまとめ</h2>
<p>他にも、Windows Vista あたりまでは標準搭載されていた <code>net send</code> コマンドを使って通知メッセージを表示する方法もあって、コレは自分も使った経験があるのだが、Vista 以降の OS では使えないらしく、Windows 10 Pro で試しても <code>net send</code> コマンドは存在しなかった。そこで代わりに見つけたのが <code>msg.exe</code> だった、というワケ。</p>
<p>GitBash から Windows コマンドを実行する際は <code>cmd /c</code> ないしは <code>powershell</code> で OK。ようやく覚えた。</p>
<p>ついでに調査の中で、<em>「指定の秒数だけ待機するコマンド」を環境別に整理した</em>ので、以下に書いておく。いずれも「3秒待機する」例で記載している。</p>
<ul>
  <li>Windows コマンドプロンプト : <code>timeout</code>
    <ul>
      <li><code>/NoBreak</code> オプションを付けると <code>Ctrl + C</code> でのみ中断が可能。オプションを付けないと「任意のキー」で中断が可能になる</li>
    </ul>
  </li>
</ul>
<pre class="language-batch"><code class="language-batch"><span class="token command"><span class="token keyword">cmd</span>> timeout <span class="token parameter attr-name">/T</span> <span class="token number">3</span> <span class="token parameter attr-name">/NoBreak</span></span>
</code></pre>
<ul>
  <li>PowerShell : <code>Start-Sleep</code> コマンドレット (<code>sleep</code> は <code>Start-Sleep</code> のエイリアス)</li>
</ul>
<pre class="language-powershell"><code class="language-powershell"><span class="token function">PS</span>> <span class="token function">Start-Sleep</span> 3
<span class="token function">PS</span>> <span class="token function">sleep</span> 3
</code></pre>
<ul>
  <li>GitBash (Git SDK) : <code>sleep</code>
    <ul>
      <li><code>/usr/bin/sleep</code> = <code>C:\git-sdk-64\usr\bin\sleep.exe</code></li>
      <li>当然ながら、WSL や Linux にも <code>sleep</code> コマンドがある</li>
    </ul>
  </li>
</ul>
<pre class="language-bash"><code class="language-bash">$ <span class="token function">sleep</span> <span class="token number">3</span>
</code></pre>
<p>以上～。色々試したけど、自分は<em>画面中央に表示される <code>msg</code></em> が一番良いかなと思った。BurntToast は画面右下になってしまうのと、インストールが必要なので、そこまでせんでもええかな、という気分。</p><div class="ad-rakuten">
  <div class="ad-rakuten-image">
    <a href="https://hb.afl.rakuten.co.jp/hgc/g00rd1d2.waxyc436.g00rd1d2.waxyde08/?pc=https%3A%2F%2Fitem.rakuten.co.jp%2Fbooxstore%2Fbk-4777519511%2F&amp;m=http%3A%2F%2Fm.rakuten.co.jp%2Fbooxstore%2Fi%2F12697179%2F">
      <img src="https://thumbnail.image.rakuten.co.jp/@0_mall/booxstore/cabinet/00768/bk4777519511.jpg?_ex=128x128">
    </a>
  </div>
  <div class="ad-rakuten-info">
    <div class="ad-rakuten-title">
      <a href="https://hb.afl.rakuten.co.jp/hgc/g00rd1d2.waxyc436.g00rd1d2.waxyde08/?pc=https%3A%2F%2Fitem.rakuten.co.jp%2Fbooxstore%2Fbk-4777519511%2F&amp;m=http%3A%2F%2Fm.rakuten.co.jp%2Fbooxstore%2Fi%2F12697179%2F">基礎からのシェルスクリプト 「Linux」「MacOS」「Windows」で使える「バッチ処理」！／萩原利男／IO編集部【3000円以上送料無料】</a>
    </div>
    <div class="ad-rakuten-shop">
      <a href="https://hb.afl.rakuten.co.jp/hgc/g00rd1d2.waxyc436.g00rd1d2.waxyde08/?pc=https%3A%2F%2Fwww.rakuten.co.jp%2Fbooxstore%2F&amp;m=http%3A%2F%2Fm.rakuten.co.jp%2Fbooxstore%2F">bookfan 1号店 楽天市場店</a>
    </div>
    <div class="ad-rakuten-price">価格 : 2090円</div>
  </div>
</div>
<div class="ad-amazon">
  <div class="ad-amazon-image">
    <a href="https://www.amazon.co.jp/dp/B07BD3JZJ8?tag=neos21-22&amp;linkCode=osi&amp;th=1&amp;psc=1">
      <img src="https://m.media-amazon.com/images/I/51AGBXdVhaL._SL160_.jpg" width="112" height="160">
    </a>
  </div>
  <div class="ad-amazon-info">
    <div class="ad-amazon-title">
      <a href="https://www.amazon.co.jp/dp/B07BD3JZJ8?tag=neos21-22&amp;linkCode=osi&amp;th=1&amp;psc=1">ファイル操作(バックアップ・リネーム)で身につける、コマンドプロンプト/バッチファイル入門: 嗚呼、素晴らしきはコマンドラインかな</a>
    </div>
  </div>
</div>

      </main>
      <footer id="footer">
        <div id="footer-contents">
          <div id="date-time">
            <dl>
              <dt>Created</dt>
              <dd><time>2022-01-27</time></dd>
              <dt>Last-Modified</dt>
              <dd><time>2022-01-27</time></dd>
            </dl>
          </div>
          <nav id="footer-links">
            <ul>
              <li id="footer-link-about"><a href="/about/index.html" title="About">About</a></li>
              <li id="footer-link-search"><a href="/about/search.html" title="Search">Search</a></li>
              <li id="footer-link-feeds"><a href="/feeds.xml" title="Feeds">Feeds</a></li>
              <li id="footer-link-github"><a href="https://github.com/Neos21/" title="GitHub">GitHub</a></li>
            </ul>
          </nav>
          <nav id="to-top"><a href="#" title="To Top"><span>▲ To Top</span></a></nav>
        </div>
      </footer>
    </div>
  </body>
</html>
