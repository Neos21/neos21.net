<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="theme-color" content="#0990d0">
    <!-- Google Search Console -->
    <meta name="google-site-verification" content="AvoEr3mUJFF2H_mPWWgShfmjBVP3ywRpyx9hxeeq2d4">
    <title>JS のみで Excel 風スプレッドシートが作れる Jexcel (Jspreadsheet) を試す - Neo's World</title>
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="/styles.css">
    <link rel="canonical" href="https://neos21.net/blog/2022/01/30-01.html">
    <link rel="search" type="application/opensearchdescription+xml" title="neos21.net" href="/opensearch.xml">
    <link rel="alternate" type="application/atom+xml" title="Feeds" href="/feeds.xml">
    <link rel="author" href="http://www.hatena.ne.jp/neos21/">
    <script src="/scripts.js"></script>
    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YMHFLZP1M1"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date());gtag('config','G-YMHFLZP1M1');gtag('config','UA-106501-1');</script>
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6475907504235292" crossorigin="anonymous"></script>
  </head>
  <body>
    <div id="container">
      <header id="header">
        <div id="header-brand">
          <div id="header-brand-contents">
            <div id="site-title"><a href="/index.html">Neo's World</a></div>
            <nav id="header-links">
              <ul>
                <li id="header-link-theme"><a href="#" title="Toggle Theme"><span>Toggle Theme</span></a></li>
                <li id="header-link-about"><a href="/about/index.html" title="About"><span>About</span></a></li>
                <li id="header-link-search"><a href="/about/search.html" title="Search"><span>Search</span></a></li>
                <li id="header-link-feeds"><a href="/feeds.xml" title="Feeds"><span>Feeds</span></a></li>
                <li id="header-link-to-bottom"><a href="#footer" title="To Bottom"><span>▼ To Bottom</span></a></li>
              </ul>
            </nav>
          </div>
        </div>
        <nav id="global-nav">
          <ul>
            <li><a href="/blog/index.html">Blog</a></li>
            <li><a href="/tech/index.html">Tech</a></li>
            <li><a href="/music/index.html">Music</a></li>
            <li><a href="/games/index.html">Games</a></li>
            <li><a href="/gallery/index.html">Gallery</a></li>
            <li><a href="/etc/index.html">Etc.</a></li>
          </ul>
        </nav>
        <nav id="path">
          <ul>
            <li><a href="/index.html">Neo's World</a></li>
            <li><a href="/blog/index.html">Blog</a></li>
            <li><a href="/blog/2022/index.html">2022年</a></li>
            <li><a href="/blog/2022/01/index.html">01月</a></li>
          </ul>
        </nav>
      </header>
      <main id="main">
        <div id="header-date"><time>2022-01-30</time></div>
        <h1 id="page-title">JS のみで Excel 風スプレッドシートが作れる Jexcel (Jspreadsheet) を試す</h1>

<p>Excel で作った表データを公開する時に、Google スプレッドシートで公開するのは何だかなー、HTML として公開できないかなーと思って調べたところ、<strong>Jexcel</strong> なるツールがあるとのことで、使ってみた。</p>
<ul>
  <li>参考 : <a href="https://paiza.hatenablog.com/entry/2020/06/10/JavaScript%E3%81%A0%E3%81%91%E3%81%A7Excel%E9%A2%A8%E3%81%AE%E3%82%B9%E3%83%97%E3%83%AC%E3%83%83%E3%83%89%E3%82%B7%E3%83%BC%E3%83%88%E3%82%92%E9%96%8B%E7%99%BA%E3%81%A7%E3%81%8D%E3%82%8B%E3%80%8CjExcel">JavaScriptだけでExcel風のスプレッドシートを開発できる「jExcel」を使ってみた！ - paiza開発日誌</a></li>
</ul>
<p>公式のリポジトリは以下っぽい。<em>Jspreadsheet CE</em> が正式名称？</p>
<ul>
  <li><a href="https://github.com/jspreadsheet/ce">jspreadsheet/ce: Jspreadsheet is a lightweight vanilla javascript plugin to create amazing web-based interactive tables and spreadsheets compatible with other spreadsheet software.</a></li>
</ul>
<p>公式リファレンスは以下。</p>
<ul>
  <li><a href="https://bossanova.uk/jspreadsheet/v4/">The javascript spreadsheet</a>
    <blockquote>
      <p>Jexcel has been renamed to Jspreadsheet.</p>
    </blockquote>
  </li>
</ul>
<p>…とのことで、現在は Jexcel ではなく Jspreadsheet と呼ぶのが正しいようだ。今気付いた。ｗ</p>
<p>npm でのインストールの他、React や Vue など SPA 向けの実装もあるが、今回は CDN から JS と CSS を読み込んで使う Vanilla なやり方をしてみた。</p>
<p>デモは以下のとおり。コードも見てみてほしい。</p>
<ul>
  <li>デモ : <a href="https://neos21.github.io/frontend-sandboxes/practice-jexcel/index.html">Practice jExcel</a></li>
  <li>コード : <a href="https://github.com/Neos21/frontend-sandboxes/blob/master/practice-jexcel/index.html">frontend-sandboxes/index.html at master · Neos21/frontend-sandboxes</a></li>
</ul>
<p>CDN から読み込むファイルは計4つ。</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://bossanova.uk/jspreadsheet/v4/jexcel.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://jsuites.net/v4/jsuites.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://bossanova.uk/jspreadsheet/v4/jexcel.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://jsuites.net/v4/jsuites.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>script</span><span class="token punctuation">></span></span>
</code></pre>
<p>jSuites というコンポーネントを組み合わせて UI を実現しているようだ。同じ作者っぽい。</p>
<ul>
  <li><a href="https://jsuites.net/v4/">jSuites | Javascript vanilla web components</a></li>
  <li><a href="https://github.com/jsuites/jsuites">jsuites/jsuites: jSuites is a collection of lightweight common required javascript web components. It is composed of fully responsive vanilla plugins to help you bring the best user experience to your projects, independent of the platform. Same JS codebase across different platforms.</a></li>
</ul>
<p>サンプルコードによると、データは2次元配列で指定するのが基本らしいが、JSON や CSV の他、連想配列での指定もできるようだ。良き。</p>
<ul>
  <li>参考 : <a href="https://bossanova.uk/jspreadsheet/v4/examples/import-data">Load data from CSV or JSON or XLSX</a></li>
</ul>
<p>カラム定義は柔軟にできて、カレンダーやカラーピッカーを使った指定だったり、ドロップダウンリストから選択するようなこともできる。</p>
<p>最初に渡したデータを <em>UI 上で書き換えられる</em>のも特徴。今回はそこまで試していないが、各種イベントや <code>persistance</code> (永続化) オプションを使えば、別途 API をコールして入力データを永続化したりもできそうだ。逆に、Read Only なセルにもできる。</p>
<ul>
  <li>参考 : <a href="https://bossanova.uk/jspreadsheet/v4/examples/events">Handling events on Jspreadsheet Example</a></li>
  <li>参考 : <a href="https://bossanova.uk/jspreadsheet/v4/docs/events">Handling events on Jspreadsheet Doc</a></li>
  <li>参考 : <a href="https://bossanova.uk/jspreadsheet/v4/cases/data-persistance">Data persistance</a></li>
</ul>
<p>地味にセルの結合もできたりする。色々と JS からプログラマブルに扱えるので、決まったデータを見せるだけの使い方から、自作の Google スプレッドシートもどきアプリも作れそうな勢い。</p><div class="ad-rakuten">
  <div class="ad-rakuten-image">
    <a href="https://hb.afl.rakuten.co.jp/hgc/g00q0722.waxyc9ff.g00q0722.waxyd017/?pc=https%3A%2F%2Fitem.rakuten.co.jp%2Fbook%2F16668887%2F&amp;m=http%3A%2F%2Fm.rakuten.co.jp%2Fbook%2Fi%2F20303990%2F">
      <img src="https://thumbnail.image.rakuten.co.jp/@0_mall/book/cabinet/8234/9784798168234.jpg?_ex=128x128">
    </a>
  </div>
  <div class="ad-rakuten-info">
    <div class="ad-rakuten-title">
      <a href="https://hb.afl.rakuten.co.jp/hgc/g00q0722.waxyc9ff.g00q0722.waxyd017/?pc=https%3A%2F%2Fitem.rakuten.co.jp%2Fbook%2F16668887%2F&amp;m=http%3A%2F%2Fm.rakuten.co.jp%2Fbook%2Fi%2F20303990%2F">極める。Excel デスクワークを革命的に効率化する［上級］教科書 [ きたみ あきこ ]</a>
    </div>
    <div class="ad-rakuten-shop">
      <a href="https://hb.afl.rakuten.co.jp/hgc/g00q0722.waxyc9ff.g00q0722.waxyd017/?pc=https%3A%2F%2Fwww.rakuten.co.jp%2Fbook%2F&amp;m=http%3A%2F%2Fm.rakuten.co.jp%2Fbook%2F">楽天ブックス</a>
    </div>
    <div class="ad-rakuten-price">価格 : 2728円</div>
  </div>
</div>
<div class="ad-amazon">
  <div class="ad-amazon-image">
    <a href="https://www.amazon.co.jp/dp/B08XZB3DPF?tag=neos21-22&amp;linkCode=osi&amp;th=1&amp;psc=1">
      <img src="https://m.media-amazon.com/images/I/41Fqm3KQtaL._SL160_.jpg" width="112" height="160">
    </a>
  </div>
  <div class="ad-amazon-info">
    <div class="ad-amazon-title">
      <a href="https://www.amazon.co.jp/dp/B08XZB3DPF?tag=neos21-22&amp;linkCode=osi&amp;th=1&amp;psc=1">極める。Excel デスクワークを革命的に効率化する［上級］教科書</a>
    </div>
  </div>
</div>

      </main>
      <footer id="footer">
        <div id="footer-contents">
          <div id="date-time">
            <dl>
              <dt>Created</dt>
              <dd><time>2022-01-30</time></dd>
              <dt>Last-Modified</dt>
              <dd><time>2022-01-30</time></dd>
            </dl>
          </div>
          <nav id="footer-links">
            <ul>
              <li id="footer-link-about"><a href="/about/index.html" title="About">About</a></li>
              <li id="footer-link-search"><a href="/about/search.html" title="Search">Search</a></li>
              <li id="footer-link-feeds"><a href="/feeds.xml" title="Feeds">Feeds</a></li>
              <li id="footer-link-github"><a href="https://github.com/Neos21/" title="GitHub">GitHub</a></li>
            </ul>
          </nav>
          <nav id="to-top"><a href="#" title="To Top"><span>▲ To Top</span></a></nav>
        </div>
      </footer>
    </div>
  </body>
</html>
