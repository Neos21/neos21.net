<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="theme-color" content="#0990d0">
    <!-- Google Search Console -->
    <meta name="google-site-verification" content="AvoEr3mUJFF2H_mPWWgShfmjBVP3ywRpyx9hxeeq2d4">
    <!-- Open Graph・Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Neo's World">
    <meta property="og:title" content="Raspberry Pi 4 に RetroPie を入れてレトロゲーをやってみる - Neo's World">
    <meta property="og:description" content="Raspberry Pi 4 に RetroPie を入れてレトロゲーをやってみる - Neo's World">
    <meta property="og:url" content="https://neos21.net/blog/2020/09/10-01.html">
    <meta property="og:image" content="https://neos21.net/ogp.png">
    <meta property="og:locale" content="ja_JP">
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:title" content="Raspberry Pi 4 に RetroPie を入れてレトロゲーをやってみる - Neo's World">
    <meta property="twitter:description" content="Raspberry Pi 4 に RetroPie を入れてレトロゲーをやってみる - Neo's World">
    <meta property="twitter:url" content="https://neos21.net/blog/2020/09/10-01.html">
    <meta property="twitter:image" content="https://neos21.net/ogp.png">
    <title>Raspberry Pi 4 に RetroPie を入れてレトロゲーをやってみる - Neo's World</title>
    <link rel="icon" href="/favicon.ico">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    <link rel="manifest" href="/manifest.webmanifest">
    <link rel="stylesheet" href="/styles.css">
    <link rel="canonical" href="https://neos21.net/blog/2020/09/10-01.html">
    <link rel="search" type="application/opensearchdescription+xml" title="neos21.net" href="/opensearch.xml">
    <link rel="alternate" type="application/atom+xml" title="Feeds" href="/feeds.xml">
    <link rel="author" href="http://www.hatena.ne.jp/neos21/">
    <script src="/scripts.js"></script>
    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YMHFLZP1M1"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date());gtag('config','G-YMHFLZP1M1');gtag('config','UA-106501-1');</script>
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6475907504235292" crossorigin="anonymous"></script>
  </head>
  <body>
    <div id="container">
      <header id="header">
        <div id="header-brand">
          <div id="header-brand-contents">
            <div id="site-title"><a href="/index.html">Neo's World</a></div>
            <nav id="header-links">
              <ul>
                <li id="header-link-theme"><a href="#" title="Toggle Theme"><span>Toggle Theme</span></a></li>
                <li id="header-link-about"><a href="/about/index.html" title="About"><span>About</span></a></li>
                <li id="header-link-search"><a href="/about/search.html" title="Search"><span>Search</span></a></li>
                <li id="header-link-feeds"><a href="/feeds.xml" title="Feeds"><span>Feeds</span></a></li>
                <li id="header-link-to-bottom"><a href="#footer" title="To Bottom"><span>▼ To Bottom</span></a></li>
              </ul>
            </nav>
          </div>
        </div>
        <nav id="global-nav">
          <ul>
            <li><a href="/blog/index.html">Blog</a></li>
            <li><a href="/tech/index.html">Tech</a></li>
            <li><a href="/music/index.html">Music</a></li>
            <li><a href="/games/index.html">Games</a></li>
            <li><a href="/gallery/index.html">Gallery</a></li>
            <li><a href="/etc/index.html">Etc.</a></li>
          </ul>
        </nav>
        <nav id="path">
          <ul>
            <li><a href="/index.html">Neo's World</a></li>
            <li><a href="/blog/index.html">Blog</a></li>
            <li><a href="/blog/2020/index.html">2020年</a></li>
            <li><a href="/blog/2020/09/index.html">09月</a></li>
          </ul>
        </nav>
      </header>
      <main id="main">
        <div id="header-date"><time>2020-09-10</time></div>
        <h1 id="page-title">Raspberry Pi 4 に RetroPie を入れてレトロゲーをやってみる</h1>

<p>Raspberry Pi 4 の RAM 4GB モデルを買ったものの、用途が思い付かずほったらかしになっていた。巷では RG350M とか RK2020 とかいう、エミュレータを搭載した Linux ポータブルゲーム機が流行っているらしく、ラズパイで似たようなことができないかと思い、今回 <strong>RetroPie</strong> を入れてみることにした。</p>
<h2 id="目次"><a class="header-link" href="#目次"><span class="header-link-mark"></span></a>目次</h2>
<ul>
  <li><a href="#retropie-%E3%81%A8%E3%81%AF">RetroPie とは</a></li>
  <li><a href="#retropie-%E3%82%92%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E3%81%99%E3%82%8B">RetroPie をインストールする</a>
    <ul>
      <li><a href="#samba-%E3%82%92%E6%9C%89%E5%8A%B9%E5%8C%96%E3%81%99%E3%82%8B">Samba を有効化する</a></li>
    </ul>
  </li>
  <li><a href="#retropie-%E3%81%AE%E8%B5%B7%E5%8B%95%E6%96%B9%E6%B3%95%E3%82%92%E8%A8%AD%E5%AE%9A%E3%81%99%E3%82%8B">RetroPie の起動方法を設定する</a></li>
  <li><a href="#emulationstation-%E3%81%AF%E5%88%9D%E5%9B%9E%E8%B5%B7%E5%8B%95%E6%99%82%E3%81%AE%E6%93%8D%E4%BD%9C%E3%81%AB%E6%B3%A8%E6%84%8F">EmulationStation は初回起動時の操作に注意</a></li>
  <li><a href="#%E9%81%8A%E3%82%93%E3%81%A7%E3%81%BF%E3%81%9F%E6%84%9F%E3%81%98">遊んでみた感じ</a></li>
  <li><a href="#n64-%E3%81%AF%E5%AE%9F%E7%94%A8%E3%81%AB%E9%81%94%E3%81%97%E3%81%AA%E3%81%84">N64 は実用に達しない</a></li>
  <li><a href="#%E4%BB%A5%E4%B8%8A">以上</a></li>
  <li><a href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE">参考文献</a></li>
</ul>
<h2 id="retropie-とは"><a class="header-link" href="#retropie-とは"><span class="header-link-mark"></span></a>RetroPie とは</h2>
<ul>
  <li><a href="https://retropie.org.uk/">RetroPie - Retro-gaming on the Raspberry Pi</a></li>
</ul>
<p>RetroPie は、Raspbian OS 上に複数ハードのエミュレータ一式を導入できるツール。</p>
<p>本来、ゲームのエミュレータは個別に開発がされていて統一感がないワケだが、ユーザと各エミュレータの間を取り持つ <strong>RetroArch</strong> という仕組みがあり、コレが UI を統一してくれている。</p>
<ul>
  <li>参考 : <a href="http://domisan.sakura.ne.jp/article/retroarch/retroarch.html">マルチエミュレータシステム『RetroArch』</a></li>
</ul>
<p>RetroArch が提供するホーム画面は PlayStation 風のモノになっていて、ココから全体設定をしたり、ハードを選択してゲームを開始したりできる。</p>
<p>しかし RetroArch のホーム画面はキーボード操作が前提になっていて扱いづらい場合もある。そこで RetroPie では、<em>EmulationStation</em> というフロントエンドを用意していて、コチラはジョイパッド (コントローラ) で操作できる UI を提供している。</p>
<p>RetroPie は、これら RetroArch と EmulationStation を統合してインストールできる仕組みだ。</p>
<h2 id="retropie-をインストールする"><a class="header-link" href="#retropie-をインストールする"><span class="header-link-mark"></span></a>RetroPie をインストールする</h2>
<p>本稿執筆時点の RetroPie は v4.6 になっていて、Raspberry Pi 4 に正式対応したバージョンになっている。</p>
<ul>
  <li>参考 : <a href="https://retropie.org.uk/2020/04/retropie-4-6-released-with-raspberry-pi-4-support/">RetroPie 4.6 released with Raspberry Pi 4 support. - RetroPie</a></li>
  <li>参考 : <a href="https://daily-gadget.net/2020/05/11/post-14834/">マルチプラットフォームエミュレータ「RetroPie」がラズパイ4に対応【ラズパイをMSXにしようか】</a></li>
</ul>
<p>GitHub に用意されているセットアップ用プロジェクトを使ってインストールを進めていく。以下、ラズパイ4のターミナルで作業。</p>
<ul>
  <li><a href="https://github.com/RetroPie/RetroPie-Setup">GitHub - RetroPie/RetroPie-Setup: Shell script to set up a Raspberry Pi/Odroid/PC with RetroArch emulator and various cores</a></li>
</ul>
<pre class="language-bash"><code class="language-bash"><span class="token comment"># 各種パッケージを更新しておく</span>
$ <span class="token function">sudo</span> <span class="token function">apt-get</span> update
$ <span class="token function">sudo</span> <span class="token function">apt-get</span> dist-upgrade -y

<span class="token comment"># Git が未導入であればインストールする</span>
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> -y <span class="token function">git</span>

<span class="token comment"># 任意のディレクトリに移動し、セットアッププロジェクトを取得する</span>
$ <span class="token builtin class-name">cd</span> ~/
$ <span class="token function">git</span> clone --depth<span class="token operator">=</span><span class="token number">1</span> https://github.com/RetroPie/RetroPie-Setup.git
$ <span class="token builtin class-name">cd</span> RetroPie-Setup/

<span class="token comment"># セットアップスクリプトを起動する</span>
$ <span class="token function">sudo</span> ./retropie_setup.sh
</code></pre>
<p>古い文献では、ラズパイ4向けの開発ブランチに <code>git checkout fkms_rpi4</code> するような記述も見られたが、現在はそのようなブランチはなくなっており、<code>master</code> ブランチを使用して問題ない。</p>
<p>セットアップスクリプトを起動すると <em>TUI</em> が表示される。初回は</p>
<ul>
  <li><code>Basic Install</code></li>
</ul>
<p>を選択し、フルインストールされるのをしばし待つ。</p>
<p><strong>フルインストールが終わると同じ TUI 画面に戻ってくる</strong>。特に他に設定がなければ終了する。</p>
<h3 id="samba-を有効化する"><a class="header-link" href="#samba-を有効化する"><span class="header-link-mark"></span></a>Samba を有効化する</h3>
<p>ラズパイに ROM ファイルを持ち込んだりする時に、Samba でディレクトリ共有しておくと楽だろう。RetroPie には Samba をセットアップする機能も用意されているので、お好みで有効化しておこう。</p>
<p><code>retropie_setup.sh</code> の TUI で <code>Configuration / tools</code> を選択し、次の画面から <code>samba - Configure Samba ROM Shares</code> を選択する。そして <code>Install RetroPie Samba shares</code> を選択すれば、Samba と共有ディレクトリの設定が一気に行われる。</p>
<ul>
  <li>参考 : <a href="https://raspida.com/transfer1-samba">RetroPieへsambaを使ったROM転送の方法(1)</a></li>
</ul>
<h2 id="retropie-の起動方法を設定する"><a class="header-link" href="#retropie-の起動方法を設定する"><span class="header-link-mark"></span></a>RetroPie の起動方法を設定する</h2>
<p>RetroPie (実際は EmulationStation の UI) をどのように起動するかを設定できる。</p>
<p>Raspbian OS の起動画面をすっ飛ばして、いきなり RetroPie を開くようにすれば、ラズパイをゲーム専用機にできる。たまにゲームがしたいだけなら、今までどおり Raspbian OS のデスクトップが開くように設定できる。</p>
<p><code>retropie_setup.sh</code> の TUI で <code>Configuration / tools</code> を選択し、次の画面から <code>autostart</code> を選択する。次の画面で、</p>
<ul>
  <li><code>Start EmulationStart at boot</code></li>
</ul>
<p>を選択すればいきなり RetroPie が開く挙動になるし、</p>
<ul>
  <li><code>Boot to desktop (auto login as pi)</code></li>
</ul>
<p>を選択すれば <code>pi</code> ユーザでログインした状態で Raspbian OS のデスクトップが開く挙動になる。</p>
<p><strong>手動で RetroPie を立ち上げる際は、ターミナルで <code>$ emulationstation</code> と打ち込めば EmulationStation が起動する。</strong></p>
<ul>
  <li>参考 : <a href="https://nekoz.exblog.jp/27910830/">Raspberry pi 4にRaspbianを入れてRetroPieをインストールする その2 : ねこzなBlog</a></li>
</ul>
<p>各種設定が終わったら TUI を終了し、一度再起動をかけておくと良いだろう。</p>
<h2 id="emulationstation-は初回起動時の操作に注意"><a class="header-link" href="#emulationstation-は初回起動時の操作に注意"><span class="header-link-mark"></span></a>EmulationStation は初回起動時の操作に注意</h2>
<p>セットアップが完了したら、EmulationStation を起動してみる。初回はコントローラの設定があり、<em>ココの操作が戸惑うので注意して操作する。</em></p>
<p>今回はとりあえずキーボードで初期設定を行うことにする。</p>
<p>EmulationStation が起動したら、初回は「Welcome」画面が開くはず。</p>
<blockquote>
  <p>No gamepads detected</p>
  <p>Hold a button on your device to configure it.<br>Press F4 to quit at any time.</p>
</blockquote>
<p>と表示されていると思うので、キーボードの何らかのキーを長押しして、キーボードを選択する。</p>
<p>次に「Configuring」画面に移動したら、<strong>ココからの操作は慎重に行う。</strong></p>
<p>D-Pad (十字キー) の上から順に、押下したキーが適用される。途中での訂正が効かず、間違えても一旦最後まで設定し終えないといけないので慎重に設定していく。</p>
<p>ひととおりの設定が完了したら、設定したキーに応じて、<em>十字キーの上下で項目移動</em>、<strong>「OK」ボタンの選択は A ボタン</strong>で行うことになる。「A ボタンに設定したキー」を押下しないと「OK」が押せないのが罠。適当に Enter や Space キーを押して反応しなくてしばらくつまづいた。</p>
<ul>
  <li>参考 : <a href="http://memotoreboot.o-oi.net/raspberrypi_retropie/180801_03">Raspbian Stretch Lite から RetroPieをインストール その⒊｜Raspberrypi-RetroPie｜おっさん。メモっと！ リブート</a></li>
  <li>参考 : <a href="https://dirtmishouri.blogspot.com/2018/05/raspberry-pi_23.html">Raspberry Pi アーケードゲームレトロコンソールの初期設定・コントローラー設定について:Aliexpressで買ったもの</a></li>
</ul>
<p>設定を終えて「OK」ボタンを押せば、RetroPie のホーム画面に移動するはずだ。</p>
<p>ROM を何も用意していないと、何のハードも選択できないはずなので、Samba を経由したりして ROM を指定のディレクトリに入れよう。</p>
<h2 id="遊んでみた感じ"><a class="header-link" href="#遊んでみた感じ"><span class="header-link-mark"></span></a>遊んでみた感じ</h2>
<p>自分は GB・GBC・GBA・FC (NES)・SFC (SNES)・N64 の ROM を入れて少し遊んでみた。</p>
<p><em>N64 以外はほぼ遅延もなく快適に遊べた</em>。VNC でリモート操作してみたのだが、それでもスーファミ程度ならほとんど遅延がなく、シビアなアクションゲームでなければリモートでも遊べちゃいそうなレベルだった。</p>
<p>まぁ GPU がない普通のノート PC でもスーファミレベルなら問題なく遊べる時代なので、ラズパイ4ならこのくらいサクサク動くのは当たり前かなー、という感じ。</p>
<h2 id="n64-は実用に達しない"><a class="header-link" href="#n64-は実用に達しない"><span class="header-link-mark"></span></a>N64 は実用に達しない</h2>
<p>問題は N64 だった。動きがカクカクで、遊べたもんじゃない。どうやらラズパイのハード性能的に限界らしい。</p>
<ul>
  <li>参考 : <a href="https://www.reddit.com/r/RetroPie/comments/gbswyu/retropie_on_raspberry_pi_4_4gb_is_running_slower/">RetroPie on Raspberry Pi 4 4GB is running slower than expected? : RetroPie</a>
    <ul>
      <li>N64 の動作遅くね？という投稿</li>
    </ul>
  </li>
  <li>参考 : <a href="https://retropie.org.uk/docs/Optimization-for-Nintendo-64/">Optimization for Nintendo 64 - RetroPie Docs</a>
    <ul>
      <li>RetroPie 公式が解説している N64 のエミュレーションの難しさ</li>
    </ul>
  </li>
  <li>参考 : <a href="https://www.reddit.com/r/RetroPie/comments/6se5nj/why_n64_emulation_on_the_pi_isnt_so_great_from_a/">Why N64 emulation on the Pi isn't so great (from a developer) : RetroPie</a>
    <ul>
      <li>RetroPie に搭載されている N64 エミュレータ「Mupen64Plus」の開発者がさらなる詳細を説明している</li>
      <li>OpenGL ES2 というモバイル版の限界、ラズパイが ARM CPU であることが原因だとか</li>
    </ul>
  </li>
  <li>参考 : <a href="https://www.reddit.com/r/RetroPie/comments/6jmj95/retropie_setup_guide_new_n64_compatibility_sheet/">RetroPie Setup Guide + New N64 Compatibility Sheet : RetroPie</a>
    <ul>
      <li>N64 のソフトごとの動作状況一覧</li>
    </ul>
  </li>
</ul>
<p>N64 のエミュレートは RK2020 が対応しているようだが、RK2020 は画面が小さすぎてどうだかなーという感じ。本当に遊びたいなら PC で遊ぶか…。ｗ</p>
<h2 id="以上"><a class="header-link" href="#以上"><span class="header-link-mark"></span></a>以上</h2>
<p>RetroPie v4.6 はラズパイ4へのインストールも簡単で、スーファミ世代ぐらいまでのゲームであれば何のチューニングもせずに快適にプレイできることが分かった。</p>
<p>ラズパイにモバブーと小型液晶とジョイパッドを繋ぎ、レトロゲームを楽しむとしよう。</p>
<h2 id="参考文献"><a class="header-link" href="#参考文献"><span class="header-link-mark"></span></a>参考文献</h2>
<ul>
  <li><a href="https://dirtmishouri.blogspot.com/2020/01/raspberry-pi-4-model-bretropieraspberry.html">Raspberry Pi 4 Model BにRetroPieをインストールしたらRaspberry pi 3 model B+ではカクカクしてたゲームもちゃんと動いた件:Aliexpressで買ったもの</a></li>
  <li><a href="https://eagle0wl.hatenadiary.jp/entry/2016/08/30/215322">Raspberry Pi 2B に RetroPie 4.0 を導入する その1 概要 - ど～もeagle0wlです（再）</a></li>
  <li><a href="https://wireless-network.net/raspi-n64-ps3controller/">【RaspberryPi３B+】Nintendo64のゲームをPS3のコントローラで遊ぶ方法 | LoT ラブオンテック</a></li>
</ul>

      </main>
      <footer id="footer">
        <div id="footer-contents">
          <div id="date-time">
            <dl>
              <dt>Created</dt>
              <dd><time>2020-09-10</time></dd>
              <dt>Last-Modified</dt>
              <dd><time>2020-09-10</time></dd>
            </dl>
          </div>
          <nav id="footer-links">
            <ul>
              <li id="footer-link-about"><a href="/about/index.html" title="About">About</a></li>
              <li id="footer-link-search"><a href="/about/search.html" title="Search">Search</a></li>
              <li id="footer-link-feeds"><a href="/feeds.xml" title="Feeds">Feeds</a></li>
              <li id="footer-link-github"><a href="https://github.com/Neos21/" title="GitHub">GitHub</a></li>
            </ul>
          </nav>
          <nav id="to-top"><a href="#" title="To Top"><span>▲ To Top</span></a></nav>
        </div>
      </footer>
    </div>
  </body>
</html>
