<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="theme-color" content="#0990d0">
    <!-- Google Search Console -->
    <meta name="google-site-verification" content="AvoEr3mUJFF2H_mPWWgShfmjBVP3ywRpyx9hxeeq2d4">
    <title>Excel 個人的ノウハウ・定石集 - Neo's World</title>
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="/styles.css">
    <link rel="canonical" href="https://neos21.net/blog/2018/02/20-01.html">
    <link rel="search" type="application/opensearchdescription+xml" title="neos21.net" href="/opensearch.xml">
    <link rel="alternate" type="application/atom+xml" title="Feeds" href="/feeds.xml">
    <link rel="author" href="http://www.hatena.ne.jp/neos21/">
    <script src="/scripts.js"></script>
    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YMHFLZP1M1"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date());gtag('config','G-YMHFLZP1M1');gtag('config','UA-106501-1');</script>
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6475907504235292" crossorigin="anonymous"></script>
  </head>
  <body>
    <div id="container">
      <header id="header">
        <div id="header-brand">
          <div id="header-brand-contents">
            <div id="site-title"><a href="/index.html">Neo's World</a></div>
            <nav id="header-links">
              <ul>
                <li id="header-link-theme"><a href="#" title="Toggle Theme"><span>Toggle Theme</span></a></li>
                <li id="header-link-about"><a href="/about/index.html" title="About"><span>About</span></a></li>
                <li id="header-link-search"><a href="/about/search.html" title="Search"><span>Search</span></a></li>
                <li id="header-link-feeds"><a href="/feeds.xml" title="Feeds"><span>Feeds</span></a></li>
                <li id="header-link-to-bottom"><a href="#footer" title="To Bottom"><span>▼ To Bottom</span></a></li>
              </ul>
            </nav>
          </div>
        </div>
        <nav id="global-nav">
          <ul>
            <li><a href="/blog/index.html">Blog</a></li>
            <li><a href="/tech/index.html">Tech</a></li>
            <li><a href="/music/index.html">Music</a></li>
            <li><a href="/games/index.html">Games</a></li>
            <li><a href="/gallery/index.html">Gallery</a></li>
            <li><a href="/etc/index.html">Etc.</a></li>
          </ul>
        </nav>
        <nav id="path">
          <ul>
            <li><a href="/index.html">Neo's World</a></li>
            <li><a href="/blog/index.html">Blog</a></li>
            <li><a href="/blog/2018/index.html">2018年</a></li>
            <li><a href="/blog/2018/02/index.html">02月</a></li>
          </ul>
        </nav>
      </header>
      <main id="main">
        <div id="header-date"><time>2018-02-20</time></div>
        <h1 id="page-title">Excel 個人的ノウハウ・定石集</h1>

<p>Excel で設計書やテスト仕様書を書いてもらう機会が出てきて、「エクセルマスター」の弟子だった僕としては我慢ならない汚さのブックばかりでゲンナリしている。そこで、僕が蓄えてきた Excel に関するノウハウを書き出してみる。</p>
<h2 id="目次"><a class="header-link" href="#目次"><span class="header-link-mark"></span></a>目次</h2>
<ul>
  <li><a href="#excel-%E3%81%AE%E4%BB%95%E6%A7%98%E3%82%92%E8%80%83%E6%85%AE%E3%81%97%E3%81%9F%E3%83%8E%E3%82%A6%E3%83%8F%E3%82%A6">Excel の仕様を考慮したノウハウ</a></li>
  <li><a href="#%E5%88%86%E3%81%8B%E3%82%8A%E3%82%84%E3%81%99%E3%81%84-excel-%E3%83%89%E3%82%AD%E3%83%A5%E3%83%A1%E3%83%B3%E3%83%88%E3%81%AB%E3%81%99%E3%82%8B%E3%81%9F%E3%82%81%E3%81%AE%E3%83%8E%E3%82%A6%E3%83%8F%E3%82%A6">分かりやすい Excel ドキュメントにするためのノウハウ</a></li>
  <li><a href="#%E4%BB%A5%E4%B8%8A">以上</a></li>
</ul>
<h2 id="excel-の仕様を考慮したノウハウ"><a class="header-link" href="#excel-の仕様を考慮したノウハウ"><span class="header-link-mark"></span></a>Excel の仕様を考慮したノウハウ</h2>
<p>「Excel ってこういうところあるからね…」という仕様を考慮して、こんな風に工夫しましょう、という。</p>
<ul>
  <li>フォント等の書式は「全選択」で変更するのではなく、ブック全体のスタイル設定から直す
    <ul>
      <li>「全選択」でそのシートの全体だけ直しても、ブック全体の既定のスタイルは直せていないので、新規シートを作った時のスタイルが直らない</li>
    </ul>
  </li>
  <li>新規作成するファイルの書式はオプションから「既定のフォント」を決めておく</li>
  <li>ついでに「新規作成時のシート数」を「1」にしておき、空のシートを残さないようにする
    <ul>
      <li>空のシートがあると「何か意味があるのか」と読み手に不要な推測をさせてしまう。<em>読み手に無配慮なモノを残さない・作らない</em></li>
    </ul>
  </li>
  <li>セル幅・高さの「自動調整」ができなくなるので、<em>「セルの結合 + 折り返して表示」なセルを作らない</em>
    <ul>
      <li>エクセル方眼紙の弊害の一つといえるかも</li>
      <li>そもそも「セル結合」は見出し行ぐらいにしか使わないようにしたい</li>
    </ul>
  </li>
  <li>プロポーショナルフォントは「メイリオ」を使う
    <ul>
      <li>例の「印刷プレビュー時にフォントの大きさがちょっと変わる」問題の基本対策
        <ul>
          <li><a href="/blog/2016/01/22-01.html">【根本解決方法はなし】Excel で印刷プレビューすると文字切れが発生する件の原因と対策</a></li>
        </ul>
      </li>
      <li>MS P ゴシックだと印刷時に文字切れが起こる場合が多いが、メイリオは印刷するとむしろ余裕ができる方なので印刷ミスが発生しにくい</li>
      <li>メイリオは全角文字が等幅なので、半角文字の混在が少ない場合は特に等幅フォントチックに扱いやすい</li>
      <li>游ゴシックより文字が太めで読みやすい</li>
    </ul>
  </li>
  <li>「条件付き書式」は行列の挿入時に定義が分裂してゴミが増えるので、「<strong>コピーしたセルの挿入</strong>」で条件付き書式の範囲内に行列を追加するようにする
    <ul>
      <li>最終行の次の行に「コピーしたセルの挿入」で貼り付けると分裂する。最終行の下に行を増やしたいのであれば、最終行の1つ上の行をコピーし、その行と最終行の間に「コピーしたセルの挿入」で行追加すると良い。条件付き書式の範囲を、範囲の中から押し広げるイメージ…</li>
      <li>それでも誰かが壊すので定期的に条件付き書式一覧を見直して整理する</li>
      <li>(というのも鬱陶しいし、マクロで自動生成もダルいので、なるべく使わないで済むようにしたい)</li>
    </ul>
  </li>
  <li>今更 <code>.xls</code> で作らない。<code>.xlsx</code> で作る
    <ul>
      <li><code>.xls</code> より <code>.xlsx</code> の方がファイルサイズが小さく済む</li>
    </ul>
  </li>
  <li>「入力規則」の「リスト」を作る時は、値を直接入れるのではなく、「マスタ」シートを作り、選択肢リストを作って「名前定義」しておき、その名前定義でリストを指定するようにする
    <ul>
      <li>値を直接入れてしまうと選択肢の増減時に面倒</li>
      <li>セル範囲指定も同様の理由で増減に弱いので、名前定義を利用する</li>
      <li>「マスタ」シートは非表示にでもしておけば良い</li>
    </ul>
  </li>
  <li>連番を振る時、単純に <code>ROW()</code> を使うと、ヘッダの行数が変わった時に影響を受ける。<strong>変更に強い数式</strong>を使うことが大切
    <ul>
      <li>以前、変更に強い連番を振るための数式を紹介したので、ソチラをドウゾ。</li>
      <li><a href="/blog/2016/01/26-01.html">Excel で空行やセル結合が混じっても連番を振る関数</a></li>
    </ul>
  </li>
  <li>ローカルの別ファイルへのリンクは「ハイパーリンクの作成」を使うと壊れやすいので、<strong><code>HYPERLINK</code> 関数</strong>で書く
    <ul>
      <li>リンクパスだけ書く列を作っておき、隣の列に <code>=HYPERLINK(【隣のセル】, "リンク")</code> みたいな数式を仕込んでおけば手間が省ける</li>
    </ul>
  </li>
  <li>罫線は隣接する両方のセルが別々にセル定義を持っている。異なる種類の罫線を指定する時は扱い方に注意
    <ul>
      <li>たとえば2列の間の罫線を太枠とかにしたい時、僕がやるなら、<em>2列選択した状態で「セルの書式設定」の「罫線」タブを開き、「列間の罫線」の指定だけを太枠に変更する</em>。こうすれば「左列の右罫線は太字」「右列の左罫線も太字」になり、データが綺麗</li>
      <li>「片方の列が通常の罫線、隣接するもう片方の列が太枠」みたいな状態だと、列操作などをしている間に気持ち悪い罫線が出てくることがある</li>
    </ul>
  </li>
  <li>文字列をコピペする時、単純にセルごとコピペすると罫線周りのスタイル崩れなどが起こりやすいので、「形式を指定して貼り付け」から「<strong>値のみを貼り付け</strong>」を利用する
    <ul>
      <li>同様に、書式だけをコピペしたい時は「<em>書式のみを貼り付け</em>」を使う</li>
      <li>「値のみ貼り付け」「書式のみ貼り付け」は<strong>クイックアクセスツールバー</strong>に追加できるので、<code>Ctrl + V</code> を使う癖を止める</li>
    </ul>
  </li>
  <li>エクセル方眼紙を強いられていて、方眼紙のコントロールが厳しい時は「<em>カメラ</em>」を使う
    <ul>
      <li>別シートの内容を図のように貼り付けられるので、ヘッダとか作る時に有用</li>
    </ul>
  </li>
</ul>
<p>こういった、Excel の仕様を押さえたドキュメントづくりは、データや体裁を綺麗に保つためにも必要なのだが、無知な人に操作されると一気に壊されるので、チーム内でスキルの底上げをしておきたい。</p>
<h2 id="分かりやすい-excel-ドキュメントにするためのノウハウ"><a class="header-link" href="#分かりやすい-excel-ドキュメントにするためのノウハウ"><span class="header-link-mark"></span></a>分かりやすい Excel ドキュメントにするためのノウハウ</h2>
<p>Excel の仕様というよりは、「Excel を使っているとこういう作りにしがちだけど、あんまよくないよ」というノウハウ。</p>
<ul>
  <li>文字色、セル背景色など、「色」だけで何かを説明した気にならない
    <ul>
      <li>その色分けにどんな「規則」「意図」があったのか、作成者しか分からなくなる</li>
      <li>白黒印刷した時に意味が分からなくなる</li>
      <li>必ず記号や凡例、「大見出し」行を作るなどして、色を付けなくても同じだけの理解が得られる状態にする</li>
    </ul>
  </li>
  <li>「空欄」で何かを説明した気にならない
    <ul>
      <li>空欄は「未入力」なのか「書き忘れ」なのか「何もなかった結果」なのか判断が付かない</li>
      <li>空であることを示すなら、ハイフン「-」などを明記する (当然、記号を使う時は凡例を書いておく)</li>
    </ul>
  </li>
  <li>シート名を書く
    <ul>
      <li>「Sheet1」では何のためのシートか分からない</li>
      <li>シートが1つしかなくても必ず「タイトル」は書く</li>
      <li>タイトルを書く癖がないと、文書全体の方向性を正しく定められない</li>
      <li>当然だけどブック名も中身が分かるようにタイトル付けしようね</li>
    </ul>
  </li>
  <li>表には No. を振る
    <ul>
      <li>読んでいる時に、今見ていた行を迷いにくくするための目印・インデックスとして</li>
      <li>「数」に関する情報は目に見えるように書いておく</li>
      <li>連番ミスを起こさないよう、前述の数式などを利用する</li>
    </ul>
  </li>
  <li>垂直方向は<em>上揃え</em>にしておいた方が、1行の各列を読んでいく時に文章の開始位置の目線が揃って読みやすい
    <ul>
      <li>デフォルトだと垂直中央揃えだと思うが、折り返し表示するセルが途中にあったりすると、文章の1行目の位置が上下にズレて落ち着きがない</li>
      <li>Mac 版の Excel だと下揃えがデフォルトっぽいが、下揃えにメリットなし</li>
    </ul>
  </li>
  <li>印刷する時は、ブック名とページ番号を必ず印刷する
    <ul>
      <li>あとで書類が混ざった時に必ず混乱する</li>
      <li>手元にある書類だけで間違いない状態に戻せるよう、必要な情報は明記 (印刷) する</li>
    </ul>
  </li>
  <li>集計や計算を行う時は、1シート・1セルで一気に答えを出そうとしない
    <ul>
      <li>Excel のデフォルトで、新規作成時に3シート作られるのは「入力」「変換」「出力」をシート別に行ってもらうため</li>
      <li>元データには手を加えず、加工する行程ごとにシートを分けて、セル参照やピポッドテーブルを利用して作る</li>
      <li>そうすると、計算誤りがあった時の見直しや、特例的なデータへの対応がしやすい</li>
      <li>元データや計算過程を分かりやすく残しておく、つまり、<strong>別の人が検算・レビューしやすくしておくこと</strong>も大事</li>
    </ul>
  </li>
  <li>日付の書式設定は <code>yyyy-mm-dd</code> にする
    <ul>
      <li>デフォルトだと <code>yyyy/m/d</code> だと思う。コレだと月や日が1桁の時と2桁の時とで、表示される桁数にバラつきが出る (<code>2018/1/5</code>・<code>2018/12/10</code> みたいな)。そういうデータが縦に並ぶと読みづらい</li>
      <li>そこで、<em>0 パディング</em>するために <code>yyyy/mm/dd</code> とか <code>yyyy-mm-dd</code> のように自分で書式を変更する。<code>2018/01/05</code> のように年月日の表示桁数を固定しておくと読みやすい</li>
      <li><em>アラインメント</em>の感覚大事</li>
    </ul>
  </li>
</ul>
<p>文章の書き方、データのまとめ方、スタイリングの仕方。そうした「センス」は、イコール「知識量」。指摘を食らう人は単純にインプットする知識量が少ないために、アウトプットするモノの「センスが悪い」のだ。</p>
<p>「書き手」の意識に終始しているから気付けない。共有フォルダにある他人が作った書類は勝手に読むとかして、「読み手」になる機会を増やして、グッドプラクティス・バッドノウハウを増やしていくことが大事。</p>
<p>その上で、作るモノには「一定の規則・統一性」を持たせること。シートごとにフォントや表の構成が違ったりすると、書き手としては良かれと思ってそうしたことでも、読み手としては「さっきと違うモノ」をゼロから認識し直す必要が出てくるので、読みづらくなる。個々の見栄えをそれぞれ考えて調整するよりは、全体の体裁を揃える方に重きを置いた方が良い。</p>
<h2 id="以上"><a class="header-link" href="#以上"><span class="header-link-mark"></span></a>以上</h2>
<p>そもそも、Excel は「文書」を作るモノではないので、あまり「ドキュメント」として凝ったモノを作ろうとすること自体が間違い。</p>
<p>表計算ソフトで何かを計算するということは、その計算している表自体の見栄えというより、<em>「計算した結果から導かれる情報」の方が大事</em>なはずだ。だから、あまり見栄えを気にするのではなく、「計算した結果何が分かったか」というところだけきちんと表現するに留め、その他の文書は Word で書いた方が良いと思っている。</p>
<p>そうはいっても Excel 方眼紙はなくならんじゃろ、きっと…。</p>

      </main>
      <footer id="footer">
        <div id="footer-contents">
          <div id="date-time">
            <dl>
              <dt>Created</dt>
              <dd><time>2018-02-20</time></dd>
              <dt>Last-Modified</dt>
              <dd><time>2018-02-20</time></dd>
            </dl>
          </div>
          <nav id="footer-links">
            <ul>
              <li id="footer-link-about"><a href="/about/index.html" title="About">About</a></li>
              <li id="footer-link-search"><a href="/about/search.html" title="Search">Search</a></li>
              <li id="footer-link-feeds"><a href="/feeds.xml" title="Feeds">Feeds</a></li>
              <li id="footer-link-github"><a href="https://github.com/Neos21/" title="GitHub">GitHub</a></li>
            </ul>
          </nav>
          <nav id="to-top"><a href="#" title="To Top"><span>▲ To Top</span></a></nav>
        </div>
      </footer>
    </div>
  </body>
</html>
