<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="theme-color" content="#0990d0">
    <!-- Google Search Console -->
    <meta name="google-site-verification" content="AvoEr3mUJFF2H_mPWWgShfmjBVP3ywRpyx9hxeeq2d4">
    <title>ngx-onsenui を使って Angular6 + OnsenUI + Cordova なプロジェクトを立ち上げてみる - Neo's World</title>
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="/styles.css">
    <link rel="canonical" href="https://neos21.net/blog/2018/10/09-03.html">
    <link rel="search" type="application/opensearchdescription+xml" title="neos21.net" href="/opensearch.xml">
    <link rel="alternate" type="application/atom+xml" title="Feeds" href="/feeds.xml">
    <link rel="author" href="http://www.hatena.ne.jp/neos21/">
    <script defer src="/scripts.js"></script>
    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YMHFLZP1M1"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date());gtag('config','G-YMHFLZP1M1');gtag('config','UA-106501-1');</script>
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6475907504235292" crossorigin="anonymous"></script>
  </head>
  <body>
    <div id="container">
      <header id="header">
        <div id="header-brand">
          <div id="header-brand-contents">
            <div id="site-title"><a href="/index.html">Neo's World</a></div>
            <nav id="header-links">
              <ul>
                <li id="header-link-about"><a href="/about/index.html" title="About"><span>About</span></a></li>
                <li id="header-link-search"><a href="/about/search.html" title="Search"><span>Search</span></a></li>
                <li id="header-link-feeds"><a href="/feeds.xml" title="Feeds"><span>Feeds</span></a></li>
                <li id="header-link-to-bottom"><a href="#footer" title="To Bottom"><span>▼ To Bottom</span></a></li>
              </ul>
            </nav>
          </div>
        </div>
        <nav id="global-nav">
          <ul>
            <li><a href="/blog/index.html">Blog</a></li>
            <li><a href="/tech/index.html">Tech</a></li>
            <li><a href="/music/index.html">Music</a></li>
            <li><a href="/games/index.html">Games</a></li>
            <li><a href="/gallery/index.html">Gallery</a></li>
            <li><a href="/etc/index.html">Etc.</a></li>
          </ul>
        </nav>
        <nav id="path">
          <ul>
            <li><a href="/index.html">Neo's World</a></li>
            <li><a href="/blog/index.html">Blog</a></li>
            <li><a href="/blog/2018/index.html">2018年</a></li>
            <li><a href="/blog/2018/10/index.html">10月</a></li>
          </ul>
        </nav>
      </header>
      <main id="main">
        <div id="header-date"><time>2018-10-09</time></div>
        <h1 id="page-title">ngx-onsenui を使って Angular6 + OnsenUI + Cordova なプロジェクトを立ち上げてみる</h1>

<p>HTML・CSS・JavaScript でスマホ向けアプリを作成することを「ハイブリッドアプリ」と呼ぶが、そんなハイブリッドアプリで Android や iOS のネイティブっぽい UI を実現してくれる、<strong>OnsenUI</strong> というフレームワークがある。</p>
<ul>
  <li><a href="https://ja.onsen.io/">Onsen UI 2: HTML5モバイルアプリを速く、美しく - Onsen UI</a></li>
</ul>
<p>「<a href="https://ja.monaca.io/">Monaca</a>」を展開する、「<a href="https://www.asial.co.jp/">アシアル株式会社</a>」という日本の企業が作っている、国産のフレームワークなので、ドキュメント群も日本語が存在し、大変分かりやすい。</p>
<p>OnsenUI 本体はピュアな CSS として利用できる他、<strong>ngx-onsenui</strong> というパッケージを利用すると、Angular アプリに最適化された各種コンポーネントが利用できる。</p>
<p>今回は Angular6 系のアプリをベースに、ngx-onsenui を使って OnsenUI を組み込み、それを Cordova でビルドして iOS アプリ化してみようと思う。</p>
<ul>
  <li>参考 : <a href="https://ja.onsen.io/v2/guide/angular2/">Angular 2+ - Onsen UI</a></li>
</ul>
<h2 id="目次"><a class="header-link" href="#目次"><span class="header-link-mark"></span></a>目次</h2>
<ul>
  <li><a href="#%E7%92%B0%E5%A2%83%E6%83%85%E5%A0%B1">環境情報</a></li>
  <li><a href="#angular-%E3%82%A2%E3%83%97%E3%83%AA%E3%81%AE%E4%BD%9C%E6%88%90">Angular アプリの作成</a></li>
  <li><a href="#ngx-onsenui-%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB">ngx-onsenui のインストール</a></li>
  <li><a href="#onsenui-%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%8B">OnsenUI コンポーネントを使ってみる</a></li>
  <li><a href="#%E3%82%B9%E3%83%9E%E3%83%9B%E3%82%A2%E3%83%97%E3%83%AA%E9%A2%A8%E3%81%AE-ui-%E3%82%92%E5%AE%9F%E7%8F%BE%E3%81%99%E3%82%8B">スマホアプリ風の UI を実現する</a></li>
  <li><a href="#cordova-%E3%82%A2%E3%83%97%E3%83%AA%E5%8C%96%E3%81%99%E3%82%8B">Cordova アプリ化する</a>
    <ul>
      <li><a href="#cordova-%E3%81%AE%E3%82%B0%E3%83%AD%E3%83%BC%E3%83%90%E3%83%AB%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB">Cordova のグローバルインストール</a></li>
      <li><a href="#%E9%9B%9B%E5%BD%A2%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E3%83%9E%E3%83%BC%E3%82%B8">雛形ファイルのマージ</a></li>
      <li><a href="#angular-%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E5%8A%A0%E5%B7%A5">Angular プロジェクトの加工</a></li>
    </ul>
  </li>
  <li><a href="#ios-%E3%82%B7%E3%83%9F%E3%83%A5%E3%83%AC%E3%83%BC%E3%82%BF%E3%81%A7%E8%B5%B7%E5%8B%95%E3%81%99%E3%82%8B">iOS シミュレータで起動する</a></li>
  <li><a href="#%E4%BB%A5%E4%B8%8A">以上</a></li>
</ul>
<h2 id="環境情報"><a class="header-link" href="#環境情報"><span class="header-link-mark"></span></a>環境情報</h2>
<p>検証した OS は MacOS High Sierra。Angular CLI v6.1.5 を利用してアプリの雛形を作ろうと思うので、Node.js・npm は予め用意しておこう。</p>
<pre class="language-bash"><code class="language-bash">$ node -v
v10.7.0

$ <span class="token function">npm</span> -v
<span class="token number">6.1</span>.0

$ ng -v
Angular CLI: <span class="token number">6.1</span>.5
Node: <span class="token number">10.7</span>.0
OS: darwin x64
Angular:
<span class="token punctuation">..</span>.

Package                      Version
------------------------------------------------------
@angular-devkit/architect    <span class="token number">0.7</span>.5
@angular-devkit/core         <span class="token number">0.7</span>.5
@angular-devkit/schematics   <span class="token number">0.7</span>.5
@schematics/angular          <span class="token number">0.7</span>.5
@schematics/update           <span class="token number">0.7</span>.5
rxjs                         <span class="token number">6.2</span>.2
typescript                   <span class="token number">2.9</span>.2
</code></pre>
<p>最後に iOS シミュレータを利用して Angular + OnsenUI + Cordova 製アプリを動作させたいので、Xcode や iOS シミュレータは予めインストールしておくこと。</p>
<h2 id="angular-アプリの作成"><a class="header-link" href="#angular-アプリの作成"><span class="header-link-mark"></span></a>Angular アプリの作成</h2>
<p>まずは Angular CLI でアプリの雛形を作る。</p>
<pre class="language-bash"><code class="language-bash">$ ng new ng-cordova-onsen --routing --style<span class="token operator">=</span>scss
$ <span class="token builtin class-name">cd</span> ng-cordova-onsen
</code></pre>
<h2 id="ngx-onsenui-のインストール"><a class="header-link" href="#ngx-onsenui-のインストール"><span class="header-link-mark"></span></a>ngx-onsenui のインストール</h2>
<p>次に、<code>onsenui</code> 本体と、それを Angular にバインディングする <code>ngx-onsenui</code> をインストールする。</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token function">npm</span> <span class="token function">install</span> -S onsenui ngx-onsenui
</code></pre>
<p>インストール後、AppModule にて OnsenModule をインポートし、<code>CUSTOM_ELEMENTS_SCHEMA</code> を設定する。</p>
<pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token imports"><span class="token punctuation">{</span> <span class="token maybe-class-name">BrowserModule</span> <span class="token punctuation">}</span></span> <span class="token keyword">from</span> <span class="token string">'@angular/platform-browser'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token maybe-class-name">NgModule</span><span class="token punctuation">,</span> <span class="token constant">CUSTOM_ELEMENTS_SCHEMA</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@angular/core'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token imports"><span class="token punctuation">{</span> <span class="token maybe-class-name">OnsenModule</span> <span class="token punctuation">}</span></span> <span class="token keyword">from</span> <span class="token string">'ngx-onsenui'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token imports"><span class="token punctuation">{</span> <span class="token maybe-class-name">AppRoutingModule</span> <span class="token punctuation">}</span></span> <span class="token keyword">from</span> <span class="token string">'./app-routing.module'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token imports"><span class="token punctuation">{</span> <span class="token maybe-class-name">AppComponent</span> <span class="token punctuation">}</span></span> <span class="token keyword">from</span> <span class="token string">'./app.component'</span><span class="token punctuation">;</span>

@<span class="token function"><span class="token maybe-class-name">NgModule</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  declarations<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token maybe-class-name">AppComponent</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  imports<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token maybe-class-name">BrowserModule</span><span class="token punctuation">,</span>
    <span class="token maybe-class-name">OnsenModule</span><span class="token punctuation">,</span>  <span class="token comment">// ← 追加</span>
    <span class="token maybe-class-name">AppRoutingModule</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  providers<span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  bootstrap<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token maybe-class-name">AppComponent</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  schemas<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token constant">CUSTOM_ELEMENTS_SCHEMA</span>  <span class="token comment">// ← 追加</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token maybe-class-name">AppModule</span></span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
</code></pre>
<p>最後に、<code>styles.scss</code> にて OnsenUI のスタイルシートファイルをインポートする。</p>
<pre class="language-scss"><code class="language-scss"><span class="token comment">// ./src/styles.scss</span>
<span class="token keyword">@import</span> <span class="token string">'../node_modules/onsenui/css/onsenui.css'</span><span class="token punctuation">;</span>
<span class="token keyword">@import</span> <span class="token string">'../node_modules/onsenui/css/onsen-css-components.css'</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="onsenui-コンポーネントを使ってみる"><a class="header-link" href="#onsenui-コンポーネントを使ってみる"><span class="header-link-mark"></span></a>OnsenUI コンポーネントを使ってみる</h2>
<p>ココまでで OnsenUI のインストールは完了したので、試しに <code>ons-button</code> コンポーネントを使ってみよう。</p>
<p><code>app.component.html</code> に以下のように記述し、<code>$ npm start</code> でブラウザを起動すると、青地に白文字で「Click!」と書かれたボタンが配置されているはずだ。</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>ons-button</span><span class="token punctuation">></span></span>Click!<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>ons-button</span><span class="token punctuation">></span></span>
</code></pre>
<p>クリック時のイベントを設定するなら、<code>&#x3C;ons-button (click)="doSomething()"></code> のように記述し、TypeScript ファイルの方に <code>doSomething()</code> メソッドを実装すれば良い。</p>
<h2 id="スマホアプリ風の-ui-を実現する"><a class="header-link" href="#スマホアプリ風の-ui-を実現する"><span class="header-link-mark"></span></a>スマホアプリ風の UI を実現する</h2>
<p>今回は OnsenUI をお試しで使うだけなので、ホントにガワだけ実装してみる。<code>app.component.html</code> を次のように作り変えよう。</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>ons-page</span><span class="token punctuation">></span></span>
  <span class="token comment">&#x3C;!-- 上部ツールバー --></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>ons-toolbar</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>ons-back-button</span><span class="token punctuation">></span></span>Back<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>ons-back-button</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>right<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>ons-toolbar-button</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>ons-icon</span> <span class="token attr-name">icon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ion-navicon<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>ons-icon</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>ons-toolbar-button</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>ons-toolbar</span><span class="token punctuation">></span></span>
  
  <span class="token comment">&#x3C;!-- 下部タブバー --></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>ons-tabbar</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tabbar<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>ons-tab</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Home<span class="token punctuation">"</span></span> <span class="token attr-name">icon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ion-home<span class="token punctuation">"</span></span> <span class="token attr-name">active</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>ons-tab</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>ons-tab</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Favorites<span class="token punctuation">"</span></span> <span class="token attr-name">icon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ion-ios-browsers<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>ons-tab</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>ons-tab</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Settings<span class="token punctuation">"</span></span> <span class="token attr-name">icon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ion-ios-search<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>ons-tab</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>ons-tabbar</span><span class="token punctuation">></span></span>
  
  <span class="token comment">&#x3C;!-- 背景色レイヤ --></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>background<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span>
  
  <span class="token comment">&#x3C;!-- コンテンツ --></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>content<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token comment">&#x3C;!-- 通常はルータで子ページを表示する --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>router-outlet</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>router-outlet</span><span class="token punctuation">></span></span>
    
    <span class="token comment">&#x3C;!-- 今回は試しにボタンだけベタで実装した --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>p</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>ons-button</span><span class="token punctuation">></span></span>Click Me!<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>ons-button</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>p</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>ons-page</span><span class="token punctuation">></span></span>
</code></pre>
<p>こんな風に作り、Chrome ブラウザの「レスポンシブデザインモード」などで見てみると、次のように表示される。</p>
<p>
  <img src="09-03-02.png" alt="見た目ネイティブっぽい">
</p>
<p>かなりスマホネイティブっぽい見た目になったが、全て CSS で実装されている。素晴らしい！</p>
<h2 id="cordova-アプリ化する"><a class="header-link" href="#cordova-アプリ化する"><span class="header-link-mark"></span></a>Cordova アプリ化する</h2>
<p>最後は、Cordova を使って iOS アプリとしてビルドして、iOS シミュレータで動かしてみよう。</p>
<h3 id="cordova-のグローバルインストール"><a class="header-link" href="#cordova-のグローバルインストール"><span class="header-link-mark"></span></a>Cordova のグローバルインストール</h3>
<p>Cordova 本体はグローバルインストールする必要がある。現時点では <code>cordova@8.0.0</code> が最新版なので、次のようにインストールする。</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token function">npm</span> <span class="token function">install</span> -g cordova
</code></pre>
<h3 id="雛形ファイルのマージ"><a class="header-link" href="#雛形ファイルのマージ"><span class="header-link-mark"></span></a>雛形ファイルのマージ</h3>
<p>次に、Cordova アプリの雛形ファイルを手に入れるため、コレまで作業していた <code>ng-cordova-onsen</code> ディレクトリとは別のところに、同名で Cordova アプリを立ち上げてみる。</p>
<pre class="language-bash"><code class="language-bash"><span class="token comment"># 別の一時作業用ディレクトリを作ってそこに移動する</span>
$ <span class="token function">mkdir</span> temp-cordova <span class="token operator">&#x26;&#x26;</span> <span class="token builtin class-name">cd</span> <span class="token variable">$_</span>

<span class="token comment"># Cordova プロジェクトを作る</span>
$ cordova create ng-cordova-onsen com.example ng-cordova-onsen
Creating a new cordova project.
</code></pre>
<p>こうして生成された <code>ng-cordova-onsen/</code> ディレクトリ配下から、<code>hooks/</code>・<code>res/</code>・<code>config.xml</code> をコピーして、先程まで作業していた Angular プロジェクトの方にコピーする。</p>
<p>そしたら、Angular プロジェクト側の <code>ng-cordova-onsen/src/index.html</code> と、Cordova プロジェクト側の <code>ng-cordova-onsen/www/index.html</code> を開く。Cordova プロジェクト側の <code>index.html</code> に記載されているコードの一部を、Angular プロジェクト側に移植する。次のような <code>src/index.html</code> に仕上げる。</p>
<pre class="language-html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&#x3C;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ja<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>title</span><span class="token punctuation">></span></span>NgCordovaOnsen<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>title</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>base</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>./<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Content-Security-Policy<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>default-src <span class="token punctuation">'</span>self<span class="token punctuation">'</span> data: gap: https://ssl.gstatic.com <span class="token punctuation">'</span>unsafe-eval<span class="token punctuation">'</span>; style-src <span class="token punctuation">'</span>self<span class="token punctuation">'</span> <span class="token punctuation">'</span>unsafe-inline<span class="token punctuation">'</span>; media-src *; img-src <span class="token punctuation">'</span>self<span class="token punctuation">'</span> data: content:;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>format-detection<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>telephone=no<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>msapplication-tap-highlight<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>no<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>icon<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>image/x-icon<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>favicon.ico<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>cordova.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>head</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>body</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>app-root</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>app-root</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>html</span><span class="token punctuation">></span></span>
</code></pre>
<p>いくつかの <code>meta</code> 要素と、<code>cordova.js</code> を読み込むよう変更を入れている。</p>
<p>ココまでできたら、<code>cordova create</code> コマンドで生成したプロジェクトの方は用済み。削除して良い。</p>
<ul>
  <li>参考 : <a href="https://github.com/Neos21/boilerplate-angular-cordova">GitHub - Neos21/angular-cordova: Angular + Cordova iOS App Boilerplate</a> … 拙作の Angular4 + Cordova ボイラープレート。今回やっていることとほぼ変わらない。</li>
  <li>参考 : <a href="https://github.com/NavCore/ngCordova">GitHub - NavCore/ngCordova: Angular 4 + Cordova Boilerplate</a> … コチラも同様のボイラープレート。参考までに。</li>
</ul>
<h3 id="angular-プロジェクトの加工"><a class="header-link" href="#angular-プロジェクトの加工"><span class="header-link-mark"></span></a>Angular プロジェクトの加工</h3>
<p>続いて、Angular プロジェクト直下の <code>angular.json</code> を編集する。</p>
<pre class="language-json"><code class="language-json"><span class="token property">"architect"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">"build"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"builder"</span><span class="token operator">:</span> <span class="token string">"@angular-devkit/build-angular:browser"</span><span class="token punctuation">,</span>
    <span class="token property">"options"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"outputPath"</span><span class="token operator">:</span> <span class="token string">"dist/ng-cordova-onsen"</span><span class="token punctuation">,</span>
</code></pre>
<p>↑ コレが編集前の抜粋。この <code>outputPath</code> を、<code>www</code> に変更する。</p>
<pre class="language-json"><code class="language-json"><span class="token property">"outputPath"</span><span class="token operator">:</span> <span class="token string">"www"</span><span class="token punctuation">,</span>
</code></pre>
<p>コレで、<code>npm run build</code> 実行時に成果物ファイルが <code>www/</code> ディレクトリに出力されるようになる。<code>.gitignore</code> に <code>/www</code> も追加しておこう。<code>www</code> ディレクトリはとりあえず存在させておかないと <code>cordova</code> コマンドが動作してくれないので、初回のみは <code>./www/.gitkeep</code> を作成し、このファイルだけコミットしておくと良いだろう。</p>
<p>次に以下のコマンドを実行し、<code>./platforms/</code> と <code>./plugins/</code> ディレクトリを生成させ、<code>package.json</code> に Cordova 関連のパッケージを追記させる。</p>
<pre class="language-bash"><code class="language-bash">$ cordova platform <span class="token function">add</span> ios
</code></pre>
<p>最後に、<code>package.json</code> に <code>build:ios</code> コマンドを追加しよう。</p>
<pre class="language-json"><code class="language-json">  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"build:ios"</span><span class="token operator">:</span> <span class="token string">"ng build --base-href . &#x26;&#x26; cordova emulate ios --target=\"iPhone-SE, 11.4\""</span><span class="token punctuation">,</span>
    <span class="token comment">// 以下略…</span>
</code></pre>
<p>ココで記述した <code>cordova emulate</code> コマンドのターゲットは、次のコマンドで確認できる。</p>
<pre class="language-bash"><code class="language-bash">$ cordova emulate ios --list
</code></pre>
<p>このコマンドで、そのマシンにインストールされている iOS シミュレータのデバイスとバージョンが分かるので、それを指定する。</p>
<ul>
  <li>参考 : <a href="https://stackoverflow.com/questions/22310526/cordova-start-specific-ios-emulator-image">iphone - Cordova: start specific iOS emulator image - Stack Overflow</a></li>
  <li>参考 : <a href="https://qiita.com/kenfdev/items/74bdfcc65317a411df68">CordovaでiOS simulatorを指定する</a></li>
</ul>
<p><code>package.json</code> 全体としては次のようになるはずだ。</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"ng-cordova-onsen"</span><span class="token punctuation">,</span>
  <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"0.0.0"</span><span class="token punctuation">,</span>
  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"ng"</span><span class="token operator">:</span> <span class="token string">"ng"</span><span class="token punctuation">,</span>
    <span class="token property">"start"</span><span class="token operator">:</span> <span class="token string">"ng serve"</span><span class="token punctuation">,</span>
    <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"ng build"</span><span class="token punctuation">,</span>
    <span class="token property">"build:ios"</span><span class="token operator">:</span> <span class="token string">"ng build --base-href . &#x26;&#x26; cordova emulate ios --target=\"iPhone-SE, 11.4\""</span><span class="token punctuation">,</span>
    <span class="token property">"test"</span><span class="token operator">:</span> <span class="token string">"ng test"</span><span class="token punctuation">,</span>
    <span class="token property">"lint"</span><span class="token operator">:</span> <span class="token string">"ng lint"</span><span class="token punctuation">,</span>
    <span class="token property">"e2e"</span><span class="token operator">:</span> <span class="token string">"ng e2e"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"private"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"@angular/animations"</span><span class="token operator">:</span> <span class="token string">"^6.1.0"</span><span class="token punctuation">,</span>
    <span class="token property">"@angular/common"</span><span class="token operator">:</span> <span class="token string">"^6.1.0"</span><span class="token punctuation">,</span>
    <span class="token property">"@angular/compiler"</span><span class="token operator">:</span> <span class="token string">"^6.1.0"</span><span class="token punctuation">,</span>
    <span class="token property">"@angular/core"</span><span class="token operator">:</span> <span class="token string">"^6.1.0"</span><span class="token punctuation">,</span>
    <span class="token property">"@angular/forms"</span><span class="token operator">:</span> <span class="token string">"^6.1.0"</span><span class="token punctuation">,</span>
    <span class="token property">"@angular/http"</span><span class="token operator">:</span> <span class="token string">"^6.1.0"</span><span class="token punctuation">,</span>
    <span class="token property">"@angular/platform-browser"</span><span class="token operator">:</span> <span class="token string">"^6.1.0"</span><span class="token punctuation">,</span>
    <span class="token property">"@angular/platform-browser-dynamic"</span><span class="token operator">:</span> <span class="token string">"^6.1.0"</span><span class="token punctuation">,</span>
    <span class="token property">"@angular/router"</span><span class="token operator">:</span> <span class="token string">"^6.1.0"</span><span class="token punctuation">,</span>
    <span class="token property">"cordova-ios"</span><span class="token operator">:</span> <span class="token string">"4.5.5"</span><span class="token punctuation">,</span>
    <span class="token property">"cordova-plugin-whitelist"</span><span class="token operator">:</span> <span class="token string">"1.3.3"</span><span class="token punctuation">,</span>
    <span class="token property">"core-js"</span><span class="token operator">:</span> <span class="token string">"^2.5.4"</span><span class="token punctuation">,</span>
    <span class="token property">"ngx-onsenui"</span><span class="token operator">:</span> <span class="token string">"4.2.2"</span><span class="token punctuation">,</span>
    <span class="token property">"onsenui"</span><span class="token operator">:</span> <span class="token string">"2.10.4"</span><span class="token punctuation">,</span>
    <span class="token property">"rxjs"</span><span class="token operator">:</span> <span class="token string">"^6.0.0"</span><span class="token punctuation">,</span>
    <span class="token property">"zone.js"</span><span class="token operator">:</span> <span class="token string">"~0.8.26"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"devDependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"@angular-devkit/build-angular"</span><span class="token operator">:</span> <span class="token string">"~0.7.0"</span><span class="token punctuation">,</span>
    <span class="token property">"@angular/cli"</span><span class="token operator">:</span> <span class="token string">"~6.1.5"</span><span class="token punctuation">,</span>
    <span class="token property">"@angular/compiler-cli"</span><span class="token operator">:</span> <span class="token string">"^6.1.0"</span><span class="token punctuation">,</span>
    <span class="token property">"@angular/language-service"</span><span class="token operator">:</span> <span class="token string">"^6.1.0"</span><span class="token punctuation">,</span>
    <span class="token property">"@types/jasmine"</span><span class="token operator">:</span> <span class="token string">"~2.8.6"</span><span class="token punctuation">,</span>
    <span class="token property">"@types/jasminewd2"</span><span class="token operator">:</span> <span class="token string">"~2.0.3"</span><span class="token punctuation">,</span>
    <span class="token property">"@types/node"</span><span class="token operator">:</span> <span class="token string">"~8.9.4"</span><span class="token punctuation">,</span>
    <span class="token property">"codelyzer"</span><span class="token operator">:</span> <span class="token string">"~4.2.1"</span><span class="token punctuation">,</span>
    <span class="token property">"jasmine-core"</span><span class="token operator">:</span> <span class="token string">"~2.99.1"</span><span class="token punctuation">,</span>
    <span class="token property">"jasmine-spec-reporter"</span><span class="token operator">:</span> <span class="token string">"~4.2.1"</span><span class="token punctuation">,</span>
    <span class="token property">"karma"</span><span class="token operator">:</span> <span class="token string">"~1.7.1"</span><span class="token punctuation">,</span>
    <span class="token property">"karma-chrome-launcher"</span><span class="token operator">:</span> <span class="token string">"~2.2.0"</span><span class="token punctuation">,</span>
    <span class="token property">"karma-coverage-istanbul-reporter"</span><span class="token operator">:</span> <span class="token string">"~2.0.0"</span><span class="token punctuation">,</span>
    <span class="token property">"karma-jasmine"</span><span class="token operator">:</span> <span class="token string">"~1.1.1"</span><span class="token punctuation">,</span>
    <span class="token property">"karma-jasmine-html-reporter"</span><span class="token operator">:</span> <span class="token string">"^0.2.2"</span><span class="token punctuation">,</span>
    <span class="token property">"protractor"</span><span class="token operator">:</span> <span class="token string">"~5.4.0"</span><span class="token punctuation">,</span>
    <span class="token property">"ts-node"</span><span class="token operator">:</span> <span class="token string">"~5.0.1"</span><span class="token punctuation">,</span>
    <span class="token property">"tslint"</span><span class="token operator">:</span> <span class="token string">"~5.9.1"</span><span class="token punctuation">,</span>
    <span class="token property">"typescript"</span><span class="token operator">:</span> <span class="token string">"~2.7.2"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"cordova"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"plugins"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"cordova-plugin-whitelist"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"platforms"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">"ios"</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="ios-シミュレータで起動する"><a class="header-link" href="#ios-シミュレータで起動する"><span class="header-link-mark"></span></a>iOS シミュレータで起動する</h2>
<p>実際に <em><code>$ npm run build:ios</code></em> コマンドを実行してみると、Angular ビルド後、<code>./www/</code> ディレクトリに生成された成果物ファイルを使用して Cordova ビルドが行われ、その後 iPhoseSE のシミュレータが起動する。</p>
<p>
  <img src="09-03-01.png" alt="シミュレータ上での様子">
</p>
<p>実際に iOS 上で動作させると、ホントにネイティブアプリみたいだ。素晴らしい！！</p>
<h2 id="以上"><a class="header-link" href="#以上"><span class="header-link-mark"></span></a>以上</h2>
<p>OnsenUI 本体は単純なカスタムエレメントと CSS のフレームワークだし、ngx-onsenui もシンプルな Angular コンポーネントなので、自然に使えるようになるだろう。</p>
<p>これで今までよりネイティブに近い UI を実現できるようになったので、ガシガシ使っていこうと思う。</p>

      </main>
      <footer id="footer">
        <div id="footer-contents">
          <div id="date-time">
            <dl>
              <dt>Created</dt>
              <dd><time>2018-10-09</time></dd>
              <dt>Last-Modified</dt>
              <dd><time>2018-10-09</time></dd>
            </dl>
          </div>
          <nav id="footer-links">
            <ul>
              <li id="footer-link-about"><a href="/about/index.html" title="About">About</a></li>
              <li id="footer-link-search"><a href="/about/search.html" title="Search">Search</a></li>
              <li id="footer-link-feeds"><a href="/feeds.xml" title="Feeds">Feeds</a></li>
              <li id="footer-link-github"><a href="https://github.com/Neos21/" title="GitHub">GitHub</a></li>
            </ul>
          </nav>
          <nav id="to-top"><a href="#" title="To Top"><span>▲ To Top</span></a></nav>
        </div>
      </footer>
    </div>
  </body>
</html>
