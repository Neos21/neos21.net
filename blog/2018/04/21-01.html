<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="theme-color" content="#0990d0">
    <!-- Google Search Console -->
    <meta name="google-site-verification" content="AvoEr3mUJFF2H_mPWWgShfmjBVP3ywRpyx9hxeeq2d4">
    <title>VSCode の markdown.styles にローカルファイルをフルパス指定できなくなっていた - Neo's World</title>
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="/styles.css">
    <link rel="canonical" href="https://neos21.net/blog/2018/04/21-01.html">
    <link rel="search" type="application/opensearchdescription+xml" title="neos21.net" href="/opensearch.xml">
    <link rel="alternate" type="application/atom+xml" href="/feeds.xml">
    <link rel="author" href="http://www.hatena.ne.jp/neos21/">
    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YMHFLZP1M1"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date());gtag('config','G-YMHFLZP1M1');gtag('config','UA-106501-1');</script>
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6475907504235292" crossorigin="anonymous"></script>
  </head>
  <body>
    <div id="container">
      <header id="header">
        <div id="header-brand">
          <div id="header-brand-contents">
            <div id="site-title"><a href="/index.html">Neo's World</a></div>
            <nav id="header-links">
              <ul>
                <li id="header-link-about"><a href="/about/index.html" title="About"><span>About</span></a></li>
                <li id="header-link-search"><a href="/about/search.html" title="Search"><span>Search</span></a></li>
                <li id="header-link-feeds"><a href="/feeds.xml" title="Feeds"><span>Feeds</span></a></li>
                <li id="header-link-to-bottom"><a href="#footer" title="To Bottom"><span>▼ To Bottom</span></a></li>
              </ul>
            </nav>
          </div>
        </div>
        <nav id="global-nav">
          <ul>
            <li><a href="/blog/index.html">Blog</a></li>
            <li><a href="/tech/index.html">Tech</a></li>
            <li><a href="/music/index.html">Music</a></li>
            <li><a href="/games/index.html">Games</a></li>
            <li><a href="/gallery/index.html">Gallery</a></li>
            <li><a href="/etc/index.html">Etc.</a></li>
          </ul>
        </nav>
        <nav id="path">
          <ul>
            <li><a href="/index.html">Neo's World</a></li>
            <li><a href="/blog/index.html">Blog</a></li>
            <li><a href="/blog/2018/index.html">2018年</a></li>
            <li><a href="/blog/2018/04/index.html">04月</a></li>
          </ul>
        </nav>
      </header>
      <main id="main">
        <div id="header-date"><time>2018-04-21</time></div>
        <h1 id="page-title">VSCode の markdown.styles にローカルファイルをフルパス指定できなくなっていた</h1>

<p>VSCode の設定 (<code>settings.json</code>) に、<code>markdown.styles</code> という項目がある。これまではココに以下のように記述すると、Markdown のプレビュー表示時に好きなスタイルを当てられた。</p>
<pre class="language-json"><code class="language-json"><span class="token comment">// Windows の場合、Mac の場合、file: プロトコルを付けた場合、いずれも緩く参照できてたっぽい</span>
<span class="token punctuation">{</span>
  <span class="token property">"markdown.styles"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">"C:\\Documents\\MyVSCodeStyles.css"</span><span class="token punctuation">,</span>
    <span class="token string">"file:///Users/me/MyVSCodeStyles.css"</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
<p>しかし、最近のアップデートで、<em>セキュリティ上の問題から</em>、<strong>ローカルファイルをフルパスで指定する方法が禁止</strong>されたようだ。</p>
<ul>
  <li>参考 : <a href="https://github.com/Microsoft/vscode/issues/45260">Can't custum markdown style · Issue #45260 · Microsoft/vscode · GitHub</a></li>
</ul>
<blockquote>
  <p>Root cause: We now restrict the markdown preview to only loading resources inside the current workspace for security reasons. Workaround is to move the css file into your workspace or publish the css as a markdown extension</p>
  <p>I'm hesitant to relax this again even though it is a regression because the old behavior could be abused by a malicious workspace</p>
</blockquote>
<p>プロジェクトルートからの相対パスであれば参照できるようだ。つまり「ユーザ設定」ではなく「ワークスペースの設定」でやれ、ということのようだ。</p>
<ul>
  <li>参考 : <a href="https://qiita.com/ueruku/items/abd092f37493662f52e4">いまどき行うVSCode/MarkdownでCSSが変更できない - Qiita</a></li>
</ul>
<p>公式のリファレンスでも「current workspace」での設定サンプルしかなく、いつの間にかこっそり改変されてた感がある…。</p>
<ul>
  <li>参考 : <a href="https://code.visualstudio.com/docs/languages/markdown#_using-your-own-css">Markdown editing with Visual Studio Code</a></li>
</ul>
<p>セキュリティ上の理由で仕方ないみたいだけど、使いづらくなってしまってつらい…。</p>

      </main>
      <footer id="footer">
        <div id="footer-contents">
          <div id="date-time">
            <dl>
              <dt>Created</dt>
              <dd><time>2018-04-21</time></dd>
              <dt>Last-Modified</dt>
              <dd><time>2018-04-21</time></dd>
            </dl>
          </div>
          <nav id="footer-links">
            <ul>
              <li id="footer-link-about"><a href="/about/index.html" title="About">About</a></li>
              <li id="footer-link-search"><a href="/about/search.html" title="Search">Search</a></li>
              <li id="footer-link-feeds"><a href="/feeds.xml" title="Feeds">Feeds</a></li>
              <li id="footer-link-github"><a href="https://github.com/Neos21/" title="GitHub">GitHub</a></li>
            </ul>
          </nav>
          <nav id="to-top"><a href="#" title="To Top"><span>▲ To Top</span></a></nav>
        </div>
      </footer>
    </div>
  </body>
</html>
