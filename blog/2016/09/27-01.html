<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="theme-color" content="#0990d0">
    <!-- Google Search Console -->
    <meta name="google-site-verification" content="AvoEr3mUJFF2H_mPWWgShfmjBVP3ywRpyx9hxeeq2d4">
    <title>JScript と WSH と JScript.NET と .NET Framework と - Neo's World</title>
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="/styles.css">
    <link rel="canonical" href="https://neos21.net/blog/2016/09/27-01.html">
    <link rel="search" type="application/opensearchdescription+xml" title="neos21.net" href="/opensearch.xml">
    <link rel="alternate" type="application/atom+xml" title="Feeds" href="/feeds.xml">
    <link rel="author" href="http://www.hatena.ne.jp/neos21/">
    <script defer src="/scripts.js"></script>
    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YMHFLZP1M1"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date());gtag('config','G-YMHFLZP1M1');gtag('config','UA-106501-1');</script>
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6475907504235292" crossorigin="anonymous"></script>
  </head>
  <body>
    <div id="container">
      <header id="header">
        <div id="header-brand">
          <div id="header-brand-contents">
            <div id="site-title"><a href="/index.html">Neo's World</a></div>
            <nav id="header-links">
              <ul>
                <li id="header-link-about"><a href="/about/index.html" title="About"><span>About</span></a></li>
                <li id="header-link-search"><a href="/about/search.html" title="Search"><span>Search</span></a></li>
                <li id="header-link-feeds"><a href="/feeds.xml" title="Feeds"><span>Feeds</span></a></li>
                <li id="header-link-to-bottom"><a href="#footer" title="To Bottom"><span>▼ To Bottom</span></a></li>
              </ul>
            </nav>
          </div>
        </div>
        <nav id="global-nav">
          <ul>
            <li><a href="/blog/index.html">Blog</a></li>
            <li><a href="/tech/index.html">Tech</a></li>
            <li><a href="/music/index.html">Music</a></li>
            <li><a href="/games/index.html">Games</a></li>
            <li><a href="/gallery/index.html">Gallery</a></li>
            <li><a href="/etc/index.html">Etc.</a></li>
          </ul>
        </nav>
        <nav id="path">
          <ul>
            <li><a href="/index.html">Neo's World</a></li>
            <li><a href="/blog/index.html">Blog</a></li>
            <li><a href="/blog/2016/index.html">2016年</a></li>
            <li><a href="/blog/2016/09/index.html">09月</a></li>
          </ul>
        </nav>
      </header>
      <main id="main">
        <div id="header-date"><time>2016-09-27</time></div>
        <h1 id="page-title">JScript と WSH と JScript.NET と .NET Framework と</h1>

<p>Windows で何かスクリプトを作るとなると、MS-DOS 上がりのコマンドプロンプトではイマイチ勝手が悪い時がある。PowerShell を使う手もあるが、実行するために環境設定が必要だったり、独特な言語仕様を勉強するコストが割とかかり、学ぶ気のない人には引き継げない。</p>
<p>そうなると、VBA や VB6 などの経験がある人は VBScript で、フロントエンドに明るいタイプの人には JavaScript によく似た言語仕様の JScript で、それぞれスクリプトを書くことになる。</p>
<p>んで、今回はそのうちの JScript について、最近 <strong>JScript.NET</strong> というものを知ったので、このあたりの内容をまとめてみる。</p>
<h2 id="vbscript-と-jscript-を動作させる環境が-windows-script-host"><a class="header-link" href="#vbscript-と-jscript-を動作させる環境が-windows-script-host"><span class="header-link-mark"></span></a>VBScript と JScript を動作させる環境が Windows Script Host</h2>
<p>コマンドプロンプトよりちょっと高級なスクリプトが書ける、WSH って何だったのよ、という話。</p>
<p>Windows Script Host と呼ばれるものは、<em>スクリプトの実行環境</em>を指す。そして、どんな言語でスクリプトを書くか、というところで、標準サポートされているのが VBScript という言語と、JScript という言語、というワケ。両方とも Microsoft 製の言語なので、Windows OS 上、そして IE 上など、実行環境を意識することなく使えるような作りになっている、というワケだ。この「別け隔てない」感じが、混乱を招いているような気がする。</p>
<p>グラフィカルに動作するのが WScript (WScript.exe) で、コマンドライン上で動作するように最適化されているのが CScript.exe だ。例えば、以下のような VBScript (<code>.vbs</code> ファイル) があったとして、</p>
<pre class="language-vb"><code class="language-vb"><span class="token comment">' sample.vbs</span>
WScript<span class="token punctuation">.</span>Echo <span class="token string">"ほげほげ"</span>
</code></pre>
<p>これをコンソール上から</p>
<pre class="language-batch"><code class="language-batch"><span class="token command"><span class="token keyword">Wscript</span> sample.vbs</span>
</code></pre>
<p>と呼ぶと、画面上にダイアログボックスが表示されるが、</p>
<pre class="language-batch"><code class="language-batch"><span class="token command"><span class="token keyword">CScript</span> sample.vbs</span>
</code></pre>
<p>と呼ぶと、コンソール上にメッセージが表示される。</p>
<p>ただし、VBScript が持つ <code>MsgBox</code> 関数を使ったとしたら、これは CScript でもダイアログボックスが表示される。あくまで WSH が提供する機能の現れ方が、WScript と CScript で異なる、ということだ。</p>
<ul>
  <li>参考 : <a href="https://technet.microsoft.com/ja-jp/scriptcenter/ff707270.aspx">スクリプトの開始と停止</a></li>
</ul>
<p>ちなみに、サードパーティ製だと、Perl が動作するようにする動作環境 (スクリプトエンジン) もあるみたい。</p>
<h2 id="net-framework-の登場と-vbnetjscriptnet"><a class="header-link" href="#net-framework-の登場と-vbnetjscriptnet"><span class="header-link-mark"></span></a>.NET Framework の登場と VB.NET・JScript.NET</h2>
<p>Microsoft は共通言語基盤という考え方を進めていくため、.NET Framework という開発・実行環境を作った。あらゆる言語で作られた言語を共通中間言語にコンパイルすることで、コードが特定のプログラミング言語やプラットフォームに依存しないようにするという仕組みだ。WSH がやりたかったことを拡大解釈した機構、といったところか。</p>
<p>C#、PowerShell、VB.NET などが、.NET Framework を基盤として動作する言語としてよく知られているが、Java を .NET Framework 上で動作するように移植した J#、PHP が動作する Phalanger、Python が動作する IronPython、Ruby が動作する IronRuby などもある。これらは全て、それぞれの言語で書いた既存のコードはほぼそのまま動作する上に、.NET Framework が用意するクラスライブラリを使うことができるワケだ。</p>
<p>JScript.NET もその流れの1つである。Microsoft 製の JScript が .NET Framework 基盤に乗った仕様、ということだ。</p>
<h2 id="wsh-で動く-jscript-とjscriptnet-の違い"><a class="header-link" href="#wsh-で動く-jscript-とjscriptnet-の違い"><span class="header-link-mark"></span></a>WSH で動く JScript と、JScript.NET の違い</h2>
<p>では、JScript と JScript.NET で何が違うか、というと、簡単にいえば、WSH が提供していた機能は使えなくなる。例えば先述の <code>WScript.Echo("文字列");</code> は、JScript.NET では使えない。代わりに、<code>import System;</code> 文で System をインポートし、<code>Console.WriteLine("文字列");</code> と書くことになる。ちなみに、<code>print("文字列");</code> であれば、JScript の組み込みなので、JScript.NET に移植する際もそのまま使える。</p>
<p><code>WScript.sleep()</code> なども同様だ。実行環境 (WSH か .NET か) が異なるので、実行環境に依存した構文はどうしても影響を受ける。WSH を使っていたが、.NET Framework は知らない、という人は移植のために勉強が必要になるだろう。</p>
<p>また、JScript.NET をどう実行できるようにするか、というところで、大きな違いがある。WSH 上の JScript の場合、<code>.js</code> ファイルを関連付けしておけば、ファイルのダブルクリックで実行可能であった。これに対し、JScript.NET は <em>jsc</em> でのコンパイルが必要なのだ。</p>
<pre class="language-batch"><code class="language-batch"><span class="token comment">Rem .NET Framework のフォルダにある jsc.exe を使用してコンパイルする</span>
<span class="token command"><span class="token keyword">C</span><span class="token label property">:\Windows\Microsoft.NET\Framework\v4.0.30319\jsc.exe</span> sample.js</span>
</code></pre>
<p>こうすると、<code>sample.js</code> と同じ階層に <code>sample.exe</code> が出来上がるので、これを実行する。</p>
<p>ちなみに、JScript.NET をコンパイルする <em>jsc.exe</em> の他にも、VB.NET をコンパイルする <em>vbc.exe</em>、C# をコンパイルする <em>csc.exe</em> なども、.NET Framework のインストールフォルダ内に置いてある。言語が違うだけで使い方は同じなので、気になる人は調べてみるといい。</p>
<h2 id="jscriptnet-の認知度の低さ"><a class="header-link" href="#jscriptnet-の認知度の低さ"><span class="header-link-mark"></span></a>JScript.NET の認知度の低さ</h2>
<p>さて、C#、VB.NET など、.NET Framework を基盤とする代表的な言語と比べて、Microsoft 製の言語なのになぜ JScript.NET の認知度が低いのか。</p>
<p>一つの原因は、JScript は Visual Studio (IDE) での開発に対応していないのだ。代表的な開発環境がなく、なぜか <code>jsc.exe</code> が放り込まれているだけなので、その存在もあまり知られていなかったりする。</p>
<p>もう一つは、ベースとなる JavaScript という言語の標準を策定しているのが、Ecma International という別の団体だからであろう。Visual Basic も C# も Microsoft 製の言語だが、ECMAScript・JavaScript はそうではないため、あまり手厚く見てもらえていないのかもしれない。VB の元となっている BASIC や、C# の元となる C よりも歴史が浅く、ブラウザベースの言語として発展してきた経緯もあり、スクリプト言語としての利点がそんなにない気もするし。</p>
<p>そんなワケであまり陽の目を見ない JScript と JScript.NET だが、JavaScript から入った人間は VB 系の言語仕様にイマイチ慣れないこともあり、なんだかんだとこの陰キャラを愛している、のかもしれない。</p>
<h2 id="参考"><a class="header-link" href="#参考"><span class="header-link-mark"></span></a>参考</h2>
<ul>
  <li><a href="http://language-and-engineering.hatenablog.jp/entry/20090228/p1">JScript.NET でのプログラミングを習得するための４ステップ （開発環境つき） - 主に言語とシステム開発に関して</a></li>
  <li><a href="https://web.archive.org/web/20130516043848/http://muumoo.jp/news/2008/06/17/0jspop.html">JScript.NETをすぐ実行するやつ(改良版) - むぅもぉ.jp</a></li>
  <li><a href="http://takuya-1st.hatenablog.jp/entry/2013/06/29/012725">Javascript/C#/VBS で書いた.netFramework を手作業でコンパイル - それマグで！</a></li>
</ul>

      </main>
      <footer id="footer">
        <div id="footer-contents">
          <div id="date-time">
            <dl>
              <dt>Created</dt>
              <dd><time>2016-09-27</time></dd>
              <dt>Last-Modified</dt>
              <dd><time>2016-09-27</time></dd>
            </dl>
          </div>
          <nav id="footer-links">
            <ul>
              <li id="footer-link-about"><a href="/about/index.html" title="About">About</a></li>
              <li id="footer-link-search"><a href="/about/search.html" title="Search">Search</a></li>
              <li id="footer-link-feeds"><a href="/feeds.xml" title="Feeds">Feeds</a></li>
              <li id="footer-link-github"><a href="https://github.com/Neos21/" title="GitHub">GitHub</a></li>
            </ul>
          </nav>
          <nav id="to-top"><a href="#" title="To Top"><span>▲ To Top</span></a></nav>
        </div>
      </footer>
    </div>
  </body>
</html>
