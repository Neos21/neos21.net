<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="theme-color" content="#0990d0">
    <!-- Google Search Console -->
    <meta name="google-site-verification" content="AvoEr3mUJFF2H_mPWWgShfmjBVP3ywRpyx9hxeeq2d4">
    <!-- Open Graph・Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Neo's World">
    <meta property="og:title" content="Restreamer でストリーミング配信サイトをセルフホストしてみた - Neo's World">
    <meta property="og:description" content="Restreamer でストリーミング配信サイトをセルフホストしてみた - Neo's World">
    <meta property="og:url" content="https://neos21.net/blog/2024/08/14-01.html">
    <meta property="og:image" content="https://neos21.net/ogp.png">
    <meta property="og:locale" content="ja_JP">
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:title" content="Restreamer でストリーミング配信サイトをセルフホストしてみた - Neo's World">
    <meta property="twitter:description" content="Restreamer でストリーミング配信サイトをセルフホストしてみた - Neo's World">
    <meta property="twitter:url" content="https://neos21.net/blog/2024/08/14-01.html">
    <meta property="twitter:image" content="https://neos21.net/ogp.png">
    <title>Restreamer でストリーミング配信サイトをセルフホストしてみた - Neo's World</title>
    <link rel="icon" href="/favicon.ico">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    <link rel="manifest" href="/manifest.webmanifest">
    <link rel="stylesheet" href="/styles.css">
    <link rel="canonical" href="https://neos21.net/blog/2024/08/14-01.html">
    <link rel="search" type="application/opensearchdescription+xml" title="neos21.net" href="/opensearch.xml">
    <link rel="alternate" type="application/atom+xml" title="Feeds" href="/feeds.xml">
    <link rel="author" href="http://www.hatena.ne.jp/neos21/">
    <script src="/scripts.js"></script>
    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YMHFLZP1M1"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date());gtag('config','G-YMHFLZP1M1');gtag('config','UA-106501-1');</script>
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6475907504235292" crossorigin="anonymous"></script>
  </head>
  <body>
    <div id="container">
      <header id="header">
        <div id="header-brand">
          <div id="header-brand-contents">
            <div id="site-title"><a href="/index.html">Neo's World</a></div>
            <nav id="header-links">
              <ul>
                <li id="header-link-theme"><a href="#" title="Toggle Theme"><span>Toggle Theme</span></a></li>
                <li id="header-link-about"><a href="/about/index.html" title="About"><span>About</span></a></li>
                <li id="header-link-search"><a href="/about/search.html" title="Search"><span>Search</span></a></li>
                <li id="header-link-feeds"><a href="/feeds.xml" title="Feeds"><span>Feeds</span></a></li>
                <li id="header-link-to-bottom"><a href="#footer" title="To Bottom"><span>▼ To Bottom</span></a></li>
              </ul>
            </nav>
          </div>
        </div>
        <nav id="global-nav">
          <ul>
            <li><a href="/blog/index.html">Blog</a></li>
            <li><a href="/tech/index.html">Tech</a></li>
            <li><a href="/music/index.html">Music</a></li>
            <li><a href="/games/index.html">Games</a></li>
            <li><a href="/gallery/index.html">Gallery</a></li>
            <li><a href="/etc/index.html">Etc.</a></li>
          </ul>
        </nav>
        <nav id="path">
          <ul>
            <li><a href="/index.html">Neo's World</a></li>
            <li><a href="/blog/index.html">Blog</a></li>
            <li><a href="/blog/2024/index.html">2024年</a></li>
            <li><a href="/blog/2024/08/index.html">08月</a></li>
          </ul>
        </nav>
      </header>
      <main id="main">
        <div id="header-date"><time>2024-08-14</time></div>
        <h1 id="page-title">Restreamer でストリーミング配信サイトをセルフホストしてみた</h1>

<p><strong>Restreamer</strong> というツールを使って、ストリーミング配信サイトをセルフホストしてみた。</p>
<ul>
  <li><a href="https://datarhei.com/">Open Source Streaming Server ⇒ Selfhosting Video Server / datarhei ⇒ Open Source Video Streaming Server Software</a></li>
  <li><a href="https://github.com/datarhei/restreamer">datarhei/restreamer: The Restreamer is a complete streaming server solution for self-hosting. It has a visually appealing user interface and no ongoing license costs. Upload your live stream to YouTube, Twitch, Facebook, Vimeo, or other streaming solutions like Wowza. Receive video data from OBS and publish it with the RTMP and SRT server.</a></li>
  <li><a href="https://gigazine.net/news/20230624-restreamer/">ストリーミングサイトをセルフホストしてYouTube・Twitter・Twitchなどにも配信できるオープンソースアプリ「Restreamer」を使ってみた - GIGAZINE</a></li>
</ul>
<p>公式ドキュメントは以下。</p>
<ul>
  <li><a href="https://docs.datarhei.com/restreamer">datarhei Restreamer | Restreamer</a></li>
</ul>
<p>公式から Docker イメージが提供されているので、コレを使って一発で立ち上げられた。なお、Cuda 対応のイメージは WSL から呼ぶとうまく動かなかったので、Windows 側の GitBash で実行してやるとうまくいった。</p>
<ul>
  <li>公式 : <a href="https://docs.datarhei.com/restreamer/installing/windows/terminal#step-2-start-the-restreamer">Terminal | Restreamer</a></li>
</ul>
<pre class="language-bash"><code class="language-bash"><span class="token comment"># Cuda 対応版</span>
$ docker run --detach --name core --privileged --volume /opt/core/config:/core/config --volume /opt/core/data:/core/data --publish <span class="token number">8080</span>:8080 --publish <span class="token number">8181</span>:8181 --publish <span class="token number">1935</span>:1935 --publish <span class="token number">1936</span>:1936 --publish <span class="token number">6000</span>:6000/udp datarhei/restreamer:cuda-latest

<span class="token comment"># ハードウェアサポートなし版</span>
$ docker run --detach --name core --privileged --volume /opt/core/config:/core/config --volume /opt/core/data:/core/data --publish <span class="token number">8080</span>:8080 --publish <span class="token number">8181</span>:8181 --publish <span class="token number">1935</span>:1935 --publish <span class="token number">1936</span>:1936 --publish <span class="token number">6000</span>:6000/udp datarhei/restreamer:latest
</code></pre>
<p>Docker コンテナが起動したら <code>http://localhost:8080/ui</code> にアクセスする。</p>
<p>最初は管理者のユーザ名とパスワードを適当に決めてログインする。あとは以下の公式ガイドにもあるとおり、動画配信のセットアップウィザードを進めていく。</p>
<ul>
  <li><a href="https://docs.datarhei.com/restreamer/knowledge-base/manual/wizard">Wizard | Restreamer</a></li>
</ul>
<p>USB 接続したウェブカメラを直接配信する「Connected Camera」という項目があるが、コイツは <strong>Linux 限定</strong>。WSL で実現することも不可能ではないのだが、<code>usbipd</code> というツールで USB カメラを WSL に認識させ <code>$ lsusb</code> で確認できるようにしたあと、何やら<em>カーネルをいじくり回して</em>セットアップをしてやり <code>/dev/video0</code> として認識されるようになると初めて使えるようになるようだ。面倒臭すぎて断念。ｗ</p>
<p>というワケで今回は「Internal RTMP Server」を選択する。特に HTTPS 化 (RTPMS) にはせずに、表示された <code>rtmp://</code> のアドレスを取得する。</p>
<p>そしたら <strong>OBS</strong> を開き、「設定」画面の「配信」設定で「カスタム」を選び、先程取得した <code>rtmp://</code> のアドレスを入れてあげる。ストリームキーはナシで良い。</p>
<p>コレで OBS で配信を開始しておいてあげると、Restreamer が認識してウィザードを先に進められるようになる。</p>
<p>以上の設定でもって <code>http://localhost:8080/</code> にアクセスすればストリーミング配信が確認できるようになった。あとは Serveo などでトンネリングしてあげれば世界に公開することもできるだろう。</p><div class="ad-amazon">
  <div class="ad-amazon-image">
    <a href="https://www.amazon.co.jp/dp/4789840891?tag=neos21-22&amp;linkCode=osi&amp;th=1&amp;psc=1">
      <img src="https://m.media-amazon.com/images/I/51V7lCAJibL._SL160_.jpg" width="123" height="160">
    </a>
  </div>
  <div class="ad-amazon-info">
    <div class="ad-amazon-title">
      <a href="https://www.amazon.co.jp/dp/4789840891?tag=neos21-22&amp;linkCode=osi&amp;th=1&amp;psc=1">マルチメディア・ストリーミング技術: 動画・音声コンテンツ伝送技術のすべて (Industrial Computing Series)</a>
    </div>
  </div>
</div>
<div class="ad-rakuten">
  <div class="ad-rakuten-image">
    <a href="https://hb.afl.rakuten.co.jp/hgc/g00rc682.waxyceda.g00rc682.waxyd8cb/?pc=https%3A%2F%2Fitem.rakuten.co.jp%2Fbookoffonline%2F0016752872%2F&amp;m=http%3A%2F%2Fm.rakuten.co.jp%2Fbookoffonline%2Fi%2F12060518%2F&amp;rafcid=wsc_i_is_1051972513434300252">
      <img src="https://thumbnail.image.rakuten.co.jp/@0_mall/bookoffonline/cabinet/2223/0016752872l.jpg?_ex=128x128">
    </a>
  </div>
  <div class="ad-rakuten-info">
    <div class="ad-rakuten-title">
      <a href="https://hb.afl.rakuten.co.jp/hgc/g00rc682.waxyceda.g00rc682.waxyd8cb/?pc=https%3A%2F%2Fitem.rakuten.co.jp%2Fbookoffonline%2F0016752872%2F&amp;m=http%3A%2F%2Fm.rakuten.co.jp%2Fbookoffonline%2Fi%2F12060518%2F&amp;rafcid=wsc_i_is_1051972513434300252">【中古】 マルチメディア・ストリーミング技術 動画・音声コンテンツ伝送技術のすべて Industrial　Computing　Series／笠野英松【著】</a>
    </div>
    <div class="ad-rakuten-shop">
      <a href="https://hb.afl.rakuten.co.jp/hgc/g00rc682.waxyceda.g00rc682.waxyd8cb/?pc=https%3A%2F%2Fwww.rakuten.co.jp%2Fbookoffonline%2F&amp;m=http%3A%2F%2Fm.rakuten.co.jp%2Fbookoffonline%2F&amp;rafcid=wsc_i_is_1051972513434300252">ブックオフ 楽天市場店</a>
    </div>
    <div class="ad-rakuten-price">価格 : 220円</div>
  </div>
</div>

      </main>
      <footer id="footer">
        <div id="footer-contents">
          <div id="date-time">
            <dl>
              <dt>Created</dt>
              <dd><time>2024-08-14</time></dd>
              <dt>Last-Modified</dt>
              <dd><time>2024-08-14</time></dd>
            </dl>
          </div>
          <nav id="footer-links">
            <ul>
              <li id="footer-link-about"><a href="/about/index.html" title="About">About</a></li>
              <li id="footer-link-search"><a href="/about/search.html" title="Search">Search</a></li>
              <li id="footer-link-feeds"><a href="/feeds.xml" title="Feeds">Feeds</a></li>
              <li id="footer-link-github"><a href="https://github.com/Neos21/" title="GitHub">GitHub</a></li>
            </ul>
          </nav>
          <nav id="to-top"><a href="#" title="To Top"><span>▲ To Top</span></a></nav>
        </div>
      </footer>
    </div>
  </body>
</html>
