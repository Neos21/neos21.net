<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="theme-color" content="#0990d0">
    <!-- Google Search Console -->
    <meta name="google-site-verification" content="AvoEr3mUJFF2H_mPWWgShfmjBVP3ywRpyx9hxeeq2d4">
    <!-- Open Graph・Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Neo's World">
    <meta property="og:title" content="Bash・コマンドラインで画像ファイルの情報を取得する (ImageMagick) - Neo's World">
    <meta property="og:description" content="Bash・コマンドラインで画像ファイルの情報を取得する (ImageMagick) - Neo's World">
    <meta property="og:url" content="https://neos21.net/blog/2021/11/13-01.html">
    <meta property="og:image" content="https://neos21.net/ogp.png">
    <meta property="og:locale" content="ja_JP">
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:title" content="Bash・コマンドラインで画像ファイルの情報を取得する (ImageMagick) - Neo's World">
    <meta property="twitter:description" content="Bash・コマンドラインで画像ファイルの情報を取得する (ImageMagick) - Neo's World">
    <meta property="twitter:url" content="https://neos21.net/blog/2021/11/13-01.html">
    <meta property="twitter:image" content="https://neos21.net/ogp.png">
    <title>Bash・コマンドラインで画像ファイルの情報を取得する (ImageMagick) - Neo's World</title>
    <link rel="icon" href="/favicon.ico">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    <link rel="manifest" href="/manifest.webmanifest">
    <link rel="stylesheet" href="/styles.css">
    <link rel="canonical" href="https://neos21.net/blog/2021/11/13-01.html">
    <link rel="search" type="application/opensearchdescription+xml" title="neos21.net" href="/opensearch.xml">
    <link rel="alternate" type="application/atom+xml" title="Feeds" href="/feeds.xml">
    <link rel="author" href="http://www.hatena.ne.jp/neos21/">
    <script src="/scripts.js"></script>
    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YMHFLZP1M1"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date());gtag('config','G-YMHFLZP1M1');gtag('config','UA-106501-1');</script>
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6475907504235292" crossorigin="anonymous"></script>
  </head>
  <body>
    <div id="container">
      <header id="header">
        <div id="header-brand">
          <div id="header-brand-contents">
            <div id="site-title"><a href="/index.html">Neo's World</a></div>
            <nav id="header-links">
              <ul>
                <li id="header-link-theme"><a href="#" title="Toggle Theme"><span>Toggle Theme</span></a></li>
                <li id="header-link-about"><a href="/about/index.html" title="About"><span>About</span></a></li>
                <li id="header-link-search"><a href="/about/search.html" title="Search"><span>Search</span></a></li>
                <li id="header-link-feeds"><a href="/feeds.xml" title="Feeds"><span>Feeds</span></a></li>
                <li id="header-link-to-bottom"><a href="#footer" title="To Bottom"><span>▼ To Bottom</span></a></li>
              </ul>
            </nav>
          </div>
        </div>
        <nav id="global-nav">
          <ul>
            <li><a href="/blog/index.html">Blog</a></li>
            <li><a href="/tech/index.html">Tech</a></li>
            <li><a href="/music/index.html">Music</a></li>
            <li><a href="/games/index.html">Games</a></li>
            <li><a href="/gallery/index.html">Gallery</a></li>
            <li><a href="/etc/index.html">Etc.</a></li>
          </ul>
        </nav>
        <nav id="path">
          <ul>
            <li><a href="/index.html">Neo's World</a></li>
            <li><a href="/blog/index.html">Blog</a></li>
            <li><a href="/blog/2021/index.html">2021年</a></li>
            <li><a href="/blog/2021/11/index.html">11月</a></li>
          </ul>
        </nav>
      </header>
      <main id="main">
        <div id="header-date"><time>2021-11-13</time></div>
        <h1 id="page-title">Bash・コマンドラインで画像ファイルの情報を取得する (ImageMagick)</h1>

<p>Bash 上で、画像ファイルの幅や高さの情報なんかを取得したいなと思った。ImageMagick が提供する <code>identify</code> コマンドを使えば上手くいけた。</p>
<h2 id="目次"><a class="header-link" href="#目次"><span class="header-link-mark"></span></a>目次</h2>
<ul>
  <li><a href="#%E6%A4%9C%E8%A8%BC%E3%81%97%E3%81%9F%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3">検証したバージョン</a></li>
  <li><a href="#%E5%9F%BA%E6%9C%AC%E7%9A%84%E3%81%AA%E4%BD%BF%E3%81%84%E6%96%B9">基本的な使い方</a></li>
  <li><a href="#%E5%B9%85%E3%82%84%E9%AB%98%E3%81%95%E3%81%A0%E3%81%91%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B">幅や高さだけを取得する</a></li>
  <li><a href="#%E7%B5%84%E3%81%BF%E8%BE%BC%E3%81%BF%E3%81%AE-file-%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%81%A7%E3%82%82%E5%88%86%E3%81%8B%E3%82%8B">組み込みの <code>file</code> コマンドでも分かる</a></li>
  <li><a href="#%E4%BB%A5%E4%B8%8A">以上</a></li>
</ul>
<h2 id="検証したバージョン"><a class="header-link" href="#検証したバージョン"><span class="header-link-mark"></span></a>検証したバージョン</h2>
<ul>
  <li>MacOS に HomeBrew でインストールした ImageMagick 7.1.0-8</li>
</ul>
<pre class="language-bash"><code class="language-bash">$ brew <span class="token function">install</span> imagemagick

$ identify -version
Version: ImageMagick <span class="token number">7.1</span>.0-8 Q16-HDRI x86_64 <span class="token number">2021</span>-09-18 https://imagemagick.org
Copyright: <span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token number">1999</span>-2021 ImageMagick Studio LLC
License: https://imagemagick.org/script/license.php
Features: Cipher DPC HDRI Modules OpenMP<span class="token punctuation">(</span><span class="token number">4.5</span><span class="token punctuation">)</span>
Delegates <span class="token punctuation">(</span>built-in<span class="token punctuation">)</span>: bzlib fontconfig freetype gslib heic jng jp2 jpeg lcms lqr ltdl lzma openexr png <span class="token function">ps</span> tiff webp xml zlib
Compiler: gcc <span class="token punctuation">(</span><span class="token number">4.2</span><span class="token punctuation">)</span>
</code></pre>
<ul>
  <li>Windows WSL2 Ubuntu に apt でインストールした ImageMagick 6.9.10-23</li>
</ul>
<pre class="language-bash"><code class="language-bash">$ <span class="token function">apt</span> <span class="token function">install</span> imagemagick -y

$ identify -version
Version: ImageMagick <span class="token number">6.9</span>.10-23 Q16 x86_64 <span class="token number">20190101</span> https://imagemagick.org
Copyright: © <span class="token number">1999</span>-2019 ImageMagick Studio LLC
License: https://imagemagick.org/script/license.php
Features: Cipher DPC Modules OpenMP
Delegates <span class="token punctuation">(</span>built-in<span class="token punctuation">)</span>: bzlib djvu fftw fontconfig freetype jbig jng jpeg lcms lqr ltdl lzma openexr pangocairo png tiff webp wmf x xml zlib
</code></pre>
<p>メジャーバージョンが異なるが、出力される内容は一緒だった。</p>
<h2 id="基本的な使い方"><a class="header-link" href="#基本的な使い方"><span class="header-link-mark"></span></a>基本的な使い方</h2>
<p>オプションなどナシで <code>identify</code> コマンドを叩けば、とりあえず幅・高さなどは分かる。</p>
<pre class="language-bash"><code class="language-bash">$ identify example.png
example.png PNG 1832x688 1832x688+0+0 <span class="token number">8</span>-bit sRGB 192639B <span class="token number">0</span>.000u <span class="token number">0</span>:00.000

$ identify example.jpg
example.jpg JPEG 320x260 320x260+0+0 <span class="token number">8</span>-bit sRGB 15775B <span class="token number">0</span>.000u <span class="token number">0</span>:00.000
</code></pre>
<p><code>-verbose</code> を使うとこんな風に詳細が出る。</p>
<pre class="language-bash"><code class="language-bash">$ identify -verbose example.png
Image:
  Filename: example.png
  Format: PNG <span class="token punctuation">(</span>Portable Network Graphics<span class="token punctuation">)</span>
  Mime type: image/png
  Class: DirectClass
  Geometry: 1832x688+0+0
  Resolution: 144x144
  Print size: <span class="token number">12</span>.7222x4.77778
  Units: PixelsPerInch
  Colorspace: sRGB
  Type: TrueColorAlpha
  Base type: Undefined
  Endianness: Undefined
  Depth: <span class="token number">8</span>-bit
  Channel depth:
    Red: <span class="token number">8</span>-bit
    Green: <span class="token number">8</span>-bit
    Blue: <span class="token number">8</span>-bit
    Alpha: <span class="token number">1</span>-bit
  Channel statistics:
    Pixels: <span class="token number">1260416</span>
    Red:
      min: <span class="token number">34</span>  <span class="token punctuation">(</span><span class="token number">0.133333</span><span class="token punctuation">)</span>
      max: <span class="token number">255</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
      mean: <span class="token number">239.154</span> <span class="token punctuation">(</span><span class="token number">0.93786</span><span class="token punctuation">)</span>
      median: <span class="token number">240</span> <span class="token punctuation">(</span><span class="token number">0.941176</span><span class="token punctuation">)</span>
      standard deviation: <span class="token number">38.8098</span> <span class="token punctuation">(</span><span class="token number">0.152195</span><span class="token punctuation">)</span>
      kurtosis: <span class="token number">16.6535</span>
      skewness: -4.00835
      entropy: <span class="token number">0.256342</span>
    Green:
      min: <span class="token number">34</span>  <span class="token punctuation">(</span><span class="token number">0.133333</span><span class="token punctuation">)</span>
      max: <span class="token number">255</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
      mean: <span class="token number">240.001</span> <span class="token punctuation">(</span><span class="token number">0.941182</span><span class="token punctuation">)</span>
      median: <span class="token number">240</span> <span class="token punctuation">(</span><span class="token number">0.941176</span><span class="token punctuation">)</span>
      standard deviation: <span class="token number">38.5993</span> <span class="token punctuation">(</span><span class="token number">0.15137</span><span class="token punctuation">)</span>
      kurtosis: <span class="token number">17.4013</span>
      skewness: -4.1278
      entropy: <span class="token number">0.256674</span>
    Blue:
      min: <span class="token number">34</span>  <span class="token punctuation">(</span><span class="token number">0.133333</span><span class="token punctuation">)</span>
      max: <span class="token number">255</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
      mean: <span class="token number">238.892</span> <span class="token punctuation">(</span><span class="token number">0.93683</span><span class="token punctuation">)</span>
      median: <span class="token number">240</span> <span class="token punctuation">(</span><span class="token number">0.941176</span><span class="token punctuation">)</span>
      standard deviation: <span class="token number">40.574</span> <span class="token punctuation">(</span><span class="token number">0.159114</span><span class="token punctuation">)</span>
      kurtosis: <span class="token number">14.9682</span>
      skewness: -3.87756
      entropy: <span class="token number">0.257157</span>
    Alpha:
      min: <span class="token number">255</span>  <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
      max: <span class="token number">255</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
      mean: <span class="token number">255</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
      median: <span class="token number">255</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
      standard deviation: <span class="token number">0</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
      kurtosis: <span class="token number">8</span>.192e+51
      skewness: 1e+36
      entropy: <span class="token number">0</span>
  Image statistics:
    Overall:
      min: <span class="token number">34</span>  <span class="token punctuation">(</span><span class="token number">0.133333</span><span class="token punctuation">)</span>
      max: <span class="token number">255</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
      mean: <span class="token number">243.262</span> <span class="token punctuation">(</span><span class="token number">0.953968</span><span class="token punctuation">)</span>
      median: <span class="token number">243.75</span> <span class="token punctuation">(</span><span class="token number">0.955882</span><span class="token punctuation">)</span>
      standard deviation: <span class="token number">29.4958</span> <span class="token punctuation">(</span><span class="token number">0.11567</span><span class="token punctuation">)</span>
      kurtosis: <span class="token number">22.8396</span>
      skewness: -4.67581
      entropy: <span class="token number">0.192543</span>
  Rendering intent: Perceptual
  Gamma: <span class="token number">0.454545</span>
  Chromaticity:
    red primary: <span class="token punctuation">(</span><span class="token number">0.64</span>,0.33<span class="token punctuation">)</span>
    green primary: <span class="token punctuation">(</span><span class="token number">0.3</span>,0.6<span class="token punctuation">)</span>
    blue primary: <span class="token punctuation">(</span><span class="token number">0.15</span>,0.06<span class="token punctuation">)</span>
    white point: <span class="token punctuation">(</span><span class="token number">0.3127</span>,0.329<span class="token punctuation">)</span>
  Matte color: grey74
  Background color: white
  Border color: srgb<span class="token punctuation">(</span><span class="token number">223,223</span>,223<span class="token punctuation">)</span>
  Transparent color: none
  Interlace: None
  Intensity: Undefined
  Compose: Over
  Page geometry: 1832x688+0+0
  Dispose: Undefined
  Iterations: <span class="token number">0</span>
  Compression: Zip
  Orientation: Undefined
  Profiles:
    Profile-exif: <span class="token number">144</span> bytes
    Profile-icc: <span class="token number">4064</span> bytes
    Profile-xmp: <span class="token number">449</span> bytes
  Properties:
    date:create: <span class="token number">2021</span>-11-10T05:34:44+00:00
    date:modify: <span class="token number">2021</span>-10-27T07:34:31+00:00
    exif:ExifOffset: <span class="token number">78</span>
    exif:PixelXDimension: <span class="token number">1832</span>
    exif:PixelYDimension: <span class="token number">688</span>
    exif:UserComment: <span class="token number">65</span>, <span class="token number">83</span>, <span class="token number">67</span>, <span class="token number">73</span>, <span class="token number">73</span>, <span class="token number">0</span>, <span class="token number">0</span>, <span class="token number">0</span>, <span class="token number">83</span>, <span class="token number">99</span>, <span class="token number">114</span>, <span class="token number">101</span>, <span class="token number">101</span>, <span class="token number">110</span>, <span class="token number">115</span>, <span class="token number">104</span>, <span class="token number">111</span>, <span class="token number">116</span>
    icc:copyright: Copyright Apple Inc., <span class="token number">2021</span>
    icc:description: Display
    png:iCCP: chunk was found
    png:IHDR.bit-depth-orig: <span class="token number">8</span>
    png:IHDR.bit_depth: <span class="token number">8</span>
    png:IHDR.color-type-orig: <span class="token number">6</span>
    png:IHDR.color_type: <span class="token number">6</span> <span class="token punctuation">(</span>RGBA<span class="token punctuation">)</span>
    png:IHDR.interlace_method: <span class="token number">0</span> <span class="token punctuation">(</span>Not interlaced<span class="token punctuation">)</span>
    png:IHDR.width,height: <span class="token number">1832</span>, <span class="token number">688</span>
    png:pHYs: <span class="token assign-left variable">x_res</span><span class="token operator">=</span><span class="token number">5669</span>, <span class="token assign-left variable">y_res</span><span class="token operator">=</span><span class="token number">5669</span>, <span class="token assign-left variable">units</span><span class="token operator">=</span><span class="token number">1</span>
    signature: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    xmp:PixelXDimension: <span class="token number">1832</span>
    xmp:PixelYDimension: <span class="token number">688</span>
    xmp:UserComment: Screenshot
  Artifacts:
    verbose: <span class="token boolean">true</span>
  Tainted: False
  Filesize: 192639B
  Number pixels: <span class="token number">1</span>.26042M
  Pixels per second: <span class="token number">35</span>.6634MP
  User time: <span class="token number">0</span>.060u
  Elapsed time: <span class="token number">0</span>:01.035
  Version: ImageMagick <span class="token number">7.1</span>.0-8 Q16-HDRI x86_64 <span class="token number">2021</span>-09-18 https://imagemagick.org
</code></pre>
<h2 id="幅や高さだけを取得する"><a class="header-link" href="#幅や高さだけを取得する"><span class="header-link-mark"></span></a>幅や高さだけを取得する</h2>
<p><code>-format</code> オプションで幅・高さだけ取得、などができる。</p>
<pre class="language-bash"><code class="language-bash">$ identify -format <span class="token string">'%wx%h'</span> example.png
1832x688

$ identify -format <span class="token string">'%w'</span> example.png
<span class="token number">1832</span>

$ identify -format <span class="token string">'%h'</span> example.png
<span class="token number">688</span>
</code></pre>
<h2 id="組み込みの-file-コマンドでも分かる"><a class="header-link" href="#組み込みの-file-コマンドでも分かる"><span class="header-link-mark"></span></a>組み込みの <code>file</code> コマンドでも分かる</h2>
<p>ImageMagick をインストールしなくても、<code>file</code> コマンドでも一応サイズなどの情報は調べられた。</p>
<p>形式の調整が難しいので、「幅だけ取得」とかは難しそう。目視確認で十分ならコレでも良いかも。</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token function">file</span> example.png
example.png: PNG image data, <span class="token number">1832</span> x <span class="token number">688</span>, <span class="token number">8</span>-bit/color RGBA, non-interlaced

$ <span class="token function">file</span> example.gif
example.gif: GIF image data, version 89a, <span class="token number">400</span> x <span class="token number">400</span>

$ <span class="token function">file</span> example.jpg
example.jpg: JPEG image data, JFIF standard <span class="token number">1.01</span>, resolution <span class="token punctuation">(</span>DPI<span class="token punctuation">)</span>, density 96x96, segment length <span class="token number">16</span>, comment: <span class="token string">"CREATOR: gd-jpeg v1.0 (using IJG JPEG v62), quality = 90"</span>, baseline, precision <span class="token number">8</span>, 64x64, components <span class="token number">3</span>
</code></pre>
<h2 id="以上"><a class="header-link" href="#以上"><span class="header-link-mark"></span></a>以上</h2>
<p><code>$ identify -format '%w %h'</code> で良さそうだ。</p>
<p>ImageMagick は <code>identify</code> コマンドの他に、<code>convert</code> という画像変換のコマンドも提供してくれる。コレもなかなか便利だ。</p>
<p>なお、Windows コマンドプロンプトだと、ファイルシステムを NTFS に変更するためのコマンドとして <code>convert.exe</code> が標準搭載されているので、ImageMagick の <code>convert</code> コマンドと名前がバッティングしてしまうことに留意。</p><div class="ad-amazon">
  <div class="ad-amazon-image">
    <a href="https://www.amazon.co.jp/dp/4844326473?tag=neos21-22&amp;linkCode=osi&amp;th=1&amp;psc=1">
      <img src="https://m.media-amazon.com/images/I/51wL43bSolL._SL160_.jpg" width="126" height="160">
    </a>
  </div>
  <div class="ad-amazon-info">
    <div class="ad-amazon-title">
      <a href="https://www.amazon.co.jp/dp/4844326473?tag=neos21-22&amp;linkCode=osi&amp;th=1&amp;psc=1">ImageMagick逆引きコマンドリファレンス</a>
    </div>
  </div>
</div>
<div class="ad-rakuten">
  <div class="ad-rakuten-image">
    <a href="https://hb.afl.rakuten.co.jp/hgc/g00rc682.waxyceda.g00rc682.waxyd8cb/?pc=https%3A%2F%2Fitem.rakuten.co.jp%2Fbookoffonline%2F0016079959%2F&amp;m=http%3A%2F%2Fm.rakuten.co.jp%2Fbookoffonline%2Fi%2F10850372%2F">
      <img src="https://thumbnail.image.rakuten.co.jp/@0_mall/bookoffonline/cabinet/2084/0016079959l.jpg?_ex=128x128">
    </a>
  </div>
  <div class="ad-rakuten-info">
    <div class="ad-rakuten-title">
      <a href="https://hb.afl.rakuten.co.jp/hgc/g00rc682.waxyceda.g00rc682.waxyd8cb/?pc=https%3A%2F%2Fitem.rakuten.co.jp%2Fbookoffonline%2F0016079959%2F&amp;m=http%3A%2F%2Fm.rakuten.co.jp%2Fbookoffonline%2Fi%2F10850372%2F">【中古】 ImageMagick逆引きコマンドリファレンス ／石井敦(著者) 【中古】afb</a>
    </div>
    <div class="ad-rakuten-shop">
      <a href="https://hb.afl.rakuten.co.jp/hgc/g00rc682.waxyceda.g00rc682.waxyd8cb/?pc=https%3A%2F%2Fwww.rakuten.co.jp%2Fbookoffonline%2F&amp;m=http%3A%2F%2Fm.rakuten.co.jp%2Fbookoffonline%2F">ブックオフオンライン楽天市場店</a>
    </div>
    <div class="ad-rakuten-price">価格 : 2475円</div>
  </div>
</div>
<ul>
  <li><a href="https://qiita.com/ksugawara61/items/bb4727bc4f118aee2121">Linux環境で画像ファイルの情報を確認する方法 - Qiita</a></li>
  <li><a href="https://superuser.com/questions/275502/how-to-get-information-about-an-image-picture-from-the-linux-command-line/275507">How to get information about an image (picture) from the Linux command-line? - Super User</a></li>
</ul>

      </main>
      <footer id="footer">
        <div id="footer-contents">
          <div id="date-time">
            <dl>
              <dt>Created</dt>
              <dd><time>2021-11-13</time></dd>
              <dt>Last-Modified</dt>
              <dd><time>2021-11-13</time></dd>
            </dl>
          </div>
          <nav id="footer-links">
            <ul>
              <li id="footer-link-about"><a href="/about/index.html" title="About">About</a></li>
              <li id="footer-link-search"><a href="/about/search.html" title="Search">Search</a></li>
              <li id="footer-link-feeds"><a href="/feeds.xml" title="Feeds">Feeds</a></li>
              <li id="footer-link-github"><a href="https://github.com/Neos21/" title="GitHub">GitHub</a></li>
            </ul>
          </nav>
          <nav id="to-top"><a href="#" title="To Top"><span>▲ To Top</span></a></nav>
        </div>
      </footer>
    </div>
  </body>
</html>
